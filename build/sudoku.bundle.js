/**
*
*   Classy.js
*   @version: 0.9.3
*   @built on 2015-04-26 17:56:03
*
*   Object-Oriented micro-framework for JavaScript
*   https://github.com/foo123/classy.js
*
**/!function(e,n,t){"use strict";var i,r="object"==typeof module&&module.exports,l="function"==typeof define&&define.amd;r?module.exports=(module.$deps=module.$deps||{})[n]=module.$deps[n]||t.call(e,{NODE:module})||1:l&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["require","exports","module"],function(n,i,r){return t.call(e,{AMD:r})}):n in e||(e[n]=i=t.call(e,{})||1)&&l&&define(n,[],function(){return i})}(this,"Classy",function(e){return!function(e,n){"use strict";var t="constructor",i="prototype",r="__proto__",l="__static__",u="__private__",a="$super",o="$static",f="$latestatic",c="$class",s=2,b=4,m=8,d=256,p=Object,v=p[i],g=Function,h=g[i],y=String,x=Number,w=RegExp,E=Array,j=v.toString,_=(h.call.bind(h.toString),"hasOwnProperty"),q="propertyIsEnumerable",I=p.keys,$=p.defineProperty,A=function(e){return typeof e},C=function(e){throw new TypeError(e)},M=2,N=3,O=4,P=8,S=9,T=16,R=32,D=64,F=128,L=256,V=512,k=1024,B={"[object Array]":T,"[object RegExp]":F,"[object Number]":M,"[object String]":P,"[object Function]":D,"[object Object]":R},U=function(e){var t;return null===e?L:!0===e||!1===e?O:n===e?V:(t=j.call(e),t=B[t]||k,M===t||e instanceof x?isNaN(e)?N:M:P===t||e instanceof y?1===e.length?S:P:T===t||e instanceof E?T:F===t||e instanceof w?F:D===t||e instanceof g?D:R===t?R:k)},z=function(e,n){var t,i=n.length,r=[].concat(e);for(t=0;i>t;t++)-1<r.indexOf(n[t])||r.push(n[t]);return r},G=function(e,n){R!==U(e)&&C("bad desc");var t={};if(e[_]("enumerable")&&(t.enumerable=!!n.enumerable),e[_]("configurable")&&(t.configurable=!!n.configurable),e[_]("value")&&(t.value=n.value),e[_]("writable")&&(t.writable=!!e.writable),e[_]("get")){var i=e.get;D!==U(i)&&"undefined"!==i&&C("bad get"),t.get=i}if(e[_]("set")){var r=e.set;D!==U(r)&&"undefined"!==r&&C("bad set"),t.set=r}return("get"in t||"set"in t)&&("value"in t||"writable"in t)&&C("identity-confused descriptor"),t},H=p.defineProperties||function(e,n){("object"!==A(e)||null===e)&&C("bad obj"),n=p(n);for(var t=I(n),i=[],r=0;r<t.length;r++)i.push([t[r],G(n[t[r]],e)]);for(var r=0;r<i.length;r++)$(e,i[r][0],i[r][1]);return e},J=function(){},K=p.create||function(e,n){var t,l=function(){};return l[i]=e,t=new l,t[r]=e,"object"===A(n)&&H(t,n),t},Q=function(){var e,n,t,i,r,l,u,a=arguments;for(n=a[0]||{},e=a.length,l=1;e>l;l++)if(t=a[l],R===U(t))for(r in t)t[_](r)&&t[q](r)&&(i=t[r],u=U(i),n[r]=M&u?0+i:(P|T)&u?i.slice(0):i);return n},W=function(e,n,i){var r,l,u=!!n;if(u||i)if(r={},n=u?n+"$":n,i&&D===U(i))for(l in e)e[_](l)&&(t!==l?(u&&D===U(e[l])&&(r[n+l]=e[l]),r[i(l,e[l])]=e[l]):r[l]=e[l]);else for(l in e)e[_](l)&&(t!==l?(u&&D===U(e[l])&&(r[n+l]=e[l]),i&&l in i?r[i[l]]=e[l]:r[l]=e[l]):r[l]=e[l]);else r=e;return r},X=function(e){var n=e[a]||J,t=e[a+"v"]||J,i=null;return[function(t,r,l,u,a,o,f,c,s,b,m){var d,p;return i===t?d=n.call(this,t,r,l,u,a,o,f,c,s,b,m):(p=e[t])&&(i=t,d=p.call(this,r,l,u,a,o,f,c,s,b,m),i=null),d},function(n,r){var l,u;return i===n?l=t.call(this,n,r):(u=e[n])&&(i=n,l=r&&r.length?u.apply(this,r):u.call(this),i=null),l}]},Y=function(e,n){return this instanceof Y?(this.factory=e,void(this.qualifier=(M===U(n)?n:0)|s)):new Y(e,n)},Z=function(e,n){return this instanceof Z?(this.prop=e,void(this.qualifier=(M===U(n)?n:0)|s)):new Z(e,n)},en=function(e,r,s,v){e=e||p,r=r||{};var g,h,y,x,w,E,j,q,$,A,C=e[o]||null,N=e[f]||{},O=e[i],S=null,F=Q({},N),L=null,V={};r[_](t)||(r[t]=function(){}),g=r[t],r[_](u)&&(V=r[u]||{},delete r[u]),r[_](l)&&(S=r[l],L=I(S),delete r[l]);for($ in r)if(r[_]($)){if(A=r[$],A instanceof Y){if(m&A.qualifier){d&A.qualifier?F[$]=A:((S=S||{})[$]=A.factory(e,V,g),(L=L||[]).push($)),delete r[$];continue}if(b&A.qualifier){V[$]=A,delete r[$];continue}A=r[$]=A.factory(O,V,g)}D===U(A)&&(A[a]=O[$]||J)}for($ in V)V[_]($)&&(A=V[$],A instanceof Y&&(A=V[$]=A.factory(O,V,g)),D!==U(A)&&delete V[$]);if(g[i]=W(K(O),s,v),g[i]=Q(g[i],r),h=X(O),w={},w[c]=w[t]={value:g,enumerable:!1,writable:!0,configurable:!0},w[a]={value:h[0],enumerable:!1,writable:!0,configurable:!0},w[a+"v"]={value:h[1],enumerable:!1,writable:!0,configurable:!0},H(g[i],w),w={},C||L)for(C=z(C||[],L||[]),x=C.length,y=0;x>y;y++){if(E=C[y],j=null,S&&n!==S[E]){if((A=S[E])instanceof Y){if((m|d)&A.qualifier){F[E]=A;continue}j=A.factory(e,V,g)}else{if(F[_](E))continue;j=S[E]}D===U(j)&&(j[a]=e[E]||J)}else n!==e[E]&&(q=U(e[E]),j=R===q?Q(null,e[E]):(P|T)&q?e[E].slice(0):M&q?0+e[E]:e[E]);w[E]={value:j,enumerable:!1,writable:!0,configurable:!0}}for(E in F)F[_](E)&&(j=F[E].factory(e,V,g),w[E]={value:j,enumerable:!1,writable:!0,configurable:!0});return w[o]={value:C,enumerable:!1,writable:!0,configurable:!0},w[f]={value:F,enumerable:!1,writable:!0,configurable:!0},w[a]={value:e,enumerable:!1,writable:!0,configurable:!0},H(g,w),g},nn=Q,tn=Q,rn=function(e){var t,r,l,u;if(D===U(e)){if(a in e&&(e[a]=n),c in e&&(e[c]=n),f in e&&(e[f]=n),o in e){for(l=e[o],t=0,r=l.length;r>t;t++)u=l[t],u in e&&(D===U(e[u])&&e[u][a]&&(e[u][a]=n),e[u]=n);e[o]=n}l=e[i];for(u in l)D===U(l[u])&&(l[u][a]&&(l[u][a]=n),l[u]=n);l[a]=n,l[a+"v"]=n}},ln=function(){var e=arguments,n=e.length,t=null;if(m===e[0])return e[1]||{};if(n>=2){var r=U(e[0]);r=D===r?{Extends:e[0]}:R===r?e[0]:{Extends:p};var l,u,a=e[1]||{},o={},f=r[_]("Extends")?r.Extends:r[_]("extends")?r["extends"]:p,c=r[_]("Implements")?r.Implements:r[_]("implements")?r["implements"]:null,s=r[_]("Mixin")?r.Mixin:r[_]("mixin")?r.mixin:null,b=null;if(c=c?[].concat(c):null,s=s?[].concat(s):null)for(l=0,u=s.length;u>l;l++)R===U(s[l])?s[l][_]("mixin")&&s[l].mixin&&s[l].mixin[i]&&(b=W(s[l].mixin[i],s[l].namespace||null,s[l].as||null),o=tn(o,b)):s[l][i]&&(b=s[l][i],o=tn(o,b));if(c)for(l=0,u=c.length;u>l;l++)R===U(c[l])?c[l][_]("implements")&&c[l]["implements"]&&c[l]["implements"][i]&&(b=W(c[l].implements[i],c[l].namespace||null,c[l].as||null),o=nn(o,b)):c[l][i]&&(b=c[l][i],o=nn(o,b));t=R===U(f)?en(f.extends||p,Q(o,a),f.namespace||null,f.as||null):en(f,Q(o,a))}else t=en(p,e[0]);return t};e.Classy={VERSION:"0.9.3",PUBLIC:s,STATIC:m,LATE:d,PRIVATE:b,Type:U,Create:K,Merge:Q,Alias:W,Implements:nn,Mixin:tn,Extends:en,Dispose:rn,Method:Y,Prop:Z,Class:ln}}(e),e.Classy});
/**
*  PublishSubscribe
*  A simple publish-subscribe implementation for PHP, Python, Node/JS
*
*  @version: 0.4
*  https://github.com/foo123/PublishSubscribe
*
**/
!function(t,s,n){"use strict";var e,i="object"==typeof module&&module.exports,o="function"==typeof define&&define.amd;i?module.exports=(module.$deps=module.$deps||{})[s]=module.$deps[s]||n.call(t,{NODE:module})||1:o&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(s)?define(s,["require","exports","module"],function(s,e,i){return n.call(t,{AMD:i})}):s in t||(t[s]=e=n.call(t,{})||1)&&o&&define(s,[],function(){return e})}(this,"PublishSubscribe",function(){"use strict";function t(t){if(t)for(var s in t)t[O](s)&&(this[s]=t[s])}function s(s,n,e,i,o){var l=this;l.target=s,l.topic=n?[].concat(n):[],e&&(l.originalTopic=[].concat(e)),l.tags=i?[].concat(i):[],l.namespaces=o?[].concat(o):[],l.data=new t,l.timestamp=S(),l._propagates=!0,l._stopped=!1,l._aborted=!1}function n(){return{notopics:{notags:{namespaces:{},list:[],oneOffs:0},tags:{}},topics:{}}}function e(t){return t.length>0}function i(t,s){var n,i,o,l;return s=String(s),n=s.indexOf(t[2]),i=s.indexOf(t[1]),n>-1?(l=s.slice(n).split(t[2]).filter(e).sort(),s=s.slice(0,n)):l=[],i>-1?(o=s.slice(i).split(t[1]).filter(e).sort(),s=s.slice(0,i)):o=[],s=s.split(t[0]).filter(e),[s,o,l]}function o(t,s){var n,e,o,l,p,a,r,u,c=[],f=[];for(s=i(t,s),n=s[2],e=s[1],s=s[0],o=s.length;o;)c.push(s.join(w)),s.pop(),o--;if(o=e.length,o>1){for(u=1<<o,l=u-1;l>=1;l--){for(r=[],p=0,a=1;o>p;p++,a=1<<p)l!==a&&l&a&&r.push(e[p]);r.length&&f.push(r.join(j))}f=f.concat(e)}else o&&f.push(e[0]);return[c.length?c[0]:"",c,f,n]}function l(t,s,n){var e,i;for(e=0;n>e;e++)i="ns_"+s[e],t[O](i)?t[i]++:t[i]=1}function p(t,s,n){var e,i;for(e=0;n>e;e++)i="ns_"+s[e],t[O](i)&&(t[i]--,t[i]<=0&&delete t[i])}function a(t,s,n){var e,i;for(e=0;n>e;e++)if(i="ns_"+s[e],!t[O](i)||0>=t[i])return!1;return!0}function r(t,s,n,e,i,o){var l=n?"tp_"+n:!1,p=e?"tg_"+e:!1;if(l&&t.topics[O](l)){if(p&&t.topics[l].tags[O](p)){if(t.topics[l].tags[p].list.length&&(0>=o||a(t.topics[l].tags[p].namespaces,i,o)))return s.push([n,e,o>0,t.topics[l].tags[p]]),!0}else if(t.topics[l].notags.list.length&&(0>=o||a(t.topics[l].notags.namespaces,i,o)))return s.push([n,null,o>0,t.topics[l].notags]),!0}else if(p&&t.notopics.tags[O](p)){if(t.notopics.tags[p].list.length&&(0>=o||a(t.notopics.tags[p].namespaces,i,o)))return s.push([null,e,o>0,t.notopics.tags[p]]),!0}else if(t.notopics.notags.list.length&&(0>=o||a(t.notopics.notags.namespaces,i,o)))return s.push([null,null,!0,t.notopics.notags]),!0;return!1}function u(t,s,n){var e,i,l,p,a,u,c=o(t,n),f=c[1],g=c[2],h=c[3],b=c[0],_=[];if(a=g.length,u=h.length,e=f.length)for(;e;){if(i=f[0],s.topics[O]("tp_"+i))if(a>0)for(p=0;a>p;p++)l=g[p],r(s,_,i,l,h,u);else r(s,_,i,null,h,u);f.shift(),e--}if(a>0)for(p=0;a>p;p++)l=g[p],r(s,_,null,l,h,u);return r(s,_,null,null,h,u),[b,_,h]}function c(t){if(t&&t[O]("list")){var s,n,e,i;if((e=t.list)&&(n=e.length))if(t.oneOffs>0)for(s=n-1;s>=0;s--)i=e[s],i[1]&&i[4]>0&&(e.splice(s,1),t.oneOffs=t.oneOffs>0?t.oneOffs-1:0);else t.oneOffs=0}return t}function f(t,n,e,i,o){if(e){var l,p,r,f,g,h,b,_,d,m,v,O,y,$,x=u(n,e,i),T=!1;for(_=x[0],v=x[2],y=v.length,x=x[1],r=x.length,$=null,r>0&&($=new s(t),$.data.data=o,$.originalTopic=_?_.split(w):[]),l=0;r>l;l++){for(d=x[l][0],m=x[l][1],$.topic=d?d.split(w):[],$.tags=m?m.split(j):[],O=x[l][2],h=x[l][3],g=[],f=h.list.length,p=0;f>p;p++)b=h.list[p],b[1]&&b[4]||!(!O||b[2]&&a(b[2],v,y))||g.push(b);for(f=g.length,p=0;f>p&&(b=g[p],$.namespaces=O?b[3].slice(0):[],b[4]=1,T=b[0]($),!1!==T&&!$.stopped()&&!$.aborted());p++);if(c(h),$.aborted()||!$.propagates())break}$&&($.dispose(),$=null)}}function g(s,n,e){var i=n[0],o=n[2],n=n[1];s.non_local=new t({t:0,s:0,start_topic:!0,subscribers:null,topics:n,namespaces:o,hasNamespace:!1,abort:e}),s.originalTopic=i?i.split(w):[];var l=function(t){var s,n,e,i,o,l=t.non_local;if(l.t<l.topics.length){if(l.start_topic){if(c(l.subscribers),t.aborted()||!t.propagates())return t.aborted()&&"function"==typeof l.abort&&l.abort(t),!1;n=l.topics[l.t][0],e=l.topics[l.t][1],t.topic=n?n.split(w):[],t.tags=e?e.split(j):[],l.hasNamespace=l.topics[l.t][2],l.subscribers=l.topics[l.t][3],l.s=0,l.start_topic=!1}if(l.s<l.subscribers.list.length){if(t.aborted()||t.stopped())return c(l.subscribers),t.aborted()&&"function"==typeof l.abort&&l.abort(t),!1;for(o=!1;l.s<l.subscribers.list.length&&!o;)i=l.subscribers.list[l.s],i[1]&&i[4]||!(!l.hasNamespace||i[2]&&a(i[2],l.namespaces,l.namespaces.length))||(o=!0),l.s+=1;o&&(t.namespaces=l.hasNamespace?i[3].slice(0):[],i[4]=1,s=i[0](t))}l.s>=l.subscribers.list.length&&(l.t+=1,l.start_topic=!0)}else c(l.subscribers),t&&(t.non_local.dispose(),t.non_local=null,t.dispose(),t=null)};return l}function h(t,n,e,i,o,l){if(e){var p,a=u(n,e,i),r=null;a[1].length>0&&(r=new s(t),r.data.data=o,r.pipeline(p=g(r,a,l)),p(r))}}function b(t,s,n,e,o,p){if(s&&"function"==typeof e){n=i(t,n);var a,r,u,c,f,g,h,b=n[1].join(j),_=b.length,d=n[2],m=d.length;if(n=n[0].join(w),o=!0===o,p=!0===p,f={},m)for(h=0;m>h;h++)f["ns_"+d[h]]=1;g=d.slice(0),r=null,n.length?(u="tp_"+n,s.topics[O](u)||(s.topics[u]={notags:{namespaces:{},list:[],oneOffs:0},tags:{}}),_?(c="tg_"+b,s.topics[u].tags[O](c)||(s.topics[u].tags[c]={namespaces:{},list:[],oneOffs:0}),r=s.topics[u].tags[c]):r=s.topics[u].notags):_?(c="tg_"+b,s.notopics.tags[O](c)||(s.notopics.tags[c]={namespaces:{},list:[],oneOffs:0}),r=s.notopics.tags[c]):m&&(r=s.notopics.notags),null!==r&&(a=m?[e,o,f,g,0]:[e,o,!1,[],0],p?r.list.unshift(a):r.list.push(a),o&&r.oneOffs++,m&&l(r.namespaces,d,m))}}function _(t,s,n,e,i){var o,l=t.list.length;if(s){if(null!=n&&l>0)for(;--l>=0;)n===t.list[l][0]&&(i&&t.list[l][2]&&a(t.list[l][2],e,i)?(o=T(t.list[l][2]),p(t.namespaces,o,o.length),t.list[l][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(l,1)):i||(t.list[l][2]&&(o=T(t.list[l][2]),p(t.namespaces,o,o.length)),t.list[l][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(l,1)))}else if(!s&&i>0&&l>0)for(;--l>=0;)t.list[l][2]&&a(t.list[l][2],e,i)&&(o=T(t.list[l][2]),p(t.namespaces,o,o.length),t.list[l][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(l,1));else!s&&l>0&&(t.list=[],t.oneOffs=0,t.namespaces={})}function d(t,s,n,e){if(s){n=i(t,n);var o,l,p,a,r,u,c=n[1].join(j),f=n[2],g=c.length,h=f.length;if(n=n[0].join(w),r=n.length,p=r?"tp_"+n:!1,a=g?"tg_"+c:!1,u=!(!e||"function"!=typeof e),u||(e=null),r&&s.topics[O](p))g&&s.topics[p].tags[O](a)?(_(s.topics[p].tags[a],u,e,f,h),s.topics[p].tags[a].list.length||delete s.topics[p].tags[a]):g||_(s.topics[p].notags,u,e,f,h),s.topics[p].notags.list.length||T(s.topics[p].tags).length||delete s.topics[p];else if(!r&&(g||h))if(g){s.notopics.tags[O](a)&&(_(s.notopics.tags[a],u,e,f,h),s.notopics.tags[a].list.length||delete s.notopics.tags[a]);for(o in s.topics)s.topics[O](o)&&s.topics[o].tags[O](a)&&(_(s.topics[o].tags[a],u,e,f,h),s.topics[o].tags[a].list.length||delete s.topics[o].tags[a])}else{_(s.notopics.notags,u,e,f,h);for(l in s.notopics.tags)s.notopics.tags[O](l)&&(_(s.notopics.tags[l],u,e,f,h),s.notopics.tags[l].list.length||delete s.notopics.tags[l]);for(o in s.topics)if(s.topics[O](o)){_(s.topics[o].notags,u,e,f,h);for(l in s.topics[o].tags)s.topics[o].tags[O](l)&&(_(s.topics[o].tags[l],u,e,f,h),s.topics[o].tags[l].list.length||delete s.topics[o].tags[l])}}}}var m="0.4",v="prototype",O="hasOwnProperty",y="/",$="#",x="@",w="/",j="#",T=Object.keys,S=Date.now?Date.now:function(){return(new Date).getTime()};t[v]={constructor:t,dispose:function(t){if(t)for(var s=0;s<t.length;s++)this[t[s]]=null;return this}},s[v]={constructor:s,target:null,topic:null,originalTopic:null,tags:null,namespaces:null,data:null,timestamp:0,is_pipelined:!1,_next:null,_propagates:!0,_stopped:!1,_aborted:!1,dispose:function(){var s=this;return s.target=null,s.topic=null,s.originalTopic=null,s.tags=null,s.namespaces=null,s.data instanceof t&&s.data.dispose(),s.data=null,s.timestamp=null,s.is_pipelined=!1,s._propagates=!0,s._stopped=!0,s._aborted=!1,s._next=null,s},next:function(){return"function"==typeof this._next&&this._next(this),this},pipeline:function(t){return arguments.length||(t=null),"function"==typeof t?(this._next=t,this.is_pipelined=!0):(this._next=null,this.is_pipelined=!1),this},propagate:function(t){return arguments.length||(t=!0),this._propagates=!!t,this},stop:function(t){return arguments.length||(t=!0),this._stopped=!!t,this},abort:function(t){return arguments.length||(t=!0),this._aborted=!!t,this},aborted:function(){return this._aborted},propagates:function(){return this._propagates},stopped:function(){return this._stopped}};var D=function(){return this instanceof D?void this.initPubSub():new D};return D.VERSION=m,D.Event=s,D.Data=function(s){return new t(s)},D[v]={constructor:D,_seps:null,_pubsub$:null,initPubSub:function(){var t=this;return t._seps=[y,$,x],t._pubsub$=n(),t},disposePubSub:function(){var t=this;return t._seps=null,t._pubsub$=null,t},setSeparators:function(t){var s,n=this;return t&&(s=t.length)&&(s>0&&t[0]&&(n._seps[0]=t[0]),s>1&&t[1]&&(n._seps[1]=t[1]),s>2&&t[2]&&(n._seps[2]=t[2])),n},trigger:function(t,s,n){var e=this;return 3>arguments.length&&(n=0),n=+n,s=s||{},n>0?setTimeout(function(){f(e,e._seps,e._pubsub$,t,s)},n):f(e,e._seps,e._pubsub$,t,s),e},pipeline:function(t,s,n,e){var i=this;return 4>arguments.length&&(e=0),e=+e,s=s||{},e>0?setTimeout(function(){h(i,i._seps,i._pubsub$,t,s,n||null)},e):h(i,i._seps,i._pubsub$,t,s,n||null),i},on:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s),n},one:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!0),n},on1:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!1,!0),n},one1:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!0,!0),n},off:function(t,s){var n=this;return d(n._seps,n._pubsub$,t,s||null),n}},D});
/**
*
*   Asynchronous.js
*   @version: 0.4.5
*
*   Simple JavaScript class to manage asynchronous, parallel, linear, sequential and interleaved tasks
*   https://github.com/foo123/asynchronous.js
*
**/!function(n,e,t){"use strict";var r,o="object"==typeof module&&module.exports,s="function"==typeof define&&define.amd;o?module.exports=(module.$deps=module.$deps||{})[e]=module.$deps[e]||t.call(n,{NODE:module})||1:s&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["require","exports","module"],function(e,r,o){return t.call(n,{AMD:o})}):e in n||(n[e]=r=t.call(n,{})||1)&&s&&define(e,[],function(){return r})}(this,"Asynchronous",function(exports){return!function(root,exports,undef){"use strict";function formatOptions(n){var e,t=[];if(n)for(e in n)t.push(e+"="+n[e]);return t.join(",")}function runParallelised(n){n.$runmode=PARALLELISED,n.$running=!1}function runLinearised(n,e){var t,r=n,o=r.$queue;if(r.$runmode=LINEARISED,o){for(;o.length&&(!o[0]||!o[0].canRun());)o.shift();o.length?(r.$running=!0,t=o.shift(),e?t.runWithArgs(e):t.run(),t.complete()):r.$running=!1}}function runInterleaved(n,e){var t,r=n,o=r.$queue,s=0;if(r.$runmode=INTERLEAVED,o&&o.length){for(r.$running=!0;s<o.length;)t=o[s],t&&t.canRun()?(e?t.runWithArgs(e):t.run(),t.isFinished()?(o.shift(),t.complete()):s++):o.shift();r.$running=!1,r.$timer=SetTime(curry(runInterleaved,r),r.$interval)}}function runSequenced(n,e){var t,r=n,o=r.$queue;r.$runmode=SEQUENCED,o&&o.length&&(t=o[0],t&&t.canRun()?(r.$running=!0,e?t.runWithArgs(e):t.run(),t.isFinished()&&(o.shift(),t.complete())):o.shift(),r.$running=!1,r.$timer=SetTime(curry(runSequenced,r),r.$interval))}var PROTO="prototype",HAS="hasOwnProperty",Obj=Object,Arr=Array,Func=Function,FP=Func[PROTO],OP=Obj[PROTO],AP=Arr[PROTO],slice=FP.call.bind(AP.slice),toString=OP.toString,is_function=function(n){return"function"==typeof n},is_instance=function(n,e){return n instanceof e},SetTime=setTimeout,ClearTime=clearTimeout,UNDEFINED=undef,UNKNOWN=0,NODE=1,BROWSER=2,DEFAULT_INTERVAL=60,NONE=0,INTERLEAVED=1,LINEARISED=2,PARALLELISED=3,SEQUENCED=4,isNode="undefined"!=typeof global&&"[object global]"===toString.call(global),isNodeProcess=!(!isNode||!process.env.NODE_UNIQUE_ID),isBrowser=!isNode&&"undefined"!=typeof navigator,isWebWorker=isBrowser&&"function"==typeof importScripts&&is_instance(navigator,WorkerNavigator),isBrowserWindow=isBrowser&&!isWebWorker&&!!root.opener,isAMD="function"==typeof define&&define.amd,supportsMultiThread=isNode||"function"==typeof Worker,isThread=isNodeProcess||isWebWorker,Thread,numProcessors=isNode?require("os").cpus().length:4,fromJSON=JSON.parse,toJSON=JSON.stringify,onMessage,curry=function(n,e){return function(){return n(e)}},URL="undefined"!=typeof root.webkitURL?root.webkitURL:"undefined"!=typeof root.URL?root.URL:null,blobURL=function(n,e){return n&&URL?URL.createObjectURL(new Blob(n.push?n:[n],e||{type:"text/javascript"})):n},path=function(n){var e;return isNode?{file:__filename,path:__dirname}:isWebWorker?{file:e=self.location.href,path:e.split("/").slice(0,-1).join("/")}:isAMD&&n&&n.uri?{file:e=n.uri,path:e.split("/").slice(0,-1).join("/")}:isBrowser&&(e=document.getElementsByTagName("script"))&&e.length?{file:e=e[e.length-1].src,path:e.split("/").slice(0,-1).join("/")}:{path:null,file:null}},thisPath=path(exports.AMD),tpf=thisPath.file,notThisPath=function(n){return!(!n||!n.length||n===tpf)},extend=function(n,e){if(n=n||{},e)for(var t in e)e[HAS](t)&&(n[t]=e[t]);return n},_uuid=0;if(onMessage=isWebWorker?function(n){n&&(onmessage=n)}:isNodeProcess?function(n){n&&process.on("message",function(e){n(fromJSON(e))})}:function(){},isNode){var fs=require("fs"),ps=require("child_process");root.close=function(){process.exit()},root.postMessage=function(n){process.send(toJSON({data:n}))},root.importScripts=function(scripts){if(scripts&&(scripts=scripts.split(",")).length)for(var i=0,src,ok;i<scripts.length;){ok=!0;try{src=fs.readFileSync(scripts[i++]),eval(src)}catch(e){ok=e}if(!0!==ok)throw ok}},Thread=function(n){var e=this;e.process=ps.fork(n),e.process.on("message",function(n){e.onmessage&&e.onmessage(fromJSON(n))}),e.process.on("error",function(n){e.onerror&&e.onerror(n)})},Thread[PROTO]={constructor:Thread,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.send(toJSON({data:n})),this},terminate:function(){return this.process&&(this.process.kill(),this.process=null),this}}}else Thread=root.Worker;var BrowserWindow=function(n){var e=this;return e instanceof BrowserWindow?(e.$id=(++_uuid).toString(16),void(e.options=extend({width:400,height:400,toolbar:"no",location:"no",directories:"no",status:"no",menubar:"no",scrollbars:"yes",resizable:"yes"},n))):new BrowserWindow(n)};BrowserWindow[PROTO]={constructor:BrowserWindow,options:null,$id:null,$window:null,dispose:function(){var n=this;return n.$window&&n.close(),n.$window=null,n.$id=null,n.options=null,n},close:function(){var n=this;return n.$window&&(n.$window.closed||n.$window.close(),n.$window=null),n},ready:function(n,e){var t=this,r=function o(){!t.$window||n&&!t.$window[n]?setTimeout(o,40):e()};return setTimeout(r,0),t},open:function(n){var e=this;return!e.$window&&n&&(e.$window=window.open(n.push?blobURL(["ï»¿"].concat(n),{type:"text/html;charset=utf-8"}):n,e.$id,formatOptions(e.options))),e},write:function(n){var e=this;return e.$window&&n&&e.$window.document.write(n),e}};var Task=function(n){if(n instanceof Task)return n;if(!(this instanceof Task))return new Task(n);var e,t=this,r=null,o=null,s=null,i=!1,u=!1,a=!1,l=!1,c=!1,f=!1,p=null,d=0,h=1,m=null,$=null,v=null,g=undef;t.queue=function(n){return arguments.length?(r=n,t):r},t.jumpNext=function(n){r&&r.jumpNext(!1,n)},t.abort=function(n){r&&(r.abort(!1),n&&(r.dispose(),r=null))},t.dispose=function(){r&&(r.dispose(),r=null)},t.task=function(n){return o=n,t},n&&t.task(n),t.run=e=function(){return o.jumpNext=t.jumpNext,o.abort=t.abort,o.dispose=t.dispose,g=o(),i=!0,o.jumpNext=null,o.abort=null,o.dispose=null,g},t.runWithArgs=function(n){return o.jumpNext=t.jumpNext,o.abort=t.abort,o.dispose=t.dispose,g=o.apply(null,n),i=!0,o.jumpNext=null,o.abort=null,o.dispose=null,g},t.canRun=function(){return o&&(!i||u||a||l||c||f)?(u||a)&&d>=m?!1:a&&!p?!1:(l||c)&&g===$?!1:!0:!1},t.iif=function(n,e,r){return n?t.task(e):arguments.length>2&&t.task(r),t},t.until=function(n){return g=undef,p=null,$=n,c=!0,f=!1,u=!1,a=!1,l=!1,t.run=e,t},t.untilNot=function(n){return g=undef,p=null,v=n,f=!0,c=!1,u=!1,a=!1,l=!1,t.run=e,t},t.loop=function(n,e,r){return g=undef,p=null,d=e||0,h=r||1,m=n,u=!0,c=!1,f=!1,a=!1,l=!1,t.run=function(){var n;return n=o(d),d+=h,g=n,i=!0,n},t},t.each=function(n){return g=undef,p=n,d=0,h=1,m=n?n.length||0:0,a=!0,c=!1,f=!1,u=!1,l=!1,t.run=function(){var n;return n=o(p[d],d),d++,g=n,i=!0,n},t},t.recurse=function(n,e){return p=null,g=n,$=e,l=!0,c=!1,f=!1,u=!1,a=!1,t.run=function(){var n;return n=o(g),g=n,i=!0,n},t},t.isFinished=function(){var n=!i||f||c||u||a||l;return n&&(c||l)&&g===$&&(n=!1),n&&f&&g!==v&&(n=!1),n&&(u||a)&&d>=m&&(n=!1),!n},t.onComplete=function(n){return s=n||null,t},t.complete=function(){return s&&is_function(s)&&s(),t}},Asynchronous=exports.Asynchronous=function(n,e){if(is_instance(n,Task))return n;if(is_function(n))return new Task(n);if(!is_instance(this,Asynchronous))return new Asynchronous(n);var t=this;t.$interval=arguments.length?parseInt(n,10):DEFAULT_INTERVAL,t.$timer=null,t.$runmode=NONE,t.$running=!1,t.$queue=[],isThread&&!1!==e&&t.initThread()};if(Asynchronous.VERSION="0.4.5",Asynchronous.Thread=Thread,Asynchronous.Task=Task,Asynchronous.BrowserWindow=BrowserWindow,Asynchronous.MODE={NONE:NONE,INTERLEAVE:INTERLEAVED,LINEAR:LINEARISED,PARALLEL:PARALLELISED,SEQUENCE:SEQUENCED},Asynchronous.Platform={UNDEFINED:UNDEFINED,UNKNOWN:UNKNOWN,NODE:NODE,BROWSER:BROWSER},Asynchronous.supportsMultiThreading=function(){return supportsMultiThread},Asynchronous.isPlatform=function(n){return NODE===n?isNode:BROWSER===n?isBrowser:undef},Asynchronous.isThread=function(n){return NODE===n?isNodeProcess:BROWSER===n?isWebWorker:isThread},Asynchronous.path=path,Asynchronous.blob=blobURL,Asynchronous.load=function(n,e,t){if(n){var r=function(){n=n.split(".");for(var e=root;n.length;)n[0]&&n[0].length&&e[n[0]]&&(e=e[n[0]]),n.shift();return e&&root!==e?is_function(e)?!1!==t?new e:e():e:void 0};return e&&e.length&&(e=e.filter(notThisPath),e.length&&importScripts(e.join(","))),r()}return null},Asynchronous.serialize=function(n){n=n||new Asynchronous;var e=function(e){var t=function(){var t=this,r=arguments;n.step(function(){e.apply(t,r)}),n.$running||n.run(LINEARISED)};return t.free=function(){return e},t};return e.free=function(){n&&n.dispose(),n=null},e},Asynchronous[PROTO]={constructor:Asynchronous,$interval:DEFAULT_INTERVAL,$timer:null,$queue:null,$thread:null,$events:null,$runmode:NONE,$running:!1,dispose:function(){var n=this;return n.unfork(!0),n.$timer&&ClearTime(n.$timer),n.$thread=null,n.$timer=null,n.$interval=null,n.$queue=null,n.$runmode=NONE,n.$running=!1,n},empty:function(){var n=this;return n.$timer&&ClearTime(n.$timer),n.$timer=null,n.$queue=[],n.$runmode=NONE,n.$running=!1,n},interval:function(n){return arguments.length?(this.$interval=parseInt(n,10),this):this.$interval},fork:function(n,e,t){var r,o,s,i=this;if(!i.$thread){if(!supportsMultiThread)throw i.$thread=null,new Error("Asynchronous: Multi-Threading is NOT supported!");isNode?(o="Asynchronous: Thread (Process): ",s="Asynchronous: Thread (Process) Error: "):(o="Asynchronous: Thread (Worker): ",s="Asynchronous: Thread (Worker) Error: "),i.$events=i.$events||{},r=i.$thread=new Thread(tpf),r.onmessage=function(n){if(n.data.event){var e=n.data.event,t=n.data.data||null;i.$events&&i.$events[e]?i.$events[e](t):("console.log"===e||"console.error"===e)&&console.log(o+(t.output||""))}},r.onerror=function(n){if(!i.$events||!i.$events.error)throw new Error(s+n.message+" file: "+n.filename+" line: "+n.lineno);i.$events.error(n)},i.send("initThread",{component:n||null,asInstance:!1!==t,imports:e?[].concat(e):null})}return i},unfork:function(n){var e=this;return e.$thread&&(e.send("dispose"),!0===n&&e.$thread.terminate()),e.$thread=null,e.$events=null,e},initThread:function(){var n=this;return isThread&&(n.$events={},onMessage(function(e){var t=e.data.event,r=e.data.data||null;t&&n.$events[t]?n.$events[t](r):"dispose"===t&&(n.dispose(),close())})),n},listen:function(n,e){return n&&is_function(e)&&this.$events&&(this.$events[n]=e),this},unlisten:function(n,e){return n&&this.$events&&this.$events[n]&&(2>arguments.length||e===this.$events[n])&&delete this.$events[n],this},send:function(n,e){return n&&(isThread?postMessage({event:n,data:e||null}):this.$thread&&this.$thread.postMessage({event:n,data:e||null})),this},task:function(n){return is_instance(n,Task)?n:is_function(n)?Task(n):void 0},iif:function(){var n=arguments,e=new Task;return e.iif.apply(e,n)},until:function(){var n=slice(arguments),e=new Task(n.pop());return e.until.apply(e,n)},untilNot:function(){var n=slice(arguments),e=new Task(n.pop());return e.untilNot.apply(e,n)},loop:function(){var n=slice(arguments),e=new Task(n.pop());return e.loop.apply(e,n)},each:function(){var n=slice(arguments),e=new Task(n.pop());return e.each.apply(e,n)},recurse:function(){var n=slice(arguments),e=new Task(n.pop());return e.recurse.apply(e,n)},step:function(n){var e=this;return n&&e.$queue.push(e.task(n).queue(e)),e},steps:function(){var n,e,t=this,r=arguments;for(e=r.length,n=0;e>n;n++)t.step(r[n]);return t},jumpNext:function(n,e){var t=this,r=t.$queue;return e=e||0,!1!==n?function(){return e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t}:(e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t)},jumpNextWithArgs:function(n,e,t){var r=this,o=r.$queue;return e=e||0,!1!==n?function(){return e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,arguments)),r}:(e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,t)),r)},abort:function(n,e){var t=this;return!1!==n?function(){return e&&e>0?SetTime(function(){t.empty()},e):t.empty(),t}:(e&&e>0?SetTime(function(){t.empty()},e):t.empty(),t)},run:function(n,e){var t=this;return arguments.length?t.$runmode=n:n=t.$runmode,e=e||null,SEQUENCED===n?runSequenced(t,e):INTERLEAVED===n?runInterleaved(t,e):LINEARISED===n?runLinearised(t,e):PARALLELISED===n&&runParallelised(t,e),t}},isThread){var Component=null;root.console={log:function(n){postMessage({event:"console.log",data:{output:n||""}})},error:function(n){postMessage({event:"console.error",data:{output:n||""}})}},onMessage(function(n){var e=n.data.event,t=n.data.data||null;switch(e){case"initThread":t&&t.component&&(Component&&(is_function(Component.dispose)&&Component.dispose(),Component=null),Component=Asynchronous.load(t.component,t.imports,t.asInstance));break;case"dispose":default:Component&&(is_function(Component.dispose)&&Component.dispose(),Component=null),close()}})}}(this,exports),exports.Asynchronous});
/**
*
*   Sudoku.js
*   @version: 0.10
*   @dependencies: Classy.js, PublishSubscribe, Asynchronous.js, jQuery
*
*   Sudoku Builder in JavaScript
*   http://nikos-web-development.netai.net/
*
*   (light-weight and scaled-down version of CrossWord.js, professional Crossword Builder in JavaScript, by same author)
*
**/!function(e,t,l,s){"use strict";function n(e,t,l,s,n){var r;return e?{file:__filename,path:__dirname}:t?{file:r=self.location.href,path:r.split("/").slice(0,-1).join("/")}:l&&n&&n.uri?{file:r=n.uri,path:r.split("/").slice(0,-1).join("/")}:s&&(r=document.getElementsByTagName("script"))&&r.length?{file:r=r[r.length-1].src,path:r.split("/").slice(0,-1).join("/")}:{file:null,path:null}}function r(e,t,l,s,n){var r,o=e.length,i=new Array(o);for(r=0;o>r;r++)i[r]=1===s?l[e[r]]||n(t[r]):2===s?n(e[r]):l[e[r]];return i}function o(e,t,l,s,n,r){var o,i,u,a,c,d,h,f=l.length;if(r){for(o=0;f>o;o++)l[o]in e||importScripts(t+s[o]);return n()}d=document.getElementsByTagName("head")[0],h=document.createElement("a"),i=/^\./,u=0,o=0,a=function(e,l){var s=0,n=document.createElement("script");n.type="text/javascript",n.language="javascript",n.onload=n.onreadystatechange=function(){s||n.readyState&&"loaded"!=n.readyState&&"complete"!=n.readyState||(s=1,n.onload=n.onreadystatechange=null,l(),d.removeChild(n),n=null)},i.test(e)&&(h.href=t+e,e=h.protocol+"//"+h.host+h.pathname+h.search+h.hash),n.src=e,d.appendChild(n)},c=function(){l[o]in e?++o>=f?n():l[o]in e?c():a(s[o],c):++u<30?setTimeout(c,30):(u=0,o++,c())};for(;f>o&&l[o]in e;)o++;f>o?a(s[o],c):n()}l=l||[[],[]];var i,u,a,c="undefined"!=typeof global&&"[object global]"==={}.toString.call(global),d=!c&&"undefined"!=typeof navigator,h=!c&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,f="function"==typeof define&&define.amd,g=c&&"object"==typeof module&&module.exports,p=h?self:e,m=n(c,h,f,d),C=[].concat(l[0]),v=[].concat(l[1]),y=C.length,b=/\.js$/i;if(g)module.$deps=module.$deps||{},module.exports=module.$deps[t]=s.apply(e,[{NODE:module}].concat(r(C,v,module.$deps,1,require)))||1;else if(f&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)){if(!require.defined(t)){for(a={},u=0;y>u;u++)require.specified(C[u])||(a[C[u]]=v[u].replace(b,""));require.config({paths:a}),define(t,["require","exports","module"].concat(C),function(t,l,n){return s.apply(e,[{AMD:n}].concat(r(C,v,arguments,2,t)))})}}else t in p||o(p,m.path+"/",C,v,function(){p[t]=i=s.apply(e,[{}].concat(r(C,v,p)))||1,f&&define(t,["require"],function(){return i})},h)}(this,"Sudoku",[["Classy","PublishSubscribe","Asynchronous"],["./classy.js","./publishsubscribe.js","./asynchronous.js"]],function(e,t,l,s){var n=e.Sudoku={},r="function"==typeof jQuery?jQuery:function(){},o="function"==typeof s?s:{isThread:function(){return!1},path:function(){return{file:null,path:null}}};return!function(t,l,s,n,r){"use strict";var o="prototype",i="hasOwnProperty",u=(Object[o],Array[o],Function[o],Math.round),a=Math.random,c=function(e,t){return u((t-e)*a()+e)},d=function(e){return new Array(e)},h=function y(e){var t,l=e.shift(),s=l?new Array(l):[];if(e.length)for(t=0;l>t;t++)s[t]=y(e.slice(0));return s},f=function(e,t,l){var s,n;if(t=t||{},t[i]("alphabet")&&e===t.alphabet.length)s=alphabet.substr&&alphabet.split?alphabet.split(""):alphabet.slice();else if(s=new Array(e),t[i]("value")){var r=t.value,o=!!r.slice;for(n=0;e>n;n++)s[n]=o?r.slice():r}else{var u=t[i]("start")?parseInt(t.start,10):0,a=t[i]("step")?parseInt(t.step,10):1,c=0;for(n=0;e>n;n++)s[n]=c+u,c+=a}return!0===l&&(s=p(s)),s},g=function(){var e,t,l,s,n,r,o,i,u,a,c,d,h=arguments,f=h.length,g="|^",p="|v";if(f){for(s=1,d=[],u=[],i=[],e=f-1;e>=0;e--)o=h[e],i.unshift("f"+e),o.push?(u.unshift(o[1]),o=o[0]):u.unshift(null),c=o.slice(-2),p===c?(a=!0,o=o.slice(0,-2)):g===c?(a=!1,o=o.slice(0,-2)):a=!1,o=o.length?'["'+o.split(".").join('"]["')+'"]':"",t="a"+o,l="b"+o,u[0]&&(t=i[0]+"("+t+")",l=i[0]+"("+l+")"),n=a?""+s:"-"+s,r=a?"-"+s:""+s,d.unshift("("+t+" < "+l+" ? "+n+" : ("+t+" > "+l+" ? "+r+" : 0))"),s<<=1;return new Function(i.join(","),"return function(a,b) { return ("+d.join(" + ")+"); };").apply(null,u)}return t="a",l="b",n="-1",r="1",d=""+t+" < "+l+" ? "+n+" : ("+t+" > "+l+" ? "+r+" : 0)",new Function("a,b","return ("+d+");")},p=function(e,t){var l,s,n,r;for(r=!0===t?e.slice():e,l=r.length;l--;)s=c(0,l),n=r[l],r[l]=r[s],r[s]=n;return r},m=function(e,t,l){var s,n,r,o,u,a,d;if(d=!0===l?e.slice():e,t=t||{},t[i]("included")&&t.included.length)a=t.included;else if(t[i]("included_range")&&t.included_range.length)for(a=[],s=0,n=0;s<e.length;)n<t.included_range.length&&s>=t.included_range[n]&&(n+1>=t.included_range.length||s<=t.included_range[n+1])?a.push(s):n+=2,s++;else if(t[i]("excluded")&&t.excluded.length)for(a=[],s=0,n=0;s<e.length;)n>=t.excluded.length||s<t.excluded[n]?a.push(s):n++,s++;else if(t[i]("excluded_range")&&t.excluded_range.length)for(a=[],s=0,n=0;s<e.length;)n<t.excluded_range.length&&s>=t.excluded_range[n]?(s=n+1<t.excluded_range.length?t.excluded_range[n+1]:s,n+=2):a.push(s),s++;else a=[];for(r=a.length;r--;)o=c(0,r),u=d[a[r]],d[a[r]]=d[a[o]],d[a[o]]=u;return d},C=function(e,t,l){return t>e?t:e>l?l:e},v=0;l.Merge(t,{VERSION:"0.10",Class:l.Class,StaticClass:function(e){return l.Class(l.STATIC,e)},Asynchronous:n,PublishSubscribe:s,$:r,isWorker:n.isThread(),Path:n.path(e.AMD),UUID:function(e){return[e||"pzl",++v,(new Date).getTime()].join("_")},LOCALE:{},setLocale:function(e){if(e)for(var l in e)e[i](l)&&(t.LOCALE[l]=e[l])},clearLocale:function(){t.LOCALE={}},locale:function(e){return e&&t.LOCALE[i](e)?t.LOCALE[e]:e},array:d,n_array:h,range:f,sorter:g,shuffle:p,shufflex:m,clamp:C,randi:c,randf:function(e,t){return(t-e)*a()+e},randomItem:function(e){return e&&e.length?e[c(0,e.length-1)]:null}})}(n,t,l,o,r),!function(e){"use strict";var t,l="hasOwnProperty",s=(JSON.parse,null),n=function(e,t,l,s){return"insertRule"in e.sheet?(e.sheet.insertRule(t+"{"+l+"}",s),e.sheet.cssRules[s]):"addRule"in e.sheet?(e.sheet.addRule(t,l,s),e.sheet.rules[s]):void 0},r=function(e,t){if("object"==typeof t){var s,r,o=0;for(s in t)t[l](s)&&(r=t[s],r.css=n(e,r.selector,[].concat(r.rules).join("; "),o++))}return t},o=function(e){var t,l=[],s=e.sheet,n=s.cssRules?s.cssRules:s.rules;for(t=0;t<n.length;t++)l.push(n[t].cssText?n[t].cssText:n.style.cssText);return l.join("\n")},i=function(e,t){var l=document.createElement("style");return l.setAttribute("media",e||"all"),l.setAttribute("type","text/css"),l.appendChild(document.createTextNode("")),document.head.appendChild(l),t&&r(l,t),l},u=function(e){e&&document.head.removeChild(e)};t=e.Factory=e.StaticClass({GRIDS:{},getGrid:function(e){return e=e?e.toUpperCase():null,e&&t.GRIDS[l](e)?new t.GRIDS[e]:null},getCompiler:function(t){return e.Compiler&&t&&"SUDOKU"===t.type&&e.SudokuCompiler?new e.SudokuCompiler(t):null},importTpl:function(e){var l=t.getGrid(e?e.type||null:null)||null;return l&&l.importTpl(e),l},createStyleSheet:i,disposeStyleSheet:u,addCSS:r,getCSS:o,getTransformProperty:function(e){if(!s)for(var t=e.style,n="Transform",r=["transform","O"+n,"ms"+n,"Webkit"+n,"Moz"+n],o=r.length;o--;)if(t[l](r[o])){s=r[o];break}return s},getElement:function(e){e=e||"div";var t,l,s,n,r=e.indexOf("#"),o=e.indexOf(".");return r>-1?(t=e.slice(0,r),e=e.slice(r),o-=r):o>-1?(t=e.slice(0,o),e=e.slice(o)):t=e,"#"===e.charAt(0)?o>-1?(l=e.slice(1,o),e=e.slice(o)):l=e.slice(1):l=null,s="."===e.charAt(0)?e.slice(1).split(".").join(" "):null,n=document.createElement(t.length?t:"div"),l&&(n.id=l),s&&(n.className=s),n}})}(n),!function(e){"use strict";function t(e,t){var l,s=new Array(e);for(l=0;e>l;l++)s[l]=l;return t&&(s=v(s)),s}function l(e,t){return function(){var l=this;return!!(0<=l.row&&l.row<e&&0<=l.column&&l.column<t)}}function s(){return k===this.cellType}function n(){return E===this.cellType}function r(){return 0<this.highlightType}function o(){return this.value===this.solution}function i(){var e=this;return b(e).removeClass(B),e.value=e.solution||"",e}function u(){var e=this;return e.firstChild.value="",e}function a(){var e=this;return b(e).removeClass(B),e.value!==e.solution&&(e.value=""),e}function c(){var e=this,t=b(e);return e.value&&e.value.length&&e.solution?e.solution===e.value?t.removeClass(B):t.hasClass(B)||t.addClass(B):t.removeClass(B),e}function d(){var e=this;return b(e).removeClass(B),e}function h(){var e=this;e.highlightType<=0&&(e.highlightType=1,b(e).addClass(H))}function f(){var e=this;e.highlightType>0&&(e.highlightType=0,b(e).removeClass(H))}function g(e,t,l,s,n,o){l=!l;var i,u=e[0],a=u.row,c=u.column;if(!1===t)i=e.nextAll(".cell.default").filter(r),i.length&&i.eq(0).children("input").focus();else if(L===t){for(i=e.prevAll(".cell.default.column-"+c);l&&!i.length&&c>0;)c--,c>=0&&(e=s.filter(".row-last.column-"+c),i=k===e[0].cellType?e:e.prevAll(".cell.default.column-"+c));i.length&&i.eq(0).children("input").focus()}else if(M===t){for(i=e.nextAll(".cell.default.column-"+c);l&&!i.length&&o>c;)c++,o>c&&(e=s.filter(".row-first.column-"+c),i=k===e[0].cellType?e:e.nextAll(".cell.default.column-"+c));i.length&&i.eq(0).children("input").focus()}else if(z===t){for(i=e.prevAll(".cell.default.row-"+a);l&&!i.length&&a>0;)a--,a>=0&&(e=s.filter(".column-last.row-"+a),i=k===e[0].cellType?e:e.prevAll(".cell.default.row-"+a));i.length&&i.eq(0).children("input").focus()}else if(N===t){for(i=e.nextAll(".cell.default.row-"+a);l&&!i.length&&n>a;)a++,n>a&&(e=s.filter(".column-first.row-"+a),i=k===e[0].cellType?e:e.nextAll(".cell.default.row-"+a));i.length&&i.eq(0).children("input").focus()}return i}var p=(Math.floor,Math.round),m=(Math.ceil,Math.min),C=(Math.max,Math.abs,e.clamp),v=e.shuffle,y=e.Factory,b=e.$,S=b.extend,w=e.UUID,x=y.getTransformProperty,T=y.getCSS,_=y.createStyleSheet,A=y.disposeStyleSheet,R=y.getElement,k=1,E=2,I=4,O=8,D=16,z=37,L=38,N=39,M=40,U=1,q=2,B="notvalid",H="highlighted",P="cell-focused",G="hide-clues",j="hide-solution",$="hasOwnProperty";e.Grid=e.Class({"extends":Object,"implements":e.PublishSubscribe},{__static__:{CELL:k,SEP:E,IMAGE:I,PLACEHOLDER:O,CLUE:D,HORIZONTAL:U,VERTICAL:q,ERRORCLASS:B,HIGHLIGHTCLASS:H,FOCUSEDCLASS:P,HIDE_CLUES:G,HIDE_SOLUTION:j,DIRECTION_1:256,TOP_RIGHT_HOR:257,TOP_RIGHT_VER:258,TOP_LEFT_HOR:259,TOP_LEFT_VER:300,DIRECTION_2:512,BOTTOM_LEFT_VER:514,BOTTOM_RIGHT_HOR:513,BOTTOM_LEFT_HOR:515,CLEAR_DIRECTION_1:1256,CLEAR_DIRECTION_2:1512,CLEAR_DIRECTIONS:2048,getRange:t,isCell:s,isSeparatorCell:n,highlightedCell:r,isValidSolution:o,revealCell:i,clearCell:u,clearErrors:a,highlightCell:h,deHighlightCell:f,highlightErrors:c,deHighlightErrors:d,moveCursor:g},constructor:function(){var e=this;e.type="GRID",e.id=w(),e.selector=e.getSelector(),e.dimensions=e.getDefaultDimensions(),e.styles=e.getDefaultStyles(),e.cssStyles=e.getDefaultCssStyles(e.selector,e.styles,e.dimensions),e.style=_("all",e.cssStyles),e.grid=null,e.cells=null,e.cellInputs=null,e.userMode=!1,e.initPubSub()},type:null,id:null,selector:null,grid:null,cells:null,style:null,styles:null,cssStyles:null,dimensions:null,alphabet:null,clues:null,cellInputs:null,currentInputCell:null,toggleErrorsHighlight:!1,toggleHorizontalHighlight:!0,userMode:!1,highlightMode:!1,dispose:function(){var e=this;return e.type=null,e.id=null,e.selector=null,e.dimensions=null,e.alphabet=null,e.clues=null,e.currentInputCell=null,e.toggleErrorsHighlight=null,e.toggleHorizontalHighlight=null,e.cellInputs=null,e.cells=null,e.styles=null,e.cssStyles=null,A(e.style),e.style=null,e.grid&&(e.setSelectable(!1,!0).setResizable(!1,!0),e.grid.off(),e.grid.children().remove(),e.grid.remove()),e.grid=null,e.disposePubSub(),e},getCell:function(e,t){var l=arguments.length<2?e||0:(e||0)*this.dimensions.columns+(t||0);return this.cells.eq(l)},getRow:function(e,t,l){var s=this.dimensions.columns,n=(e||0)*s;return t=t||0,l=l?l+1:s,this.cells.slice(n+t,n+l)},getColumn:function(e,t,l){var s,n,r,o=this,i=o.cells,u=o.dimensions.rows,a=o.dimensions.columns,c=b([]);for(e=e||0,t=t||0,l=l||u-1,r=t*a,s=t,n=r;l>=s;s++,n+=a)c=c.add(i.eq(n+e));return c},getCells:function(e,t,l,s){var n,r,o,i,u=this,a=u.cells,c=u.dimensions.columns,d=u.dimensions.rows;if(!arguments.length)return a.slice(0);for(arguments.length<2?(t=0,l=d-1,s=c-1):arguments.length<3?(l=d-1,s=c-1):arguments.length<4&&(s=c-1),e>l&&(o=e,e=l,l=o),t>s&&(o=t,t=s,s=o),e=C(e,0,d-1),l=C(l,0,d-1),t=C(t,0,c-1),s=C(s,0,c-1),s+=1,n=b([]),i=e*c,r=e,o=i;l>=r;r++,o+=c)n=n.add(a.slice(o+t,o+s));return n},getRange:function(e){var t,l=1/0,s=-1/0,n=1/0,r=-1/0;return e&&e.length?(e.each(function(){var e=this,t=e.row,o=e.column;l>=t&&(l=t),t>=s&&(s=t),n>=o&&(n=o),o>=r&&(r=o)}),t=[{row:l,column:n},{row:s,column:r}]):t=[{row:0,column:0},{row:0,column:0}],t},getCellInputs:function(){var e=this;return e.cellInputs||(e.cellInputs=e.cells.filter(s).children("input")),e.cellInputs},setSelectable:function(e,t){var l,s,n=this,r=n.grid;return b.fn.selectable&&r&&(l=!!r.data("ui-selectable"),s=l?!r.selectable("option","disabled"):!1,e?l?l&&!s&&r.selectable("option","disabled",!1):r.selectable({filter:".cell",autoRefresh:!1}):t&&l?(r.children(".ui-selected").removeClass("ui-selected"),r.selectable("destroy")):s&&!t&&(r.children(".ui-selected").removeClass("ui-selected"),r.selectable("option","disabled",!0).removeClass("ui-state-disabled").attr("aria-disabled","false"))),n},setResizable:function(e,t){var l,s,n,r,o=this,i=o.grid;return b.fn.resizable&&i&&(s=!!i.data("ui-resizable"),l=s?!i.resizable("option","disabled"):!1,e?s?s&&!l&&i.resizable("option","disabled",!1):(n=function(){o.setSelectable(!1)},r=function(){o.setSelectable(!0)},i.on("mousedown.resizablehandle",">.ui-resizable-handle:not(.ui-resizable-image-handle)",n).on("mouseup.resizablehandle",">.ui-resizable-handle:not(.ui-resizable-image-handle)",r).resizable({animate:!1,aspectRatio:!0,autoHide:!0,handles:"all",minHeight:100,minWidth:100,delay:50,ghost:!0,distance:2,helper:"resizable-helper",grid:!1,start:function(){n(),i.addClass("resizing")},stop:function(e,t){var l=o.dimensions,s=(l.cellSize,p(t.size.width/l.columns));l.cellSize=s,i.removeClass("resizing"),r(),o.updateDimensions()}})):t&&s?i.resizable("destroy").off("mousedown.resizablehandle mouseup.resizablehandle resizestart resizestop"):l&&!t&&i.resizable("option","disabled",!0).removeClass("ui-state-disabled").attr("aria-disabled","false")),o},setHighlightMode:function(e){return this.highlightMode=!!e,this},handleInput:function(e,t,l){{var s,n=this,r=n.alphabet,o=t.value.toUpperCase(),i=b(t),u=n.dimensions.rows,a=n.dimensions.columns;n.toggleHorizontalHighlight?N:M}return o.length&&0>r.indexOf(o)&&(o=""),n.toggleErrorsHighlight&&(t.solution&&o.length&&o!==t.solution?i.hasClass(B)||i.addClass(B):i.removeClass(B)),t.value=o,s=o.length&&-1<r.indexOf(o)?g(i.parent(".cell"),!1,!0,n.cells,u,a):i.parent(".cell"),o!==l&&n.trigger("input",{input:t}),s},handleKeyNav:function(e,t){var l=this,s=l.dimensions;return g(t,e.which,!1,l.cells,s.rows,s.columns)},showClues:function(e){var t=this,l=t.grid;return e=arguments.length?!!e:!0,e&&l.hasClass(G)?l.removeClass(G):e||l.hasClass(G)||l.addClass(G),t},showSolution:function(e){var t=this,l=t.grid;return e=arguments.length?!!e:!0,e&&l.hasClass(j)?l.removeClass(j):e||l.hasClass(j)||l.addClass(j),t},enableUserMode:function(e){var t=this,l=t.grid;return e&&!t.userMode?(l.addClass("user-mode"),t.setResizable(!1),t.userMode=!0,t.trigger("userMode",{userMode:!0})):!e&&t.userMode&&(l.removeClass("user-mode"),t.setResizable(!0),t.userMode=!1,t.trigger("userMode",{userMode:!1})),t},scale:function(e){var t=this,l=t.grid[0],s=x(l);return arguments.length?(e=parseFloat(e,10),l.style[s+"Origin"]="center center",l.style[s]="scale("+e+","+e+")"):(l.style[s+"Origin"]="center center",l.style[s]="none"),t},build:function(e){var t=this;return t.buildGrid(e).onBuildComplete().trigger("build",null,50).trigger("percentage",{percentage:t.getPercentage()},100),t},importTpl:function(e){var t=this;return e&&e[$]("dimensions")&&(t.setStyles(e.styles).buildGrid(e.dimensions),e[$]("alphabet")&&e.alphabet&&e.alphabet.length&&t.setAlphabet(e.alphabet),t.onBuildComplete().trigger("build",null,50).trigger("import",null,100)),t},exportTpl:function(){var e=this,t=(e.grid,e.cells,{type:e.type,alphabet:e.alphabet||null,dimensions:S({},e.dimensions),styles:S({},e.styles)});return t},revealSolution:function(){return this.getCellInputs().each(i),this},revealCells:function(e){return e&&e.length&&e.children("input").each(i),this},revealCell:function(e){return e=e||this.currentInputCell||null,e&&e.length&&k===e[0].cellType&&i.call(e[0].firstChild),this},checkIsSolved:function(){var e=this.getCellInputs();return e.filter(o).length===e.length},getSolvedPercent:function(){var e=this.getCellInputs();return e.filter(o).length/(e.length||1)},highlightErrors:function(e){var t=this;return t.toggleErrorsHighlight=!!e,t.getCellInputs().each(t.toggleErrorsHighlight?c:d),t},clearErrors:function(){return this.getCellInputs().each(a),this},getCssStyles:function(e){return e=e?'<link rel="stylesheet" media="all" href="'+e+'" />':"",e+'<style type="text/css" media="all">'+T(this.style)+"</style>"},setStyles:function(e){var t=this,l=t.getDefaultStyles();return t.styles=S({},t.styles||l,e),t.styles[$]("symbolColor")||(t.styles.symbolColor=l.symbolColor),t.styles[$]("clueColor")||(t.styles.clueColor=l.clueColor),t},setDimensions:function(e){var t=this;return t.dimensions=S({},t.dimensions||t.getDefaultDimensions(),e),t},updateStyles:function(e){var t=this,l=t.cssStyles,s=t.styles;return l.grid.css.style.borderColor=s.outerBorderColor,l.grid.css.style.borderWidth=s.outerBorderThickness+"px",l.cell.css.style.backgroundColor=s.cellColor,l.cell.css.style.borderColor=s.borderColor,l.cell.css.style.borderStyle=s.borderStyle,l.cell.css.style.color=s.symbolColor,l.highlighted.css.style.backgroundColor=s.highlightColor,!1!==e&&t.trigger("update-styles"),t},updateDimensions:function(e){{var t,s,n,r,o,i,u,a=this,c=a.dimensions,d=(a.styles,a.cssStyles),h=c.cellSize,f=p(.6*h),g=c.rows,C=c.columns,v=a.grid,y=v[0],S=a.cells;l(g,C)}if(y.className=y.className.replace(/\bnumRows-(\d+)\b/,function(e,t){return n=parseInt(t,10),"numRows-"+g}).replace(/\bnumColumns-(\d+)\b/,function(e,t){return r=parseInt(t,10),"numColumns-"+C}).replace(/\bsizeCell-\d+\b/,"sizeCell-"+h),y.style.width="",y.style.height="",y.style.left="",y.style.top="",d.grid.css.style.width=h*C+"px",d.grid.css.style.height=h*g+"px",d.cell.css.style.width=h+"px",d.cell.css.style.height=h+"px",d.cell.css.style.fontSize=f+"px",S.each(function(){var e=this,t=b(e),l=e.column,s=e.row;s>=g||l>=C?t.remove():(t.removeClass("row-first row-last column-first column-last"),0===s&&t.addClass("row-first"),g-1===s&&t.addClass("row-last"),0===l&&t.addClass("column-first"),C-1===l&&t.addClass("column-last"),e.style.top=s*h+"px",e.style.left=l*h+"px")}),C>r)for(u=m(g,n),t=0;u>t;t++)for(o=v.children(".cell.row-"+t).eq(-1),s=r;C>s;s++)i=a.buildCell(t,s,h,"cell default row-"+t+" column-"+s+(0==t?" row-first":g-1==t?" row-last":"")+(0==s?" column-first":C-1==s?" column-last":"")),o=b(i).insertAfter(o);if(g>n)for(t=n;g>t;t++)for(s=0;C>s;s++)i=a.buildCell(t,s,h,"cell default row-"+t+" column-"+s+(0==t?" row-first":g-1==t?" row-last":"")+(0==s?" column-first":C-1==s?" column-last":"")),v.append(i);return a.cells=v.children(".cell"),v.hasClass("ui-selectable")&&v.selectable("refresh"),!1!==e&&(a.trigger("update-dimensions"),a.trigger("percentage",{percentage:a.getPercentage()},100)),a},setAlphabet:function(e){return e&&e.length&&(this.alphabet=e.join?e.join(""):e.slice()),this},getHighlighted:function(){return this.cells.filter(r)},clearHighlighted:function(){return this.cells.filter(r).each(u),this},clearCells:function(e){var t=this;return!0===e?t.getCellInputs().val(""):t.cells.children("input").val(""),t},decorateCell:function(){return cell},highlightClue:function(){return this},addClue:function(){return this},addClues:function(){return this},clearClues:function(){return this},clearGrid:function(e){return this.clearCells(e).clearClues(),this},buildGrid:function(t){var l,s,n,r,o,i,u,a,c,d=this;for(t=t||{},d.dimensions||(d.dimensions=d.getDefaultDimensions()),d.styles||(d.styles=d.getDefaultStyles()),d.userMode=!1,d.alphabet=d.alphabet||e.ALPHABET,t.rows&&(d.dimensions.rows=t.rows),t.columns&&(d.dimensions.columns=t.columns),t.cellSize&&(d.dimensions.cellSize=t.cellSize),u=d.dimensions.rows,a=d.dimensions.columns,c=d.dimensions.cellSize,o=d.styles,i=d.cssStyles,i.grid.css.style.width=c*a+"px",i.grid.css.style.height=c*u+"px",i.grid.css.style.borderColor=o.outerBorderColor,i.grid.css.style.borderWidth=o.outerBorderThickness+"px",i.cell.css.style.backgroundColor=o.cellColor,i.cell.css.style.borderColor=o.borderColor,i.cell.css.style.borderStyle=o.borderStyle,i.cell.css.style.width=c+"px",i.cell.css.style.height=c+"px",i.cell.css.style.fontSize=p(.6*c)+"px",i.cell.css.style.color=o.symbolColor,i.highlighted.css.style.backgroundColor=o.highlightColor,n=R("div#"+d.id+"."+d.getGridClasses().join(".")),n.setAttribute("id",d.id),l=0;u>l;l++)for(s=0;a>s;s++)r=d.buildCell(l,s,c,["cell default","row-"+l+(0==l?" row-first":u-1==l?" row-last":""),"column-"+s+(0==s?" column-first":a-1==s?" column-last":"")].join(" ")),n.appendChild(r);return d.grid=b(n),d.cells=d.grid.children(".cell"),d},buildCell:function(e,t,l,s){var n=R("div"),r=R("input");return n.cellType=k,n.highlightType=0,n.row=e,n.column=t,n.style.top=e*l+"px",n.style.left=t*l+"px",r.solution=null,r.highlightType=0,r.setAttribute("type","text"),r.setAttribute("value",""),r.setAttribute("maxlength","1"),n.appendChild(r),s&&(n.className=""+s),n},onBuildComplete:function(){return this},getSelector:function(){return"#"+this.id+".crossword"},getGridClasses:function(){var e=this.dimensions;return["crossword","numRows-"+e.rows,"numColumns-"+e.columns,"sizeCell-"+e.cellSize]},getDefaultDimensions:function(){return{rows:10,columns:10,cellSize:76}},getDefaultStyles:function(){return{cellColor:"#ffffff",sepColor:"#f2e941",placeholderColor:"#ffffff",highlightColor:"#dddddd",borderColor:"#7f7f7f",borderStyle:"solid",outerBorderThickness:1,outerBorderColor:"#aaaaaa",symbolColor:"#000000",clueColor:"#000000"}},getDefaultCssStyles:function(e,t,l){return{grid:{selector:e,rules:["width: "+l.columns*l.cellSize+"px","height: "+l.rows*l.cellSize+"px","border-color: "+t.outerBorderColor,"border-width: "+t.outerBorderThickness]},cell:{selector:e+" > .cell",rules:["width: "+l.cellSize+"px","height: "+l.cellSize+"px","font-size: "+p(.6*l.cellSize)+"px","background-color: "+t.cellColor,"border-color: "+t.borderColor,"border-style: "+t.borderStyle,"color: "+t.symbolColor]},highlighted:{selector:e+" > .cell."+H,rules:["background-color: "+t.highlightColor]}}},getSeparatorClasses:function(){return""},getPercentage:function(){return 0},toDefaultCells:function(){return this},toPlaceholderCells:function(){return this},toSeparatorCells:function(){return this},setSolution:function(){return this},setClues:function(){return this},checkCluesMissing:function(){return!1},toString:function(){return"[Sudoku.Puzzle type="+this.type+"]"}})}(n),!function(e){"use strict";function t(e,t){return e.index=t,e.val}function l(){return this.clue}function s(){return!this.clue}function n(e,t,l){var s,n,r,o=t.slice(0),i=l.length;if(!i)return o;for(s=0;i>s;s++)n=l[s],(e.column===n.column||e.row===n.row||e.square===n.square)&&-1<(r=o.indexOf(n.firstChild.value))&&(o[r]="");return o}function r(e){var t=e.cells.filter(l),r=e.cells.filter(s),i=e.alphabet.split("");r.each(function(){var e=this,l=o(e),s=n(e,i,t);l.find(".sticky-note").each(function(e){s[e]?o(this).removeClass("note-disabled"):o(this).addClass("note-disabled")}),l.find(".note").each(function(e){s[e]?o(this).removeClass("note-disabled"):o(this).addClass("note-disabled")})})}var o=e.$,i=(o.extend,Math.round),u=Math.min,a=Math.max,c=e.locale,d=e.range,h=e.Grid,f=(h.moveCursor,e.Factory),g=f.getElement,p=h.CELL,m=h.CLUE,C=27,v=37,y=38,b=39,S=40,w=h.ERRORCLASS,x=(h.HIGHLIGHTCLASS,h.FOCUSEDCLASS,"hasOwnProperty");e.Sudoku=e.Factory.GRIDS.SUDOKU=e.Class(h,{constructor:function(){var e=this;e.$superv("constructor"),e.type="SUDOKU",e.difficulty=1,e.dichromia=!1},difficulty:1,dichromia:!1,dispose:function(){var e=this;return e.difficulty=null,e.dichromia=null,e.$superv("dispose"),e},getSelector:function(){return"#"+this.id+".crossword.sudoku"},getGridClasses:function(){var e=this.$superv("getGridClasses");return e.push("sudoku"),e},getDefaultDimensions:function(){return{rows:9,columns:9,subRows:3,subColumns:3,cellSize:70}},getDefaultStyles:function(){return{cellColor:"#ffffff",sepColor:"#f2e941",placeholderColor:"#ffffff",highlightColor:"#dddddd",borderColor:"#7f7f7f",borderStyle:"dashed",outerBorderThickness:2,outerBorderColor:"#121212",symbolColor:"#608b03",clueColor:"#000000"}},getDefaultCssStyles:function(e,t,l){var s=this.$superv("getDefaultCssStyles",[e,t,l]);return s[x]("separator")&&delete s.separator,s[x]("placeholder")&&delete s.placeholder,s.stickyNotes={selector:e+" > .cell .sticky-notes a.sticky-note:before",rules:["color: "+t.symbolColor]},s.highlighted={selector:[e+" > .cell:not(.clue):hover",e+" > .cell:not(.clue):focus"].join(","),rules:["background-color: "+t.highlightColor]},s.cellClue={selector:e+" > .cell.clue",rules:["color: "+t.clueColor]},s.cellSubRowLast={selector:e+" > .cell.subrow-last:not(.row-last)",rules:["border-bottom-color: "+t.outerBorderColor,"border-bottom-width: "+t.outerBorderThickness+"px","border-bottom-style: solid"]},s.cellSubColLast={selector:e+" > .cell.subcolumn-last:not(.column-last)",rules:["border-right-color: "+t.outerBorderColor,"border-right-width: "+t.outerBorderThickness+"px","border-right-style: solid"]},s},updateStyles:function(e){var t=this,l=t.cssStyles,s=t.styles;return t.$superv("updateStyles",[!1]),l.cellClue.css.style.color=s.clueColor,l.stickyNotes.css.style.color=s.symbolColor,l.cellSubRowLast.css.style.borderBottomColor=s.outerBorderColor,l.cellSubRowLast.css.style.borderBottomWidth=s.outerBorderThickness+"px",l.cellSubColLast.css.style.borderRightColor=s.outerBorderColor,l.cellSubColLast.css.style.borderRightWidth=s.outerBorderThickness+"px",!1!==e&&t.trigger("update-styles"),t},updateDimensions:function(e){var t=this;return t.$superv("updateDimensions",[!1]),!1!==e&&t.trigger("update-dimensions"),t},enableNotes:function(e){var t=this,l=t.grid;return t.userMode&&(e?l.hasClass("notes")||(t.enableAllNotes(!1),l.addClass("notes")):l.removeClass("notes")),t},enableAllNotes:function(e){var t=this,l=t.grid;return t.userMode&&(e?l.hasClass("all-notes")||(t.enableNotes(!1),l.addClass("all-notes")):l.removeClass("all-notes")),t},clearNotes:function(){return this.cells.removeClass("with-notes").find(".sticky-note.noted").removeClass("noted"),this},handleInput:function(e,t,l){{var s=this,n=s.alphabet,r=t.value.toUpperCase(),i=o(t);s.dimensions.rows,s.dimensions.columns}r.length&&0>n.indexOf(r)&&(r=""),s.toggleErrorsHighlight&&(t.solution&&r.length&&r!==t.solution?i.hasClass(w)||i.addClass(w):i.removeClass(w)),t.value=r,r!==l&&s.trigger("input",{input:t})},buildGrid:function(e){var t,l,s,n,r,u,a,c,d,h,f,p,m,C,v,y,b=this;for(e=e||{},b.dimensions||(b.dimensions=b.getDefaultDimensions()),b.styles||(b.styles=b.getDefaultStyles()),b.userMode=!1,e.rows&&(b.dimensions.rows=e.rows),e.columns&&(b.dimensions.columns=e.columns),e.subRows&&(b.dimensions.subRows=e.subRows),e.subColumns&&(b.dimensions.subColumns=e.subColumns),e.cellSize&&(b.dimensions.cellSize=e.cellSize),a=b.dimensions.rows,c=b.dimensions.columns,h=b.dimensions.subRows,f=b.dimensions.subColumns,d=b.dimensions.cellSize,r=b.styles,u=b.cssStyles,u.grid.css.style.width=d*c+"px",u.grid.css.style.height=d*a+"px",u.grid.css.style.borderColor=r.outerBorderColor,u.grid.css.style.borderWidth=r.outerBorderThickness+"px",u.cell.css.style.backgroundColor=r.cellColor,u.cell.css.style.borderColor=r.borderColor,u.cell.css.style.borderStyle=r.borderStyle,u.cell.css.style.width=d+"px",u.cell.css.style.height=d+"px",u.cell.css.style.fontSize=i(.6*d)+"px",u.cell.css.style.color=r.symbolColor,u.cellClue.css.style.color=r.clueColor,u.stickyNotes.css.style.color=r.symbolColor,u.highlighted.css.style.backgroundColor=r.highlightColor,u.cellSubRowLast.css.style.borderBottomColor=r.outerBorderColor,u.cellSubRowLast.css.style.borderBottomWidth=r.outerBorderThickness+"px",u.cellSubColLast.css.style.borderRightColor=r.outerBorderColor,u.cellSubColLast.css.style.borderRightWidth=r.outerBorderThickness+"px",s=g("div#"+b.id+"."+b.getGridClasses().join(".")),s.setAttribute("id",b.id),v=0,y=h,t=0;a>t;t++){for(p=t%h,C=0,l=0;c>l;l++)m=l%f,n=b.buildCell(h,f,t,l,v+C,d,["cell default","row-"+t+(0==t?" row-first":a-1==t?" row-last":"")+(0==p?" subrow-first":h-1==p?" subrow-last":""),"column-"+l+(0==l?" column-first":c-1==l?" column-last":"")+(0==m?" subcolumn-first":f-1==m?" subcolumn-last":""),"square-"+(v+C)].join(" ")),s.appendChild(n),f-1==m&&C++;h-1==p&&(v+=y)}return b.grid=o(s),b.cells=b.grid.children(".cell"),b.setDichromia(b.dichromia),b.setResizable(!0,!0),b},buildCell:function(e,t,l,s,n,r,o){var c,d,h,f,p,C,v,y=g("div"),b=g("input"),S=g("div.notes"),w=g("div.sticky-notes"),x=a(t,e),T=u(t,e),_=i(100/x),A=i(2*_);for(h=0,c=0;T>c;c++){for(f=g("div.note-row"),p=g("div.note-row"),d=0;x>d;d++)C=g("a.note"),v=g("a.sticky-note"),C.href="#",C.title=" ",C.style.fontSize=A+"%",C.style.paddingBottom=C.style.width=_+"%",v.href="#",v.title=" ",v.style.fontSize=A+"%",v.style.paddingBottom=v.style.width=_+"%",f.appendChild(C),p.appendChild(v);S.appendChild(f),w.appendChild(p)}return y.cellType=m,y.highlightType=0,y.row=l,y.column=s,y.square=n,y.clue=!0,y.style.top=l*r+"px",y.style.left=s*r+"px",b.solution=null,b.highlightType=0,b.readOnly=!1,b.setAttribute("type","text"),b.setAttribute("value",""),b.setAttribute("maxlength","1"),y.appendChild(b),y.appendChild(w),y.appendChild(S),o&&(y.className=""+o),y},onBuildComplete:function(){var e=this,t=e.grid;return o.fn.contextMenu&&t.contextMenu({selector:".cell",items:{"make-clue":{name:c("MAKE_CLUE"),icon:"add-definition"},"unmake-clue":{name:c("UNMAKE_CLUE"),icon:"clear"}},callback:function(t){e.decorateCell(o(this),t)}}),t.on("keydown click focus",".cell:not(.clue) > input",function(t){var l,s,n,r=t.target,i=o(r).closest(".cell"),u=e.cells;if(p===i[0].cellType)if(s=e.currentInputCell,e.currentInputCell=i,"keydown"===t.type){if(l=t.which,C===l)return setTimeout(function(){u.removeClass("current")},100),t.preventDefault(),t.stopPropagation(),!1;if(y===l||S===l||v===l||b===l)return u.removeClass("current"),setTimeout(function(){e.handleKeyNav(t,i)},100),t.preventDefault(),t.stopPropagation(),!1;u.removeClass("current"),n=r.value,setTimeout(function(){e.handleInput(t,r,n),r.value.length?i.addClass("no-notes"):i.removeClass("no-notes")},100)}else s&&s.removeClass("current")}),t.on("click",".cell:not(.clue)",function(t){var l,s=o(t.target);return p===s[0].cellType&&(l=e.currentInputCell,e.currentInputCell=s,l&&l.removeClass("current"),s.addClass("current")),t.preventDefault(),t.stopPropagation(),!1}),t.on("click",".cell:not(.clue) > .notes",function(e){return o(e.target).closest(".cell").removeClass("current"),e.preventDefault(),e.stopPropagation(),!1}),t.on("click",".cell:not(.clue) .note",function(l){var s=o(l.target),n=s.closest(".cell"),r=n[0].firstChild,i=o(r);if(n.removeClass("current"),!s.hasClass("note-disabled"))if(t.hasClass("notes")){n.hasClass("no-notes")&&n.removeClass("no-notes");var u=n.find('.sticky-note[title="'+s.attr("title")+'"]');u.hasClass("noted")?u.removeClass("noted"):u.addClass("noted"),i.removeClass(w).val(""),e.trigger("input",{input:r})}else r.value=s.attr("title"),n.addClass("no-notes"),e.toggleErrorsHighlight&&(r.value!==r.solution?i.hasClass(w)||i.addClass(w):i.removeClass(w)),e.trigger("input",{input:r});return l.preventDefault(),l.stopPropagation(),!1}),e},clearCells:function(e){var t=this;return t.$superv("clearCells",[e]),t.cells.filter(s).removeClass("no-notes"),t},revealSolution:function(){var e=this;return e.$superv("revealSolution"),e.cells.filter(s).addClass("no-notes"),e},revealCell:function(e){var t=this;return e=e||t.currentInputCell||null,e&&e.length&&(t.$superv("revealCell",[e]),e.addClass("no-notes")),t},decorateCell:function(e,t){var l=e[0],s=l.firstChild;"make-clue"===t?(l.clue=!0,l.cellType=m,s.readOnly=!0,s.value=s.solution||"",s.setAttribute("value",s.solution||""),e.hasClass("clue")||e.addClass("clue")):"unmake-clue"===t&&(l.clue=!1,l.cellType=p,s.readOnly=!1,s.value=s.solution||"",s.setAttribute("value",s.solution||""),e.removeClass("clue"))
},setAlphabet:function(e){var t=this;return t.alphabet=e&&e.length>=t.dimensions.rows?e.slice(0,t.dimensions.rows):null,t},setDichromia:function(e){var t=this,l=t.grid;return t.dichromia=e=!!e,e&&!l.hasClass("dichromia")?l.addClass("dichromia"):e||l.removeClass("dichromia"),t},getRawGrid:function(){var e,t,l=this,s=l.dimensions.rows,n=l.dimensions.columns,e=s*n;return t={alphabet:l.alphabet?l.alphabet.slice():null,difficulty:l.difficulty||1,cells:new Array(e),values:new Array(e),rows:parseInt(s,10),cols:parseInt(n,10),subrows:parseInt(l.dimensions.subRows,10),subcols:parseInt(l.dimensions.subColumns,10)},l.cells.each(function(e){var l=this;t.values[e]=l.firstChild.solution||"",t.cells[e]={index:e,row:l.row,col:l.column,squ:l.square,clue:!!l.clue}}),t},setRawGrid:function(e){if(!e)return this;var l,s,n,o,i,u,a,c,h,f=this,g=f.dimensions.rows,C=f.dimensions.columns,s=g*C,v=f.cells;if(e[x]("cells")||(e.cells=e.values,e.values=e.cells.map(t)),e[x]("subRows")&&(e.cols=e.columns,delete e.columns,e.subrows=e.subRows,delete e.subRows,e.subcols=e.subColumns,delete e.subColumns),a=e.cells,s===a.length)for(c=e.values,f.difficulty=e.difficulty||1,e[x]("alphabet")?f.alphabet=e.alphabet.join?e.alphabet.join(""):""+e.alphabet:f.alphabet||(f.alphabet=d(C,{start:1}).join("")),l=0;s>l;l++)n=a[l],h=c[n.index],"string"!=typeof h&&(h=f.alphabet.charAt(h)),u=v.eq(l),i=u[0],o=i.firstChild,o.solution=h,i.row=n.row,i.column=n.col,i.square=n.squ,i.clue=!!n.clue,i.clue?(i.cellType=m,o.readOnly=!0,o.value=h,o.setAttribute("value",h),u.addClass("clue")):(i.cellType=p,o.readOnly=!1,o.value="",u.removeClass("clue")),u.find(".sticky-note").each(function(e){this.title=f.alphabet.charAt(e)}),u.find(".note").each(function(e){this.title=f.alphabet.charAt(e)});return r(f),f},importTpl:function(e){var t=this;return e&&e[x]("dimensions")&&(t.dichromia=!!e.dichromia,t.$superv("importTpl",[e])),t},exportTpl:function(){var e=this,t=e.$superv("exportTpl");return t&&(t.dichromia=!!e.dichromia),t}})}(n),!function(e){"use strict";var t=e.Compiler=e.Class({"extends":e.Asynchronous,"implements":e.PublishSubscribe},{__static__:{STATUS:{INIT:0,RUNNING:1,NOT_FOUND:4,FOUND:16},MODE:{AUTO:0,NONE:1,LINEAR:2,EXPONENTIAL:3}},constructor:function(e){var l=this;l.$superv("constructor",[100]),l.initPubSub(),l.component=e||"Sudoku.Compiler",l.cutoff_mode=t.MODE.AUTO,l.status=t.STATUS.INIT,l.grid=null},component:null,grid:null,status:null,liveUpdate:!1,multiPass:!0,timeLimit:0,cutoff_mode:null,NUM_ALTERNATIVES:5,MIN_ALTERNATIVES:2,_NUM_ALTERNATIVES:5,dispose:function(){var e=this;return e.$superv("dispose"),e.disposePubSub(),e.component=null,e.grid=null,e.status=null,e.liveUpdate=null,e.multiPass=null,e.timeLimit=null,e.cutoff_mode=null,e},fork:function(){var t=this;return t.unfork(!0).$superv("fork",[t.component,e.Path.file]),t},stop:function(e){var t=this,l=500;return t.$thread&&(t.send("stop"),!0===e&&setTimeout(function(){t.unfork(!0)},l)),t.$queue.length&&t.empty(),t},setGrid:function(e){return e&&(this.grid=e),this},setSolution:function(){return this},clearSolution:function(){return this},compile:function(){return this}});t.RUN_MODE=e.Asynchronous.MODE}(n),!function(e,t){"use strict";var l=e.isWorker,s=Math.round,n=(Math.min,Math.ceil),r=e.shuffle,o=e.shufflex,i=e.clamp,u=e.array,a=e.range,c=Math.random,d=e.randi,h=e.randomItem,f=e.Compiler,g="unshift",p="push",m=0,C=1,v=2,y=4,b=8,S=C|v,w=y|b,x=1,T=-1,_=32,A=64,R=512,k=1024,E="undefined"!=typeof Uint8Array?Uint8Array:Array,I=new E([0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7]),O=function(e){return e.clue},D=function(e){return!e.clue},z=function(e,t){return t.clue&&e.val[t.index]===e.v&&e.matches++,e},L=function(e,t){var l=e.slice(0);return!0===t&&(l=r(l)),l},N=function(e,t,l){var s,n,r=u(t);for(n=0,s=0;t>s;s++)r[s]=e.slice(n,n+l),n+=l;return r},M=function(e){var t,l=[];for(t=0;t<e.length;t++)l=l.concat(e[t]);return l},U=function(e,t,l,s){var n,r,o,i,u=e,a=e.length;for(s=s||[],o=0;o<s.length;o++)if(i=s[o],i&y)for(r=u.slice(0),n=0;a>n;n++)0===(n+1)%l?n+1-l>=0&&(u[n]=r[n+1-l]):a>n+1&&(u[n]=r[n+1]);else if(i&b)for(r=u.slice(0),n=0;a>n;n++)0===(n+1)%l?n+1-l>=0&&(u[n+1-l]=r[n]):a>n+1&&(u[n+1]=r[n]);else i&C?u=[].concat(u.slice(l),u.slice(0,l)):i&v&&(u=[].concat(u.slice(-l),u.slice(0,-l)));return u},q=function(e,t,l,s){if(T!==s&&x!==s)return e;var n,r,o,i,a,c=e.length,d=u(c),h=T===s;for(r=0,n=0,o=0,i=0,a=0;c>a;a++)r>=l&&(r=0,n++,o+=l,i=0),d[i+n]=e[h?o+l-1-r:o+r],r++,i+=l;return d},B=function(e,t,l,s){if(!(S&s||w&s))return e;var n,r,o,i,a=e.length,c=u(a),d=!!(w&s);for(n=0,o=0,r=0,i=0;a>i;i++)r>=l&&(r=0,n++,o+=l),c[d?o+l-1-r:a-l-o+r]=e[o+r],r++;return c},H=function(e,t){var l,s=e.length,n=u(s);for(l=0;s>l;l++)n[l]=e[t[l]];return n},P=function(e,t,l,s,n,r,o){var i,u,a,c,d=e.length;if(s!==r)for(a=l*s,c=l*r,u=0;l>u;u++)i=e[a+u],e[a+u]=e[c+u],e[c+u]=i;if(n!==o)for(u=0;d>u;u+=l)i=e[u+n],e[u+n]=e[u+o],e[u+o]=i;return e},G=function(e,t){var l,s=e.length,n=u(s);for(l=0;s>l;l++)n[l]=t[e[l]];return n},j=function(e,t,l,s){var n,i,d,h,f,g,p,m,C,v,y=!!(l&k);if(l&A)n=r(a(l&S?e:t));else for(s?(i=s.length>0?s[0]:0,d=s.length>1?s[1]:e,h=s.length>2?s[2]:0,f=s.length>3?s[3]:t,s.length>4&&s[4]?(g=s[4],v=o):(g=null,v=r)):(i=0,d=e,h=0,f=t,g=null,v=r),l&S&&(C=e,e=t,t=C,C=i,i=h,h=C,C=d,d=f,f=C),n=u(e),p=0;e>p;p++)n[p]=a(t),p>=i&&d>p&&(l&_?p>i&&(n[p]=n[p-1].slice()):(m=y?e*c():p,m>=p&&p+1>m&&(n[p]=[].concat(n[p].slice(0,h),v(n[p].slice(h,f),g),n[p].slice(f)))));return n},$=function(e,t,l,s,n){var o,i,d,h,f,g,p=0,m=!!(s&k);if(s&R){if(o=e,s&A)s&w&&(p=1,o=q(o,t,l,x),g=t,t=l,l=g),o=M(H(N(o,t,l),n));else for(s&S&&(p=1,o=q(o,t,l,x),g=t,t=l,l=g),i=0,h=0;t>h;h++)d=i+l,o=[].concat(o.slice(0,i),H(o.slice(i,d),n[h]),o.slice(d)),i+=l;p&&(o=q(o,t,l,x))}else{for(o=e,s&S&&(p=1,o=q(o,t,l,x),g=t,t=l,l=g),i=0,n=u(t),h=0;t>h;h++)n[h]=a(l),f=m?t*c():h,f>=h&&h+1>f&&(n[h]=r(n[h]),d=i+l,o=[].concat(o.slice(0,i),H(o.slice(i,d),n[h]),o.slice(d))),i+=l;p&&(o=q(o,t,l,x))}return o},F=function(e,t){var l,s,n,o,i,c,f,g,p,_,E,I,O,D,z,N,M,H=e.rows,F=e.cols,W=H*F,V=e.subrows,K=e.subcols,Q=K,J=V,X=[C],Z=[y],Y=!1!==t;for(Y&&(X=[h([C,v])],Z=[h([y,b])]),e.alphabet_map=a(F),e.cells=D=u(W),e.values=z=u(W),e.squ=l=u(F),e.row=s=u(F),e.col=n=u(F),N=u(J),N[0]=L(e.alphabet_map),E=1;J>E;E++)N[E]=U(N[E-1].slice(),V,K,X),Y&&(N[E]=$(N[E],V,K,k|w));for(c=0,g=0;Q>c;c++,g+=V){for(f=0,p=0;J>f;f++,p+=K)for(_=0,o=0;V>o;o++)for(i=0;K>i;i++)I=(g+o)*F+p+i,D[I]=O={index:I,squ:g+f,row:g+o,col:p+i,squ_row:o,squ_col:i,row_index:p+i,col_index:g+o,squ_index:_,clue:!0,almost_clue:!1,alternatives:null},z[I]=N[f][_],n[O.col]||(n[O.col]=u(F)),s[O.row]||(s[O.row]=u(F)),l[O.squ]||(l[O.squ]=u(F)),n[O.col][O.col_index]=s[O.row][O.row_index]=l[O.squ][_]=O,_++;for(N[0]=U(N[0],V,K,Z),Y&&(M=j(V,K,k|A|S),N[0]=$(N[0],V,K,R|A|S,M)),E=1;J>E;E++)N[E]=U(N[E],V,K,Z),Y&&(N[E]=$(N[E],V,K,R|A|S,M))}if(Y){for(e.values=G(e.values,r(e.alphabet_map,!0)),o=0;H>o;o+=V)for(i=0;F>i;i+=K)for(c=0;V>c;c++)for(f=0;K>f;f++)P(e.values,H,F,o+c,i+f,o+d(0,c),i+d(0,f));e.values=B(e.values,H,F,h([w,m,S])),H===F&&V===K&&(e.values=q(e.values,H,F,h([T,m,x])))}return e},W=function(e,t,l){t=i(t,1,l)-1,l-=1;var n=e.cells.length,r=e.rows,o=t===l?t-1:t,u=(l-t)/l,a=.35*r,c=1-(l-o)/l,d=s(n*(.28*u+.27)),h=s(a*c*c*c+.4);return{num_clues_initial:n,num_clues_final:d,num_alternatives:h,min_alternatives:h,max_alternatives:h+2,avg_alternatives:0,num_singles:0,singles_ratio:0,no_alternatives:0}},V=function(e,l,s){var n,r,o,i,u,a,c,d,h,f,g,p,m,C,v,y,b,S,w,x=e.cells,T=e.values,_=e.row,A=e.col,R=e.squ,k=_.length,E=(x.length,l.length),O=0,D=0,z=l,L=E;s=!1!==s,S=E>0?new Array(E):[],w=0;do if(E>0&&E>w){for(m=l[w],C=m.index,b=(1<<k>>>0)-1>>>0,n=_[m.row],r=A[m.col],o=R[m.squ],c=0;k>c&&(i=n[c],u=r[c],a=o[c],!(i.clue&&i.index!==C&&b&(h=1<<T[i.index]>>>0)&&(b=(b&~h>>>0)>>>0,0===b)))&&!(u.clue&&u.index!==C&&b&(f=1<<T[u.index]>>>0)&&(b=(b&~f>>>0)>>>0,0===b))&&!(a.clue&&a.index!==C&&b&(g=1<<T[a.index]>>>0)&&(b=(b&~g>>>0)>>>0,0===b));c++);if(0===b){if(w){for(;w>0&&(p=S[w-1])&&0===p[1];)p[0].clue=!1,T[p[0].index]=p[2],S[--w]=t;w>0&&(p[0].clue=!0,b=p[1],y=4294901760&b?4278190080&b?24+I[b>>>24]:16+I[b>>>16]:65280&b?8+I[b>>>8]:I[b],p[1]=(b&~(1<<y>>>0)>>>0)>>>0,T[p[0].index]=y);continue}return O}y=4294901760&b?4278190080&b?24+I[b>>>24]:16+I[b>>>16]:65280&b?8+I[b>>>8]:I[b],S[w++]=[m,(b&~(1<<y>>>0)>>>0)>>>0,T[C]],m.clue=!0,T[C]=y}else{for(D=1,d=0;L>d;d++)for(m=z[d],C=m.index,v=T[C],n=_[m.row],r=A[m.col],o=R[m.squ],c=0;k>c;c++)if(i=n[c],u=r[c],a=o[c],i.index!==C&&T[i.index]===v||u.index!==C&&T[u.index]===v||a.index!==C&&T[a.index]===v){D=0,d=L;break}if(O+=D,s&&O>1){for(;w>0;)p=S[--w],p[0].clue=!1,T[p[0].index]=p[2],S[w]=t;return S=null,O}for(;w>0&&(p=S[w-1])&&0===p[1];)p[0].clue=!1,T[p[0].index]=p[2],S[--w]=t;w>0&&(p[0].clue=!0,b=p[1],y=4294901760&b?4278190080&b?24+I[b>>>24]:16+I[b>>>16]:65280&b?8+I[b>>>8]:I[b],p[1]=(b&~(1<<y>>>0)>>>0)>>>0,T[p[0].index]=y)}while(w>0);return S=null,O},K=function(e,t,l){var s,n,r,o,i,u,a,c,d,h,f,g,p,m,C,v,y,b,S,w,x,T,_=e.rows,A=e.row,R=e.col,k=e.squ,E=e.values,O=l.length;for(x=0,T=0,r=0;O>r;r++){for(v=l[r],y=v.index,v.almost_clue=!1,s=(1<<_>>>0)-1>>>0,n=_,a=A[v.row],c=R[v.col],d=k[v.squ],i=0;_>i&&(h=a[i],f=c[i],g=d[i],!(h.clue&&h.index!==y&&s&(p=1<<E[h.index]>>>0)&&(s=(s&~p>>>0)>>>0,n--,0===s)))&&!(f.clue&&f.index!==y&&s&(m=1<<E[f.index]>>>0)&&(s=(s&~m>>>0)>>>0,n--,0===s))&&!(g.clue&&g.index!==y&&s&(C=1<<E[g.index]>>>0)&&(s=(s&~C>>>0)>>>0,n--,0===s));i++);v.current_alternatives=s,v.current_num_alternatives=n}for(r=0;O>r;r++){if(v=l[r],v.current_num_alternatives>1)for(y=v.index,d=k[v.squ],b=d.filter(D),s=v.current_alternatives;0!==s;){for(o=4294901760&s?4278190080&s?24+I[s>>>24]:16+I[s>>>16]:65280&s?8+I[s>>>8]:I[s],s=(s&~(1<<o>>>0)>>>0)>>>0,S=b.length,w=0,i=0;i<b.length;i++)if(g=b[i],g.index!==y){if(u={matches:0,val:E,v:o},A[g.row].concat(R[g.col]).reduce(z,u),!u.matches)break;w++}else S--;if(w===S){v.current_num_alternatives=1;break}}x+=v.current_num_alternatives,1===v.current_num_alternatives&&(T+=1)}return t.avg_alternatives=O?x/O:0,t.num_singles=T,t.singles_ratio=O?T/O:0,l},Q=function(e,t,l){var s,o,i,a,c,d,f,m,C,v,y,b,S=5;for(c=W(F(e),t,S),o=e.cells,m=o.length,y=e.rows,b=e.cols,d=u(m),f=0;m>f;f++)C=o[f],d[f]=[C,o[C.row*b+b-1-C.col],o[(y-1-C.row)*b+C.col],o[(y-1-C.row)*b+b-1-C.col]];for(l=4===l?h([1,2,3]):l,i=r(o.filter(O)),a=o.filter(D),c.max_avg_alternatives=-10,s=n(.1*i.length);s-->0;)C=i.shift(),C.clue=!1,l>0&&(v=d[C.index][l],v.index!==C.index&&v.clue?(v.clue=!1,i[i.indexOf(v)]=i[i.length-1],i.pop(),s--):v=null);return a=o.filter(D),function(){var t,s,n,r,u,h,f,m,C=i.length,v=[];if(C>c.num_clues_final){for(h=c.min_alternatives,f=c.max_alternatives,n=0;C>n;n++)t=i[n],t.clue=!1,s=l>0?d[t.index][l]:null,s&&s.index!==t.index&&s.clue?s.clue=!1:s=null,r=o.filter(D),1===V(e,r,!0)&&(K(e,c,r),u=c.avg_alternatives,m=[u,n,t,s],c.max_avg_alternatives<h?u>=c.max_avg_alternatives?(c.max_avg_alternatives=u,v[g](m)):v[p](m):f>=u?(u>c.max_avg_alternatives&&(c.max_avg_alternatives=u),v.length?u>=v[0][0]?v[g](m):v[p](m):v[g](m)):v[p](m)),t.clue=!0,s&&(s.clue=!0);if(!v.length)return!0;if(n=v[0][1],t=v[0][2],s=v[0][3],t.clue=!1,i[n]=i[i.length-1],i.pop(),s&&(s.clue=!1,i[i.indexOf(s)]=i[i.length-1],i.pop()),C=i.length,a=o.filter(D),C>c.num_clues_final)return!1}return!0}};e.SudokuCompiler=e.Class(f,{constructor:function(e){var t=this;t.$superv("constructor",["Sudoku.SudokuCompiler"]),l?t.listen("generateSudoku",function(e){t.send("generateSudoku",{solution:F(e.data,!0)})}).listen("compile",function(e){t.data=e.data,t.solution=t.data,t.compileAsync()}).listen("stop",function(){t.stop()}).listen("dispose",function(){t.stop().dispose(),close()}):t.grid=e||null},solution:null,data:null,dispose:function(){var e=this;return e.solution=null,e.data=null,e.$superv("dispose"),e},compileAsync:function(e){{var t,s,n,r=this;r.dimensions}return l?n=function(){r.status=f.STATUS.FOUND,r.send("complete",{status:r.status,solution:r.solution})}:(n=function(){s=(new Date).getTime(),r.solution?(r.status=f.STATUS.FOUND,r.trigger("complete",{status:r.status,duration:s-t},5)):(r.status=f.STATUS.NOT_FOUND,r.trigger("error",null,5))},t=(new Date).getTime()),r.stop(),!0===e?setTimeout(function(){r.solution=F(r.data,!0),n()},20):r.steps(r.until(!0,Q(r.data,r.data.difficulty,r.data.symmetry)),n).interval(l?15:40).run(f.RUN_MODE.SEQUENCE),r},compileWorker:function(e){var t,l,s=this;return t=(new Date).getTime(),s.fork().listen("generateSudoku",function(e){s.status=f.STATUS.FOUND,s.solution=e.solution,s.trigger("complete",{status:s.status,duration:l-t},5),setTimeout(function(){s.unfork()},500)}).listen("complete",function(e){l=(new Date).getTime(),s.status=e.status,e.solution?(s.solution=e.solution,s.trigger("complete",{status:s.status,duration:l-t},5)):s.trigger("error",null,5),setTimeout(function(){s.unfork()},500)}),!0===e?s.send("generateSudoku",{data:s.data}):s.send("compile",{data:s.data}),s},setSolution:function(){var e=this;return e.grid&&e.solution&&e.grid.setRawGrid(e.solution),e},clearSolution:function(){return this},generateSudoku:function(e){var t=this;return t.solution=null,t.data=t.grid.getRawGrid(),!1!==e?t.compileWorker(!0):t.compileAsync(!0),t},compile:function(e,t,l){var s=this;return s.solution=null,s.data=s.grid.getRawGrid(),s.data.difficulty=t,s.data.symmetry=l,!1!==e?s.compileWorker():s.compileAsync(),s}})}(n),e.Sudoku});
