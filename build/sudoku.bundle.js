/**
*
*   Classy.js
*   @version: 0.9.3
*   @built on 2016-07-19 17:09:27
*
*   Object-Oriented micro-framework for JavaScript
*   https://github.com/foo123/classy.js
*
**/!function(e,n,i){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=i.call(e)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return i.moduleUri=n.uri,i.call(e)}):n in e||(e[n]=i.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[n]})}(this,"Classy",function(){"use strict";var e=void 0,n="constructor",i="prototype",t="__proto__",r="__static__",l="__private__",u="$super",a="$static",o="$latestatic",f="$class",c=2,s=4,b=8,d=256,m=Object,p=m[i],v=Function,g=v[i],h=String,y=Number,x=RegExp,w=Array,j=p.toString,E=(g.call.bind(g.toString),"hasOwnProperty"),_="propertyIsEnumerable",q=m.keys,I=m.defineProperty,$=function(e){return typeof e},A=function(e){throw new TypeError(e)},P=2,S=3,T=4,C=8,M=9,N=16,O=32,R=64,F=128,L=256,U=512,V=1024,k={"[object Array]":N,"[object RegExp]":F,"[object Number]":P,"[object String]":C,"[object Function]":R,"[object Object]":O},B=function(n){var i;return null===n?L:!0===n||!1===n?T:e===n?U:(i=j.call(n),i=k[i]||V,P===i||n instanceof y?isNaN(n)?S:P:C===i||n instanceof h?1===n.length?M:C:N===i||n instanceof w?N:F===i||n instanceof x?F:R===i||n instanceof v?R:O===i?O:V)},D=function(e,n){var i,t=n.length,r=[].concat(e);for(i=0;t>i;i++)-1<r.indexOf(n[i])||r.push(n[i]);return r},z=function(e,n){O!==B(e)&&A("bad desc");var i={};if(e[E]("enumerable")&&(i.enumerable=!!n.enumerable),e[E]("configurable")&&(i.configurable=!!n.configurable),e[E]("value")&&(i.value=n.value),e[E]("writable")&&(i.writable=!!e.writable),e[E]("get")){var t=e.get;R!==B(t)&&"undefined"!==t&&A("bad get"),i.get=t}if(e[E]("set")){var r=e.set;R!==B(r)&&"undefined"!==r&&A("bad set"),i.set=r}return("get"in i||"set"in i)&&("value"in i||"writable"in i)&&A("identity-confused descriptor"),i},G=m.defineProperties||function(e,n){"object"===$(e)&&null!==e||A("bad obj"),n=m(n);for(var i=q(n),t=[],r=0;r<i.length;r++)t.push([i[r],z(n[i[r]],e)]);for(var r=0;r<t.length;r++)I(e,t[r][0],t[r][1]);return e},H=function(){},J=m.create||function(e,n){var r,l=function(){};return l[i]=e,r=new l,r[t]=e,"object"===$(n)&&G(r,n),r},K=function(){var e,n,i,t,r,l,u,a=arguments;for(n=a[0]||{},e=a.length,l=1;e>l;l++)if(i=a[l],O===B(i))for(r in i)i[E](r)&&i[_](r)&&(t=i[r],u=B(t),P&u?n[r]=0+t:(C|N)&u?n[r]=t.slice(0):n[r]=t);return n},Q=function(e,i,t){var r,l,u=!!i;if(u||t)if(r={},i=u?i+"$":i,t&&R===B(t))for(l in e)e[E](l)&&(n!==l?(u&&R===B(e[l])&&(r[i+l]=e[l]),r[t(l,e[l])]=e[l]):r[l]=e[l]);else for(l in e)e[E](l)&&(n!==l?(u&&R===B(e[l])&&(r[i+l]=e[l]),t&&l in t?r[t[l]]=e[l]:r[l]=e[l]):r[l]=e[l]);else r=e;return r},W=function(e){var n=e[u]||H,i=e[u+"v"]||H,t=null;return[function(i,r,l,u,a,o,f,c,s,b,d){var m,p;return t===i?m=n.call(this,i,r,l,u,a,o,f,c,s,b,d):(p=e[i])&&(t=i,m=p.call(this,r,l,u,a,o,f,c,s,b,d),t=null),m},function(n,r){var l,u;return t===n?l=i.call(this,n,r):(u=e[n])&&(t=n,l=r&&r.length?u.apply(this,r):u.call(this),t=null),l}]},X=function(e,n){return this instanceof X?(this.factory=e,void(this.qualifier=(P===B(n)?n:0)|c)):new X(e,n)},Y=function(e,n){return this instanceof Y?(this.prop=e,void(this.qualifier=(P===B(n)?n:0)|c)):new Y(e,n)},Z=function(t,c,p,v){t=t||m,c=c||{};var g,h,y,x,w,j,_,I,$,A,S=t[a]||null,T=t[o]||{},M=t[i],F=null,L=K({},T),U=null,V={};c[E](n)||(c[n]=function(){}),g=c[n],c[E](l)&&(V=c[l]||{},delete c[l]),c[E](r)&&(F=c[r],U=q(F),delete c[r]);for($ in c)if(c[E]($)){if(A=c[$],A instanceof X){if(b&A.qualifier){d&A.qualifier?L[$]=A:((F=F||{})[$]=A.factory(t,V,g),(U=U||[]).push($)),delete c[$];continue}if(s&A.qualifier){V[$]=A,delete c[$];continue}A=c[$]=A.factory(M,V,g)}R===B(A)&&(A[u]=M[$]||H)}for($ in V)V[E]($)&&(A=V[$],A instanceof X&&(A=V[$]=A.factory(M,V,g)),R!==B(A)&&delete V[$]);if(g[i]=Q(J(M),p,v),g[i]=K(g[i],c),h=W(M),w={},w[f]=w[n]={value:g,enumerable:!1,writable:!0,configurable:!0},w[u]={value:h[0],enumerable:!1,writable:!0,configurable:!0},w[u+"v"]={value:h[1],enumerable:!1,writable:!0,configurable:!0},G(g[i],w),w={},S||U)for(S=D(S||[],U||[]),x=S.length,y=0;x>y;y++){if(j=S[y],_=null,F&&e!==F[j]){if((A=F[j])instanceof X){if((b|d)&A.qualifier){L[j]=A;continue}_=A.factory(t,V,g)}else{if(L[E](j))continue;_=F[j]}R===B(_)&&(_[u]=t[j]||H)}else e!==t[j]&&(I=B(t[j]),_=O===I?K(null,t[j]):(C|N)&I?t[j].slice(0):P&I?0+t[j]:t[j]);w[j]={value:_,enumerable:!1,writable:!0,configurable:!0}}for(j in L)L[E](j)&&(_=L[j].factory(t,V,g),w[j]={value:_,enumerable:!1,writable:!0,configurable:!0});return w[a]={value:S,enumerable:!1,writable:!0,configurable:!0},w[o]={value:L,enumerable:!1,writable:!0,configurable:!0},w[u]={value:t,enumerable:!1,writable:!0,configurable:!0},G(g,w),g},ee=K,ne=K,ie=function(n){var t,r,l,c;if(R===B(n)){if(u in n&&(n[u]=e),f in n&&(n[f]=e),o in n&&(n[o]=e),a in n){for(l=n[a],t=0,r=l.length;r>t;t++)c=l[t],c in n&&(R===B(n[c])&&n[c][u]&&(n[c][u]=e),n[c]=e);n[a]=e}l=n[i];for(c in l)R===B(l[c])&&(l[c][u]&&(l[c][u]=e),l[c]=e);l[u]=e,l[u+"v"]=e}},te=function(){var e=arguments,n=e.length,t=null;if(b===e[0])return e[1]||{};if(n>=2){var r=B(e[0]);r=R===r?{Extends:e[0]}:O===r?e[0]:{Extends:m};var l,u,a=e[1]||{},o={},f=r[E]("Extends")?r.Extends:r[E]("extends")?r["extends"]:m,c=r[E]("Implements")?r.Implements:r[E]("implements")?r["implements"]:null,s=r[E]("Mixin")?r.Mixin:r[E]("mixin")?r.mixin:null,d=null;if(c=c?[].concat(c):null,s=s?[].concat(s):null)for(l=0,u=s.length;u>l;l++)O===B(s[l])?s[l][E]("mixin")&&s[l].mixin&&s[l].mixin[i]&&(d=Q(s[l].mixin[i],s[l].namespace||null,s[l].as||null),o=ne(o,d)):s[l][i]&&(d=s[l][i],o=ne(o,d));if(c)for(l=0,u=c.length;u>l;l++)O===B(c[l])?c[l][E]("implements")&&c[l]["implements"]&&c[l]["implements"][i]&&(d=Q(c[l]["implements"][i],c[l].namespace||null,c[l].as||null),o=ee(o,d)):c[l][i]&&(d=c[l][i],o=ee(o,d));t=O===B(f)?Z(f["extends"]||m,K(o,a),f.namespace||null,f.as||null):Z(f,K(o,a))}else t=Z(m,e[0]);return t},re={VERSION:"0.9.3",PUBLIC:c,STATIC:b,LATE:d,PRIVATE:s,Type:B,Create:J,Merge:K,Alias:Q,Implements:ee,Mixin:ne,Extends:Z,Dispose:ie,Method:X,Prop:Y,Class:te};return re});
/**
*  PublishSubscribe
*  A simple publish-subscribe implementation for PHP, Python, Node/XPCOM/JS
*
*  @version: 0.4.1
*  https://github.com/foo123/PublishSubscribe
*
**/
!function(t,s,n){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[s])&&(t[s]=t.$deps[s]=n.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[s]=n.call(t)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(s,[],function(e){e(s,n.call(t))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(s)?define(s,["module"],function(s){return n.moduleUri=s.uri,n.call(t)}):s in t||(t[s]=n.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[s]})}(this,"PublishSubscribe",function(t){"use strict";function s(t){if(t)for(var s in t)t[O](s)&&(this[s]=t[s])}function n(t,n,e,i,o){var p=this;p.target=t,n?p.topic=[].concat(n):p.topic=[],e&&(p.originalTopic=[].concat(e)),i?p.tags=[].concat(i):p.tags=[],o?p.namespaces=[].concat(o):p.namespaces=[],p.data=new s,p.timestamp=D(),p._propagates=!0,p._stopped=!1,p._aborted=!1}function e(){return{notopics:{notags:{namespaces:{},list:[],oneOffs:0},tags:{}},topics:{}}}function i(t){return t.length>0}function o(t,s){var n,e,o,p;return s=String(s),n=s.indexOf(t[2]),e=s.indexOf(t[1]),n>-1?(p=s.slice(n).split(t[2]).filter(i).sort(),s=s.slice(0,n)):p=[],e>-1?(o=s.slice(e).split(t[1]).filter(i).sort(),s=s.slice(0,e)):o=[],s=s.split(t[0]).filter(i),[s,o,p]}function p(t,s){var n,e,i,p,l,a,r,c,u=[],f=[];for(s=o(t,s),n=s[2],e=s[1],s=s[0],i=s.length;i;)u.push(s.join(j)),s.pop(),i--;if(i=e.length,i>1){for(c=1<<i,p=c-1;p>=1;p--){for(r=[],l=0,a=1;i>l;l++,a=1<<l)p!==a&&p&a&&r.push(e[l]);r.length&&f.push(r.join(w))}f=f.concat(e)}else i&&f.push(e[0]);return[u.length?u[0]:"",u,f,n]}function l(t,s,n){var e,i;for(e=0;n>e;e++)i="ns_"+s[e],t[O](i)?t[i]++:t[i]=1}function a(t,s,n){var e,i;for(e=0;n>e;e++)i="ns_"+s[e],t[O](i)&&(t[i]--,t[i]<=0&&delete t[i])}function r(t,s,n){var e,i;for(e=0;n>e;e++)if(i="ns_"+s[e],!t[O](i)||0>=t[i])return!1;return!0}function c(t,s,n,e,i,o){var p=n?"tp_"+n:!1,l=e?"tg_"+e:!1;if(p&&t.topics[O](p)){if(l&&t.topics[p].tags[O](l)){if(t.topics[p].tags[l].list.length&&(0>=o||r(t.topics[p].tags[l].namespaces,i,o)))return s.push([n,e,o>0,t.topics[p].tags[l]]),!0}else if(t.topics[p].notags.list.length&&(0>=o||r(t.topics[p].notags.namespaces,i,o)))return s.push([n,null,o>0,t.topics[p].notags]),!0}else if(l&&t.notopics.tags[O](l)){if(t.notopics.tags[l].list.length&&(0>=o||r(t.notopics.tags[l].namespaces,i,o)))return s.push([null,e,o>0,t.notopics.tags[l]]),!0}else if(t.notopics.notags.list.length&&(0>=o||r(t.notopics.notags.namespaces,i,o)))return s.push([null,null,!0,t.notopics.notags]),!0;return!1}function u(t,s,n){var e,i,o,l,a,r,u=p(t,n),f=u[1],g=u[2],h=u[3],d=u[0],b=[];if(a=g.length,r=h.length,e=f.length)for(;e;){if(i=f[0],s.topics[O]("tp_"+i))if(a>0)for(l=0;a>l;l++)o=g[l],c(s,b,i,o,h,r);else c(s,b,i,null,h,r);f.shift(),e--}if(a>0)for(l=0;a>l;l++)o=g[l],c(s,b,null,o,h,r);return c(s,b,null,null,h,r),[d,b,h]}function f(t){if(t&&t[O]("list")){var s,n,e,i;if((e=t.list)&&(n=e.length))if(t.oneOffs>0)for(s=n-1;s>=0;s--)i=e[s],i[1]&&i[4]>0&&(e.splice(s,1),t.oneOffs=t.oneOffs>0?t.oneOffs-1:0);else t.oneOffs=0}return t}function g(t,s,e,i,o){if(e){var p,l,a,c,g,h,d,b,_,m,v,y,O,$,S=u(s,e,i),x=!1;for(b=S[0],v=S[2],O=v.length,S=S[1],a=S.length,$=null,a>0&&($=new n(t),$.data.data=o,$.originalTopic=b?b.split(j):[]),p=0;a>p;p++){for(_=S[p][0],m=S[p][1],$.topic=_?_.split(j):[],$.tags=m?m.split(w):[],y=S[p][2],h=S[p][3],g=[],c=h.list.length,l=0;c>l;l++)d=h.list[l],d[1]&&d[4]||!(!y||d[2]&&r(d[2],v,O))||g.push(d);for(c=g.length,l=0;c>l&&(d=g[l],y?$.namespaces=d[3].slice(0):$.namespaces=[],d[4]=1,x=d[0]($),!1!==x&&!$.stopped()&&!$.aborted());l++);if(f(h),$.aborted()||!$.propagates())break}$&&($.dispose(),$=null)}}function h(t,n,e){var i=n[0],o=n[2],n=n[1];t.non_local=new s({t:0,s:0,start_topic:!0,subscribers:null,topics:n,namespaces:o,hasNamespace:!1,abort:e}),t.originalTopic=i?i.split(j):[];var p=function(t){var s,n,e,i,o,p=t.non_local;if(p.t<p.topics.length){if(p.start_topic){if(f(p.subscribers),t.aborted()||!t.propagates())return t.aborted()&&"function"==typeof p.abort&&p.abort(t),!1;n=p.topics[p.t][0],e=p.topics[p.t][1],t.topic=n?n.split(j):[],t.tags=e?e.split(w):[],p.hasNamespace=p.topics[p.t][2],p.subscribers=p.topics[p.t][3],p.s=0,p.start_topic=!1}if(p.s<p.subscribers.list.length){if(t.aborted()||t.stopped())return f(p.subscribers),t.aborted()&&"function"==typeof p.abort&&p.abort(t),!1;for(o=!1;p.s<p.subscribers.list.length&&!o;)i=p.subscribers.list[p.s],i[1]&&i[4]||!(!p.hasNamespace||i[2]&&r(i[2],p.namespaces,p.namespaces.length))||(o=!0),p.s+=1;o&&(p.hasNamespace?t.namespaces=i[3].slice(0):t.namespaces=[],i[4]=1,s=i[0](t))}p.s>=p.subscribers.list.length&&(p.t+=1,p.start_topic=!0)}else f(p.subscribers),t&&(t.non_local.dispose(),t.non_local=null,t.dispose(),t=null)};return p}function d(t,s,e,i,o,p){if(e){var l,a=u(s,e,i),r=null;a[1].length>0&&(r=new n(t),r.data.data=o,r.pipeline(l=h(r,a,p)),l(r))}}function b(t,s,n,e,i,p){if(s&&"function"==typeof e){n=o(t,n);var a,r,c,u,f,g,h,d=n[1].join(w),b=d.length,_=n[2],m=_.length;if(n=n[0].join(j),i=!0===i,p=!0===p,f={},m)for(h=0;m>h;h++)f["ns_"+_[h]]=1;g=_.slice(0),r=null,n.length?(c="tp_"+n,s.topics[O](c)||(s.topics[c]={notags:{namespaces:{},list:[],oneOffs:0},tags:{}}),b?(u="tg_"+d,s.topics[c].tags[O](u)||(s.topics[c].tags[u]={namespaces:{},list:[],oneOffs:0}),r=s.topics[c].tags[u]):r=s.topics[c].notags):b?(u="tg_"+d,s.notopics.tags[O](u)||(s.notopics.tags[u]={namespaces:{},list:[],oneOffs:0}),r=s.notopics.tags[u]):m&&(r=s.notopics.notags),null!==r&&(a=m?[e,i,f,g,0]:[e,i,!1,[],0],p?r.list.unshift(a):r.list.push(a),i&&r.oneOffs++,m&&l(r.namespaces,_,m))}}function _(t,s,n,e,i){var o,p=t.list.length;if(s){if(null!=n&&p>0)for(;--p>=0;)n===t.list[p][0]&&(i&&t.list[p][2]&&r(t.list[p][2],e,i)?(o=T(t.list[p][2]),a(t.namespaces,o,o.length),t.list[p][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(p,1)):i||(t.list[p][2]&&(o=T(t.list[p][2]),a(t.namespaces,o,o.length)),t.list[p][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(p,1)))}else if(!s&&i>0&&p>0)for(;--p>=0;)t.list[p][2]&&r(t.list[p][2],e,i)&&(o=T(t.list[p][2]),a(t.namespaces,o,o.length),t.list[p][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(p,1));else!s&&p>0&&(t.list=[],t.oneOffs=0,t.namespaces={})}function m(t,s,n,e){if(s){n=o(t,n);var i,p,l,a,r,c,u=n[1].join(w),f=n[2],g=u.length,h=f.length;if(n=n[0].join(j),r=n.length,l=r?"tp_"+n:!1,a=g?"tg_"+u:!1,c=!(!e||"function"!=typeof e),c||(e=null),r&&s.topics[O](l))g&&s.topics[l].tags[O](a)?(_(s.topics[l].tags[a],c,e,f,h),s.topics[l].tags[a].list.length||delete s.topics[l].tags[a]):g||_(s.topics[l].notags,c,e,f,h),s.topics[l].notags.list.length||T(s.topics[l].tags).length||delete s.topics[l];else if(!r&&(g||h))if(g){s.notopics.tags[O](a)&&(_(s.notopics.tags[a],c,e,f,h),s.notopics.tags[a].list.length||delete s.notopics.tags[a]);for(i in s.topics)s.topics[O](i)&&s.topics[i].tags[O](a)&&(_(s.topics[i].tags[a],c,e,f,h),s.topics[i].tags[a].list.length||delete s.topics[i].tags[a])}else{_(s.notopics.notags,c,e,f,h);for(p in s.notopics.tags)s.notopics.tags[O](p)&&(_(s.notopics.tags[p],c,e,f,h),s.notopics.tags[p].list.length||delete s.notopics.tags[p]);for(i in s.topics)if(s.topics[O](i)){_(s.topics[i].notags,c,e,f,h);for(p in s.topics[i].tags)s.topics[i].tags[O](p)&&(_(s.topics[i].tags[p],c,e,f,h),s.topics[i].tags[p].list.length||delete s.topics[i].tags[p])}}}}var v="0.4.1",y="prototype",O="hasOwnProperty",$="/",S="#",x="@",j="/",w="#",T=Object.keys,D=Date.now?Date.now:function(){return(new Date).getTime()};s[y]={constructor:s,dispose:function(t){if(t)for(var s=0;s<t.length;s++)this[t[s]]=null;return this}},n[y]={constructor:n,target:null,topic:null,originalTopic:null,tags:null,namespaces:null,data:null,timestamp:0,is_pipelined:!1,_next:null,_propagates:!0,_stopped:!1,_aborted:!1,dispose:function(){var t=this;return t.target=null,t.topic=null,t.originalTopic=null,t.tags=null,t.namespaces=null,t.data instanceof s&&t.data.dispose(),t.data=null,t.timestamp=null,t.is_pipelined=!1,t._propagates=!0,t._stopped=!0,t._aborted=!1,t._next=null,t},next:function(){return"function"==typeof this._next&&this._next(this),this},pipeline:function(t){return arguments.length||(t=null),"function"==typeof t?(this._next=t,this.is_pipelined=!0):(this._next=null,this.is_pipelined=!1),this},propagate:function(t){return arguments.length||(t=!0),this._propagates=!!t,this},stop:function(t){return arguments.length||(t=!0),this._stopped=!!t,this},abort:function(t){return arguments.length||(t=!0),this._aborted=!!t,this},aborted:function(){return this._aborted},propagates:function(){return this._propagates},stopped:function(){return this._stopped}};var P=function(){return this instanceof P?void this.initPubSub():new P};return P.VERSION=v,P.Event=n,P.Data=function(t){return new s(t)},P[y]={constructor:P,_seps:null,_pubsub$:null,initPubSub:function(){var t=this;return t._seps=[$,S,x],t._pubsub$=e(),t},disposePubSub:function(){var t=this;return t._seps=null,t._pubsub$=null,t},setSeparators:function(t){var s,n=this;return t&&(s=t.length)&&(s>0&&t[0]&&(n._seps[0]=t[0]),s>1&&t[1]&&(n._seps[1]=t[1]),s>2&&t[2]&&(n._seps[2]=t[2])),n},trigger:function(t,s,n){var e=this;return 3>arguments.length&&(n=0),n=+n,s=s||{},n>0?setTimeout(function(){g(e,e._seps,e._pubsub$,t,s)},n):g(e,e._seps,e._pubsub$,t,s),e},pipeline:function(t,s,n,e){var i=this;return 4>arguments.length&&(e=0),e=+e,s=s||{},e>0?setTimeout(function(){d(i,i._seps,i._pubsub$,t,s,n||null)},e):d(i,i._seps,i._pubsub$,t,s,n||null),i},on:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s),n},one:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!0),n},on1:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!1,!0),n},one1:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!0,!0),n},off:function(t,s){var n=this;return m(n._seps,n._pubsub$,t,s||null),n}},P});
/**
*
*   Asynchronous.js
*   @version: 0.5.1
*
*   Simple JavaScript class to manage asynchronous, parallel, linear, sequential and interleaved tasks
*   https://github.com/foo123/asynchronous.js
*
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Asynchronous",function n(e){"use strict";function t(n){var e,t=[];if(n)for(e in n)n[c](e)&&t.push(e+"="+(!0===n[e]||1===n[e]?"yes":!1===n[e]||0===n[e]?"no":n[e]));return t.join(",")}function r(n,e){n.$runmode=M,n.$running=!1}function o(n,e){var t,r=n,o=r.$queue;if(r.$runmode=x,o){for(;o.length&&(!o[0]||!o[0].canRun());)o.shift();o.length?(r.$running=!0,t=o.shift(),e?t.runWithArgs(e):t.run(),t.complete()):r.$running=!1}}function i(n,e){var t,r=n,o=r.$queue,s=0;if(r.$runmode=R,o&&o.length){for(r.$running=!0;s<o.length;)t=o[s],t&&t.canRun()?(e?t.runWithArgs(e):t.run(),t.isFinished()?(o.shift(),t.complete()):s++):o.shift();r.$running=!1,r.$timer=N(v(i,r),r.$interval)}}function s(n,e){var t,r=n,o=r.$queue;r.$runmode=O,o&&o.length&&(t=o[0],t&&t.canRun()?(r.$running=!0,e?t.runWithArgs(e):t.run(),t.isFinished()&&(o.shift(),t.complete())):o.shift(),r.$running=!1,r.$timer=N(v(s,r),r.$interval))}var u,l="prototype",c="hasOwnProperty",a=Object,f=Array,p=Function,d=p[l],h=a[l],m=f[l],$=(JSON.parse,JSON.stringify),g=function(){},v=function(n,e){return function(){return n(e)}},w=d.call.bind(m.slice),y=h.toString,b=function(n){return"function"==typeof n},S=function(n,e){return n instanceof e},N=setTimeout,k=clearTimeout,j=e,E=0,T=1,q=2,W=60,A=0,R=1,x=2,M=3,O=4,C="undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"],L="undefined"!=typeof global&&"[object global]"===y.call(global),I=L&&"undefined"!=typeof process.send,U=!C&&!L&&"undefined"!=typeof SharedWorkerGlobalScope&&"function"==typeof importScripts,B=!C&&!L&&"undefined"!=typeof WorkerGlobalScope&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,D=!(C||L||B||U||"undefined"==typeof navigator||"undefined"==typeof document),F=(D&&!!window.opener,D&&window.self!==window.top,"function"==typeof define&&define.amd),P=L||"function"==typeof Worker||"function"==typeof SharedWorker,_=L?this:U||B?self||this:window||this,z=L?module.$deps:U||B?self||this:window||this,G=(L?global:U||B?self||this:window||this,I||U||B),J=I&&0===process.listenerCount("message")||U&&!_.onconnect||B&&!_.onmessage,V=J?function un(n){un.handler&&un.handler(I?n:n.data)}:g,K=null,Q={},X=(L?require("os").cpus().length:4,L?null:"undefined"!=typeof _.webkitURL?_.webkitURL:"undefined"!=typeof _.URL?_.URL:null),Y=function(n,e){return n&&X?X.createObjectURL(new Blob(n.push?n:[n],e||{type:"text/javascript"})):n},H=function ln(n){var e;return L?{file:__filename,path:__dirname}:U||B?{file:e=self.location.href,path:e.split("/").slice(0,-1).join("/")}:F&&n?{file:e=n,path:e.split("/").slice(0,-1).join("/")}:D&&(e=document.getElementsByTagName("script"))&&e.length?(ln.link||(ln.link=document.createElement("a")),ln.link.href=e[e.length-1].src,e=ln.link.href,{file:e,path:e.split("/").slice(0,-1).join("/")}):{path:null,file:null}},Z=H(n.moduleUri),nn=Z.file,en=function(n,e){if(n=n||{},e)for(var t in e)e[c](t)&&(n[t]=e[t]);return n},tn=0;Q[nn]=1,L?(u=function(n){var e=this;e.process=require("child_process").fork(n),e.process.on("message",function(n){e.onmessage&&e.onmessage(n)}),e.process.on("error",function(n){e.onerror&&e.onerror(n)})},u.Shared=u,u[l]={constructor:u,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.send(n),this},terminate:function(){return this.process&&(this.process.kill(),this.process=null),this}}):(u=function(n){var e=this;e.process=new Worker(n),e.process.onmessage=function(n){e.onmessage&&e.onmessage(n.data)},e.process.onerror=function(n){e.onerror&&e.onerror(n)}},u.Shared=u,u[l]={constructor:u,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.postMessage(n),this},terminate:function(){return this.process&&(this.process.terminate(),this.process=null),this}},"function"==typeof SharedWorker&&(u.Shared=function(n){var e=this;e.process=new SharedWorker(n),e.process.port.start(),e.process.port.onmessage=function(n){e.onmessage&&e.onmessage(n.data)},e.process.port.onerror=e.process.onerror=function(n){e.onerror&&e.onerror(n)}},u.Shared[l]={constructor:u.Shared,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.port.postMessage(n),this},terminate:function(){return this.process&&(this.process.port.close(),this.process=null),this}})),J&&(U?(_.close=g,_.postMessage=g,_.onconnect=function(n){var e=n.ports[0];_.close=function(){e.close()},_.postMessage=function(n){e.postMessage(n)},e.addEventListener("message",V),e.start()}):B?_.onmessage=V:I&&(_.close=function(){process.exit()},_.postMessage=function(n){process.send(n)},_.importScripts=function(n){try{new Function("",require("fs").readFileSync(n).toString()).call(z)}catch(e){throw e}},process.on("message",V)));var rn=function cn(n){var e=this;return e instanceof cn?(e.$id=(++tn).toString(16),void(e.options=en({width:400,height:400,toolbar:0,location:0,directories:0,status:0,menubar:0,scrollbars:1,resizable:1},n))):new cn(n)};rn[l]={constructor:rn,options:null,$id:null,$window:null,dispose:function(){var n=this;return n.$window&&n.close(),n.$window=null,n.$id=null,n.options=null,n},close:function(){var n=this;return n.$window&&(n.$window.closed||n.$window.close(),n.$window=null),n},ready:function(n,e){var t=this,r=function o(){!t.$window||n&&!t.$window[n]?setTimeout(o,60):e()};return setTimeout(r,0),t},open:function(n){var e=this;return!e.$window&&n&&(e.$window=window.open(n.push?Y(["\ufeff"].concat(n),{type:"text/html;charset=utf-8"}):n,e.$id,t(e.options))),e},write:function(n){var e=this;return e.$window&&n&&e.$window.document.write(n),e}};var on=function an(n){if(n instanceof an)return n;if(!(this instanceof an))return new an(n);var t,r=this,o=null,i=null,s=null,u=!1,l=!1,c=!1,a=!1,f=!1,p=!1,d=null,h=0,m=1,$=null,g=null,v=null,w=e;r.queue=function(n){return arguments.length?(o=n,r):o},r.jumpNext=function(n){o&&o.jumpNext(!1,n)},r.abort=function(n){o&&(o.abort(!1),n&&(o.dispose(),o=null))},r.dispose=function(){o&&(o.dispose(),o=null)},r.task=function(n){return i=n,r},n&&r.task(n),r.run=t=function(){return i.jumpNext=r.jumpNext,i.abort=r.abort,i.dispose=r.dispose,w=i(),u=!0,i.jumpNext=null,i.abort=null,i.dispose=null,w},r.runWithArgs=function(n){return i.jumpNext=r.jumpNext,i.abort=r.abort,i.dispose=r.dispose,w=i.apply(null,n),u=!0,i.jumpNext=null,i.abort=null,i.dispose=null,w},r.canRun=function(){return i&&(!u||l||c||a||f||p)?(l||c)&&h>=$?!1:c&&!d?!1:!a&&!f||w!==g:!1},r.iif=function(n,e,t){return n?r.task(e):arguments.length>2&&r.task(t),r},r.until=function(n){return w=e,d=null,g=n,f=!0,p=!1,l=!1,c=!1,a=!1,r.run=t,r},r.untilNot=function(n){return w=e,d=null,v=n,p=!0,f=!1,l=!1,c=!1,a=!1,r.run=t,r},r.loop=function(n,t,o){return w=e,d=null,h=t||0,m=o||1,$=n,l=!0,f=!1,p=!1,c=!1,a=!1,r.run=function(){var n;return n=i(h),h+=m,w=n,u=!0,n},r},r.each=function(n){return w=e,d=n,h=0,m=1,$=n?n.length||0:0,c=!0,f=!1,p=!1,l=!1,a=!1,r.run=function(){var n;return n=i(d[h],h),h++,w=n,u=!0,n},r},r.recurse=function(n,e){return d=null,w=n,g=e,a=!0,f=!1,p=!1,l=!1,c=!1,r.run=function(){var n;return n=i(w),w=n,u=!0,n},r},r.isFinished=function(){var n=!u||p||f||l||c||a;return n&&(f||a)&&w===g&&(n=!1),n&&p&&w!==v&&(n=!1),n&&(l||c)&&h>=$&&(n=!1),!n},r.onComplete=function(n){return s=n||null,r},r.complete=function(){return s&&b(s)&&s(),r}},sn=function fn(n,e){if(S(n,on))return n;if(b(n))return new on(n);if(!S(this,fn))return new fn(n,e);var t=this;t.$interval=arguments.length?parseInt(n,10)||W:W,t.$timer=null,t.$runmode=A,t.$running=!1,t.$queue=[],J&&!1!==e&&t.initThread()};return sn.VERSION="0.5.1",sn.Thread=u,sn.Task=on,sn.BrowserWindow=rn,sn.MODE={NONE:A,INTERLEAVE:R,LINEAR:x,PARALLEL:M,SEQUENCE:O},sn.Platform={UNDEFINED:j,UNKNOWN:E,NODE:T,BROWSER:q},sn.supportsMultiThreading=function(){return P},sn.isPlatform=function(n){return T===n?L:q===n?D:e},sn.isThread=function(n,e){return e=!0===e?J:!0,T===n?e&&I:q===n?e&&(U||B):e&&G},sn.path=H,sn.blob=Y,sn.load=function(n,e,t){if(n){var r=function(){n=n.split(".");for(var e=z;n.length;)n[0]&&n[0].length&&e[n[0]]&&(e=e[n[0]]),n.shift();return e&&_!==e?b(e)?!1!==t?new e:e():e:void 0};return e&&e.length&&sn.importScripts(e.join?e.join(","):e),r()}return null},sn.listen=J?function(n){V.handler=n}:g,sn.send=J?function(n){_.postMessage(n)}:g,sn.importScripts=J?function(n){if(n&&n.length){n.split&&(n=n.split(","));for(var e=0,t=n.length;t>e;e++){var r=n[e];r&&r.length&&1!==Q[r]&&(_.importScripts(r),Q[r]=1)}}}:g,sn.close=J?function(){_.close()}:g,sn.log="undefined"!=typeof console?function(n){console.log(n||"")}:g,sn.serialize=function(n){n=n||new sn(0,!1);var e=function(e){var t=function(){var t=this,r=arguments;n.step(function(){e.apply(t,r)}),n.$running||n.run(x)};return t.free=function(){return e},t};return e.free=function(){n&&n.dispose(),n=null},e},sn[l]={constructor:sn,$interval:W,$timer:null,$queue:null,$thread:null,$events:null,$runmode:A,$running:!1,dispose:function(n){var e=this;return e.unfork(!0),e.$timer&&k(e.$timer),e.$thread=null,e.$timer=null,e.$interval=null,e.$queue=null,e.$runmode=A,e.$running=!1,J&&!0===n&&sn.close(),e},empty:function(){var n=this;return n.$timer&&k(n.$timer),n.$timer=null,n.$queue=[],n.$runmode=A,n.$running=!1,n},interval:function(n){return arguments.length?(this.$interval=parseInt(n,10)||this.$interval,this):this.$interval},fork:function(n,e,t,r){var o,i,s,l=this;if(!l.$thread){if(!P)throw l.$thread=null,new Error("Asynchronous: Multi-Threading is NOT supported!");L?(i="Asynchronous: Thread (Process): ",s="Asynchronous: Thread (Process) Error: "):(i="Asynchronous: Thread (Worker): ",s="Asynchronous: Thread (Worker) Error: "),l.$events=l.$events||{},o=l.$thread=!0===r?new u.Shared(nn):new u(nn),o.onmessage=function(n){if(n.event){var e=n.event,t=n.data||null;l.$events&&l.$events[e]?l.$events[e](t):"console.log"!==e&&"console.error"!==e||sn.log(("console.error"===e?s:i)+(t||""))}},o.onerror=function(n){if(!l.$events||!l.$events.error)throw new Error(s+n.toString());l.$events.error(n)},l.send("initThread",{component:n||null,asInstance:!1!==t,imports:e?[].concat(e).join(","):null})}return l},unfork:function(n){var e=this;return e.$thread&&(!0===n?e.$thread.terminate():e.send("dispose")),e.$thread=null,e.$events=null,e},initThread:function(){var n=this;return J&&(n.$events={},sn.listen(function(e){var t=e.event,r=e.data||null;t&&n.$events[t]?n.$events[t](r):"dispose"===t&&(n.dispose(),sn.close())})),n},listen:function(n,e){return n&&b(e)&&this.$events&&(this.$events[n]=e),this},unlisten:function(n,e){return n&&this.$events&&this.$events[n]&&(2>arguments.length||e===this.$events[n])&&delete this.$events[n],this},send:function(n,e){return n&&(J?sn.send({event:n,data:e||null}):this.$thread&&this.$thread.postMessage({event:n,data:e||null})),this},task:function(n){return S(n,on)?n:b(n)?on(n):void 0},iif:function(){var n=arguments,e=new on;return e.iif.apply(e,n)},until:function(){var n=w(arguments),e=new on(n.pop());return e.until.apply(e,n)},untilNot:function(){var n=w(arguments),e=new on(n.pop());return e.untilNot.apply(e,n)},loop:function(){var n=w(arguments),e=new on(n.pop());return e.loop.apply(e,n)},each:function(){var n=w(arguments),e=new on(n.pop());return e.each.apply(e,n)},recurse:function(){var n=w(arguments),e=new on(n.pop());return e.recurse.apply(e,n)},step:function(n){var e=this;return n&&e.$queue.push(e.task(n).queue(e)),e},steps:function(){var n,e,t=this,r=arguments;for(e=r.length,n=0;e>n;n++)t.step(r[n]);return t},jumpNext:function(n,e){var t=this,r=t.$queue;return e=e||0,!1!==n?function(){return e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t}:(e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t)},jumpNextWithArgs:function(n,e,t){var r=this,o=r.$queue;return e=e||0,!1!==n?function(){return e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,arguments)),r}:(e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,t)),r)},abort:function(n,e){var t=this;return!1!==n?function(){return e&&e>0?N(function(){t.empty()},e):t.empty(),t}:(e&&e>0?N(function(){t.empty()},e):t.empty(),t)},run:function(n,e){var t=this;return arguments.length?t.$runmode=n:n=t.$runmode,e=e||null,O===n?s(t,e):R===n?i(t,e):x===n?o(t,e):M===n&&r(t,e),t}},J&&(sn.log=function(n){sn.send({event:"console.log",data:"string"!=typeof n?$(n):n})},sn.listen(function(n){var e=n.event,t=n.data||null;switch(e){case"initThread":t&&t.component&&(K&&(b(K.dispose)&&K.dispose(),K=null),K=sn.load(t.component,t.imports,t.asInstance));break;case"dispose":K&&(b(K.dispose)&&K.dispose(),K=null),sn.close()}})),sn});
/**
*
*   Sudoku.js
*   @version: 0.11
*   @dependencies: Classy.js, PublishSubscribe, Asynchronous.js, jQuery
*
*   Sudoku Builder in JavaScript
*   http://nikos-web-development.netai.net/
*
*   (light-weight and scaled-down version of CrossWord.js, professional Crossword Builder in JavaScript, by same author)
*
**/!function(e,l,t){"use strict";function s(e,l,t,s){return e?l.map(function(l,r){return(t?e[r]:e[l])||(s?s(l):null)}):[]}var r="Classy, PublishSubscribe, Asynchronous".split(/\s*,\s*/);"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[l]=t.apply(e,s(module.$deps,r,!1,function(e){return require("./"+e.toLowerCase())}))):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(l)?define(l,["module"].concat(r),function(l){return t.moduleUri=l.uri,t.apply(e,s(Array.prototype.slice.call(arguments,1),r,!0))}):l in e||(e[l]=t.apply(e,s(e,r)))&&"function"==typeof define&&define.amd&&define(function(){return e[l]})}(this,"Sudoku",function e(l,t,s){"use strict";var r={},n="function"==typeof jQuery?jQuery:function(){},o="function"==typeof s?s:{isThread:function(){return!1},path:function(){return{file:null,path:null}}};return!function(l,t,s,r,n,o){var i="prototype",u="hasOwnProperty",a=(Object[i],Array[i],Function[i],Math.round),c=Math.random,d=function(e,l){return a((l-e)*c()+e)},h=function(e){return new Array(e)},f=function S(e){var l,t=e.shift(),s=t?new Array(t):[];if(e.length)for(l=0;t>l;l++)s[l]=S(e.slice(0));return s},p=function w(e,l,t){var w,s;if(l=l||{},l[u]("alphabet")&&e===l.alphabet.length)w=alphabet.substr&&alphabet.split?alphabet.split(""):alphabet.slice();else if(w=new Array(e),l[u]("value")){var r=l.value,n=!!r.slice;for(s=0;e>s;s++)w[s]=n?r.slice():r}else{var o=l[u]("start")?parseInt(l.start,10):0,i=l[u]("step")?parseInt(l.step,10):1,a=0;for(s=0;e>s;s++)w[s]=a+o,a+=i}return!0===t&&(w=C(w)),w},g=function(e,l,t){var s,r=e.length,n=15&r,o=1&n,i=o?l(t,e[0]):t;for(s=o;n>s;s+=2)i=l(l(i,e[s]),e[s+1]);for(s=n;r>s;s+=16)i=l(l(l(l(l(l(l(l(l(l(l(l(l(l(l(l(i,e[s]),e[s+1]),e[s+2]),e[s+3]),e[s+4]),e[s+5]),e[s+6]),e[s+7]),e[s+8]),e[s+9]),e[s+10]),e[s+11]),e[s+12]),e[s+13]),e[s+14]),e[s+15]);return i},m=function(e,l,t){var s,r=e.length,n=15&r,o=1&n,i=[];if(arguments.length>2){for(o&&l.call(t,e[0])&&i.push(e[0]),s=o;n>s;s+=2)l.call(t,e[s])&&i.push(e[s]),l.call(t,e[s+1])&&i.push(e[s+1]);for(s=n;r>s;s+=16)l.call(t,e[s])&&i.push(e[s]),l.call(t,e[s+1])&&i.push(e[s+1]),l.call(t,e[s+2])&&i.push(e[s+2]),l.call(t,e[s+3])&&i.push(e[s+3]),l.call(t,e[s+4])&&i.push(e[s+4]),l.call(t,e[s+5])&&i.push(e[s+5]),l.call(t,e[s+6])&&i.push(e[s+6]),l.call(t,e[s+7])&&i.push(e[s+7]),l.call(t,e[s+8])&&i.push(e[s+8]),l.call(t,e[s+9])&&i.push(e[s+9]),l.call(t,e[s+10])&&i.push(e[s+10]),l.call(t,e[s+11])&&i.push(e[s+11]),l.call(t,e[s+12])&&i.push(e[s+12]),l.call(t,e[s+13])&&i.push(e[s+13]),l.call(t,e[s+14])&&i.push(e[s+14]),l.call(t,e[s+15])&&i.push(e[s+15])}else{for(o&&l(e[0])&&i.push(e[0]),s=o;n>s;s+=2)l(e[s])&&i.push(e[s]),l(e[s+1])&&i.push(e[s+1]);for(s=n;r>s;s+=16)l(e[s])&&i.push(e[s]),l(e[s+1])&&i.push(e[s+1]),l(e[s+2])&&i.push(e[s+2]),l(e[s+3])&&i.push(e[s+3]),l(e[s+4])&&i.push(e[s+4]),l(e[s+5])&&i.push(e[s+5]),l(e[s+6])&&i.push(e[s+6]),l(e[s+7])&&i.push(e[s+7]),l(e[s+8])&&i.push(e[s+8]),l(e[s+9])&&i.push(e[s+9]),l(e[s+10])&&i.push(e[s+10]),l(e[s+11])&&i.push(e[s+11]),l(e[s+12])&&i.push(e[s+12]),l(e[s+13])&&i.push(e[s+13]),l(e[s+14])&&i.push(e[s+14]),l(e[s+15])&&i.push(e[s+15])}return i},C=function(e,l){var t,s,r,n;for(n=!0===l?e.slice():e,t=n.length;t--;)s=d(0,t),r=n[t],n[t]=n[s],n[s]=r;return n},v=function(e,l,t){var s,r,n,o,i,a,c;if(c=!0===t?e.slice():e,l=l||{},l[u]("included")&&l.included.length)a=l.included;else if(l[u]("included_range")&&l.included_range.length)for(a=[],s=0,r=0;s<e.length;)r<l.included_range.length&&s>=l.included_range[r]&&(r+1>=l.included_range.length||s<=l.included_range[r+1])?a.push(s):r+=2,s++;else if(l[u]("excluded")&&l.excluded.length)for(a=[],s=0,r=0;s<e.length;)r>=l.excluded.length||s<l.excluded[r]?a.push(s):r++,s++;else if(l[u]("excluded_range")&&l.excluded_range.length)for(a=[],s=0,r=0;s<e.length;)r<l.excluded_range.length&&s>=l.excluded_range[r]?(s=r+1<l.excluded_range.length?l.excluded_range[r+1]:s,r+=2):a.push(s),s++;else a=[];for(n=a.length;n--;)o=d(0,n),i=c[a[n]],c[a[n]]=c[a[o]],c[a[o]]=i;return c},y=function(e,l,t){return l>e?l:e>t?t:e},b=0;t.Merge(l,{VERSION:"0.11",Class:t.Class,StaticClass:function(e){return t.Class(t.STATIC,e)},Asynchronous:r,PublishSubscribe:s,$:n,isWorker:r.isThread(null,!0),Path:r.path(e.moduleUri),UUID:function(e){return[e||"pzl",++b,(new Date).getTime()].join("_")},LOCALE:{},setLocale:function(e){if(e)for(var t in e)e[u](t)&&(l.LOCALE[t]=e[t])},clearLocale:function(){l.LOCALE={}},locale:function(e){return e&&l.LOCALE[u](e)?l.LOCALE[e]:e},array:h,n_array:f,range:p,operate:g,filter:m,shuffle:C,shufflex:v,clamp:y,randi:d,randf:function(e,l){return(l-e)*c()+e},randomItem:function(e){return e&&e.length?e[d(0,e.length-1)]:null}})}(r,l,t,o,n),!function(e,l){var t,s="hasOwnProperty",r=(JSON.parse,null),n=function(e,l,t,s){return"insertRule"in e.sheet?(e.sheet.insertRule(l+"{"+t+"}",s),e.sheet.cssRules[s]):"addRule"in e.sheet?(e.sheet.addRule(l,t,s),e.sheet.rules[s]):void 0},o=function(e,l){if("object"==typeof l){var t,r,o=0;for(t in l)l[s](t)&&(r=l[t],r.css=n(e,r.selector,[].concat(r.rules).join("; "),o++))}return l},i=function(e){var l,t=[],s=e.sheet,r=s.cssRules?s.cssRules:s.rules;for(l=0;l<r.length;l++)t.push(r[l].cssText?r[l].cssText:r.style.cssText);return t.join("\n")},u=function(e,l){var t=document.createElement("style");return t.setAttribute("media",e||"all"),t.setAttribute("type","text/css"),t.appendChild(document.createTextNode("")),document.head.appendChild(t),l&&o(t,l),t},a=function(e){e&&document.head.removeChild(e)};t=e.Factory=e.StaticClass({GRIDS:{},getGrid:function(e){return e=e?e.toUpperCase():null,e&&t.GRIDS[s](e)?new t.GRIDS[e]:null},getCompiler:function(l){return e.Compiler&&l&&"SUDOKU"===l.type&&e.SudokuCompiler?new e.SudokuCompiler(l):null},importTpl:function(e){var l=t.getGrid(e?e.type||null:null)||null;return l&&l.importTpl(e),l},createStyleSheet:u,disposeStyleSheet:a,addCSS:o,getCSS:i,getTransformProperty:function(e){if(!r)for(var l=e.style,t="Transform",n=["transform","O"+t,"ms"+t,"Webkit"+t,"Moz"+t],o=n.length;o--;)if(l[s](n[o])){r=n[o];break}return r},getElement:function(e){e=e||"div";var l,t,s,r,n=e.indexOf("#"),o=e.indexOf(".");return n>-1?(l=e.slice(0,n),e=e.slice(n),o-=n):o>-1?(l=e.slice(0,o),e=e.slice(o)):l=e,"#"===e.charAt(0)?o>-1?(t=e.slice(1,o),e=e.slice(o)):t=e.slice(1):t=null,s="."===e.charAt(0)?e.slice(1).split(".").join(" "):null,r=document.createElement(l.length?l:"div"),t&&(r.id=t),s&&(r.className=s),r}})}(r),!function(e,l){function t(e,l){var t,s=new Array(e);for(t=0;e>t;t++)s[t]=t;return l&&(s=y(s)),s}function s(e,l){return function(){var t=this;return!!(0<=t.row&&t.row<e&&0<=t.column&&t.column<l)}}function r(){return I===this.cellType}function n(){return E===this.cellType}function o(){return 0<this.highlightType}function i(){return this.value===this.solution}function u(){var e=this;return S(e).removeClass(P),e.value=e.solution||"",e}function a(){var e=this;return e.firstChild.value="",e}function c(){var e=this;return S(e).removeClass(P),e.value!==e.solution&&(e.value=""),e}function d(){var e=this,l=S(e);return e.value&&e.value.length&&e.solution?e.solution===e.value?l.removeClass(P):l.hasClass(P)||l.addClass(P):l.removeClass(P),e}function h(){var e=this;return S(e).removeClass(P),e}function f(){var e=this;e.highlightType<=0&&(e.highlightType=1,S(e).addClass(q))}function p(){var e=this;e.highlightType>0&&(e.highlightType=0,S(e).removeClass(q))}function g(e,l,t,s,r,n){t=!t;var i,u=e[0],a=u.row,c=u.column;if(!1===l)i=e.nextAll(".cell.default").filter(o),i.length&&i.eq(0).children("input").focus();else if(N===l){for(i=e.prevAll(".cell.default.column-"+c);t&&!i.length&&c>0;)c--,c>=0&&(e=s.filter(".row-last.column-"+c),i=I===e[0].cellType?e:e.prevAll(".cell.default.column-"+c));i.length&&i.eq(0).children("input").focus()}else if(U===l){for(i=e.nextAll(".cell.default.column-"+c);t&&!i.length&&n>c;)c++,n>c&&(e=s.filter(".row-first.column-"+c),i=I===e[0].cellType?e:e.nextAll(".cell.default.column-"+c));i.length&&i.eq(0).children("input").focus()}else if(L===l){for(i=e.prevAll(".cell.default.row-"+a);t&&!i.length&&a>0;)a--,a>=0&&(e=s.filter(".column-last.row-"+a),i=I===e[0].cellType?e:e.prevAll(".cell.default.row-"+a));i.length&&i.eq(0).children("input").focus()}else if(M===l){for(i=e.nextAll(".cell.default.row-"+a);t&&!i.length&&r>a;)a++,r>a&&(e=s.filter(".column-first.row-"+a),i=I===e[0].cellType?e:e.nextAll(".cell.default.row-"+a));i.length&&i.eq(0).children("input").focus()}return i}var m=(Math.floor,Math.round),C=(Math.ceil,Math.min),v=(Math.max,Math.abs,e.clamp),y=e.shuffle,b=e.Factory,S=e.$,w=S.extend,x=e.UUID,T=b.getTransformProperty,_=b.getCSS,A=b.createStyleSheet,R=b.disposeStyleSheet,k=b.getElement,I=1,E=2,O=4,D=8,z=16,L=37,N=38,M=39,U=40,B=1,H=2,P="notvalid",q="highlighted",G="cell-focused",$="hide-clues",j="hide-solution",F="hasOwnProperty";e.Grid=e.Class({"extends":Object,"implements":e.PublishSubscribe},{__static__:{CELL:I,SEP:E,IMAGE:O,PLACEHOLDER:D,CLUE:z,HORIZONTAL:B,VERTICAL:H,ERRORCLASS:P,HIGHLIGHTCLASS:q,FOCUSEDCLASS:G,HIDE_CLUES:$,HIDE_SOLUTION:j,DIRECTION_1:256,TOP_RIGHT_HOR:257,TOP_RIGHT_VER:258,TOP_LEFT_HOR:259,TOP_LEFT_VER:300,DIRECTION_2:512,BOTTOM_LEFT_VER:514,BOTTOM_RIGHT_HOR:513,BOTTOM_LEFT_HOR:515,CLEAR_DIRECTION_1:1256,CLEAR_DIRECTION_2:1512,CLEAR_DIRECTIONS:2048,getRange:t,isCell:r,isSeparatorCell:n,highlightedCell:o,isValidSolution:i,revealCell:u,clearCell:a,clearErrors:c,highlightCell:f,deHighlightCell:p,highlightErrors:d,deHighlightErrors:h,moveCursor:g},constructor:function(){var e=this;e.type="GRID",e.id=x(),e.selector=e.getSelector(),e.dimensions=e.getDefaultDimensions(),e.styles=e.getDefaultStyles(),e.cssStyles=e.getDefaultCssStyles(e.selector,e.styles,e.dimensions),e.style=A("all",e.cssStyles),e.grid=null,e.cells=null,e.cellInputs=null,e.userMode=!1,e.initPubSub()},type:null,id:null,selector:null,grid:null,cells:null,style:null,styles:null,cssStyles:null,dimensions:null,alphabet:null,clues:null,cellInputs:null,currentInputCell:null,toggleErrorsHighlight:!1,toggleHorizontalHighlight:!0,userMode:!1,highlightMode:!1,dispose:function(){var e=this;return e.type=null,e.id=null,e.selector=null,e.dimensions=null,e.alphabet=null,e.clues=null,e.currentInputCell=null,e.toggleErrorsHighlight=null,e.toggleHorizontalHighlight=null,e.cellInputs=null,e.cells=null,e.styles=null,e.cssStyles=null,R(e.style),e.style=null,e.grid&&(e.setSelectable(!1,!0).setResizable(!1,!0),e.grid.off(),e.grid.children().remove(),e.grid.remove()),e.grid=null,e.disposePubSub(),e},getCell:function(e,l){var t=arguments.length<2?e||0:(e||0)*this.dimensions.columns+(l||0);return this.cells.eq(t)},getRow:function(e,l,t){var s=this.dimensions.columns,r=(e||0)*s;return l=l||0,t=t?t+1:s,this.cells.slice(r+l,r+t)},getColumn:function(e,l,t){var s,r,n,o=this,i=o.cells,u=o.dimensions.rows,a=o.dimensions.columns,c=S([]);for(e=e||0,l=l||0,t=t||u-1,n=l*a,s=l,r=n;t>=s;s++,r+=a)c=c.add(i.eq(r+e));return c},getCells:function(e,l,t,s){var r,n,o,i,u=this,a=u.cells,c=u.dimensions.columns,d=u.dimensions.rows;if(!arguments.length)return a.slice(0);for(arguments.length<2?(l=0,t=d-1,s=c-1):arguments.length<3?(t=d-1,s=c-1):arguments.length<4&&(s=c-1),e>t&&(o=e,e=t,t=o),l>s&&(o=l,l=s,s=o),e=v(e,0,d-1),t=v(t,0,d-1),l=v(l,0,c-1),s=v(s,0,c-1),s+=1,r=S([]),i=e*c,n=e,o=i;t>=n;n++,o+=c)r=r.add(a.slice(o+l,o+s));return r},getRange:function(e){var l,t=1/0,s=-(1/0),r=1/0,n=-(1/0);return e&&e.length?(e.each(function(){var e=this,l=e.row,o=e.column;t>=l&&(t=l),l>=s&&(s=l),r>=o&&(r=o),o>=n&&(n=o)}),l=[{row:t,column:r},{row:s,column:n}]):l=[{row:0,column:0},{row:0,column:0}],l},getCellInputs:function(){var e=this;return e.cellInputs||(e.cellInputs=e.cells.filter(r).children("input")),e.cellInputs},setSelectable:function(e,l){var t,s,r=this,n=r.grid;return S.fn.selectable&&n&&(t=!!n.data("ui-selectable"),s=t?!n.selectable("option","disabled"):!1,e?t?t&&!s&&n.selectable("option","disabled",!1):n.selectable({filter:".cell",autoRefresh:!1}):l&&t?(n.children(".ui-selected").removeClass("ui-selected"),n.selectable("destroy")):s&&!l&&(n.children(".ui-selected").removeClass("ui-selected"),n.selectable("option","disabled",!0).removeClass("ui-state-disabled").attr("aria-disabled","false"))),r},setResizable:function(e,l){var t,s,r,n,o=this,i=o.grid;return S.fn.resizable&&i&&(s=!!i.data("ui-resizable"),t=s?!i.resizable("option","disabled"):!1,e?s?s&&!t&&i.resizable("option","disabled",!1):(r=function(){o.setSelectable(!1)},n=function(){o.setSelectable(!0)},i.on("mousedown.resizablehandle",">.ui-resizable-handle:not(.ui-resizable-image-handle)",r).on("mouseup.resizablehandle",">.ui-resizable-handle:not(.ui-resizable-image-handle)",n).resizable({animate:!1,aspectRatio:!0,autoHide:!0,handles:"all",minHeight:100,minWidth:100,delay:50,ghost:!0,distance:2,helper:"resizable-helper",grid:!1,start:function(e,l){r(),i.addClass("resizing")},stop:function(e,l){var t=o.dimensions,s=(t.cellSize,m(l.size.width/t.columns));t.cellSize=s,i.removeClass("resizing"),n(),o.updateDimensions()}})):l&&s?i.resizable("destroy").off("mousedown.resizablehandle mouseup.resizablehandle resizestart resizestop"):t&&!l&&i.resizable("option","disabled",!0).removeClass("ui-state-disabled").attr("aria-disabled","false")),o},setHighlightMode:function(e){return this.highlightMode=!!e,this},handleInput:function(e,l,t){var s,r=this,n=r.alphabet,o=l.value.toUpperCase(),i=S(l),u=r.dimensions.rows,a=r.dimensions.columns;r.toggleHorizontalHighlight?M:U;return o.length&&0>n.indexOf(o)&&(o=""),r.toggleErrorsHighlight&&(l.solution&&o.length&&o!==l.solution?i.hasClass(P)||i.addClass(P):i.removeClass(P)),l.value=o,s=o.length&&-1<n.indexOf(o)?g(i.parent(".cell"),!1,!0,r.cells,u,a):i.parent(".cell"),o!==t&&r.trigger("input",{input:l}),s},handleKeyNav:function(e,l){var t=this,s=t.dimensions;return g(l,e.which,!1,t.cells,s.rows,s.columns)},showClues:function(e){var l=this,t=l.grid;return e=arguments.length?!!e:!0,e&&t.hasClass($)?t.removeClass($):e||t.hasClass($)||t.addClass($),l},showSolution:function(e){var l=this,t=l.grid;return e=arguments.length?!!e:!0,e&&t.hasClass(j)?t.removeClass(j):e||t.hasClass(j)||t.addClass(j),l},enableUserMode:function(e){var l=this,t=l.grid;return e&&!l.userMode?(t.addClass("user-mode"),l.setResizable(!1),l.userMode=!0,l.trigger("userMode",{userMode:!0})):!e&&l.userMode&&(t.removeClass("user-mode"),l.setResizable(!0),l.userMode=!1,l.trigger("userMode",{userMode:!1})),l},scale:function(e){var l=this,t=l.grid[0],s=T(t);return arguments.length?(e=parseFloat(e,10),t.style[s+"Origin"]="center center",t.style[s]="scale("+e+","+e+")"):(t.style[s+"Origin"]="center center",t.style[s]="none"),l},build:function(e){var l=this;return l.buildGrid(e).onBuildComplete().trigger("build",null,50).trigger("percentage",{percentage:l.getPercentage()},100),l},importTpl:function(e){var l=this;return e&&e[F]("dimensions")&&(l.setStyles(e.styles).buildGrid(e.dimensions),e[F]("alphabet")&&e.alphabet&&e.alphabet.length&&l.setAlphabet(e.alphabet),l.onBuildComplete().trigger("build",null,50).trigger("import",null,100)),l},exportTpl:function(){var e=this,l=(e.grid,e.cells,{type:e.type,alphabet:e.alphabet||null,dimensions:w({},e.dimensions),styles:w({},e.styles)});return l},revealSolution:function(){return this.getCellInputs().each(u),this},revealCells:function(e){return e&&e.length&&e.children("input").each(u),this},revealCell:function(e){return e=e||this.currentInputCell||null,e&&e.length&&I===e[0].cellType&&u.call(e[0].firstChild),this},checkIsSolved:function(){var e=this.getCellInputs();return e.filter(i).length===e.length},getSolvedPercent:function(){var e=this.getCellInputs();return e.filter(i).length/(e.length||1)},highlightErrors:function(e){var l=this;return l.toggleErrorsHighlight=!!e,l.getCellInputs().each(l.toggleErrorsHighlight?d:h),l},clearErrors:function(){return this.getCellInputs().each(c),this},getCssStyles:function(e){return e=e?'<link rel="stylesheet" media="all" href="'+e+'" />':"",e+'<style type="text/css" media="all">'+_(this.style)+"</style>"},setStyles:function(e){var l=this,t=l.getDefaultStyles();return l.styles=w({},l.styles||t,e),l.styles[F]("symbolColor")||(l.styles.symbolColor=t.symbolColor),l.styles[F]("clueColor")||(l.styles.clueColor=t.clueColor),l},setDimensions:function(e){var l=this;return l.dimensions=w({},l.dimensions||l.getDefaultDimensions(),e),l},updateStyles:function(e){var l=this,t=l.cssStyles,s=l.styles;return t.grid.css.style.borderColor=s.outerBorderColor,t.grid.css.style.borderWidth=s.outerBorderThickness+"px",t.cell.css.style.backgroundColor=s.cellColor,t.cell.css.style.borderColor=s.borderColor,t.cell.css.style.borderStyle=s.borderStyle,t.cell.css.style.color=s.symbolColor,t.highlighted.css.style.backgroundColor=s.highlightColor,!1!==e&&l.trigger("update-styles"),l},updateDimensions:function(e){var l,t,r,n,o,i,u,a=this,c=a.dimensions,d=(a.styles,a.cssStyles),h=c.cellSize,f=m(.6*h),p=c.rows,g=c.columns,v=a.grid,y=v[0],b=a.cells;s(p,g);if(y.className=y.className.replace(/\bnumRows-(\d+)\b/,function(e,l){return r=parseInt(l,10),"numRows-"+p}).replace(/\bnumColumns-(\d+)\b/,function(e,l){return n=parseInt(l,10),"numColumns-"+g}).replace(/\bsizeCell-\d+\b/,"sizeCell-"+h),y.style.width="",y.style.height="",y.style.left="",y.style.top="",d.grid.css.style.width=h*g+"px",d.grid.css.style.height=h*p+"px",d.cell.css.style.width=h+"px",d.cell.css.style.height=h+"px",d.cell.css.style.fontSize=f+"px",b.each(function(){var e=this,l=S(e),t=e.column,s=e.row;s>=p||t>=g?l.remove():(l.removeClass("row-first row-last column-first column-last"),0===s&&l.addClass("row-first"),p-1===s&&l.addClass("row-last"),0===t&&l.addClass("column-first"),g-1===t&&l.addClass("column-last"),e.style.top=s*h+"px",e.style.left=t*h+"px")}),g>n)for(u=C(p,r),l=0;u>l;l++)for(o=v.children(".cell.row-"+l).eq(-1),t=n;g>t;t++)i=a.buildCell(l,t,h,"cell default row-"+l+" column-"+t+(0==l?" row-first":p-1==l?" row-last":"")+(0==t?" column-first":g-1==t?" column-last":"")),o=S(i).insertAfter(o);if(p>r)for(l=r;p>l;l++)for(t=0;g>t;t++)i=a.buildCell(l,t,h,"cell default row-"+l+" column-"+t+(0==l?" row-first":p-1==l?" row-last":"")+(0==t?" column-first":g-1==t?" column-last":"")),v.append(i);return a.cells=v.children(".cell"),v.hasClass("ui-selectable")&&v.selectable("refresh"),!1!==e&&(a.trigger("update-dimensions"),a.trigger("percentage",{percentage:a.getPercentage()},100)),a},setAlphabet:function(e){return e&&e.length&&(this.alphabet=e.join?e.join(""):e.slice()),this},getHighlighted:function(){return this.cells.filter(o)},clearHighlighted:function(){return this.cells.filter(o).each(a),this},clearCells:function(e){var l=this;return!0===e?l.getCellInputs().val(""):l.cells.children("input").val(""),l},decorateCell:function(){return cell},highlightClue:function(){return this},addClue:function(){return this},addClues:function(){return this},clearClues:function(){return this},clearGrid:function(e){return this.clearCells(e).clearClues(),this},buildGrid:function(l){var t,s,r,n,o,i,u,a,c,d=this;for(l=l||{},d.dimensions||(d.dimensions=d.getDefaultDimensions()),d.styles||(d.styles=d.getDefaultStyles()),d.userMode=!1,d.alphabet=d.alphabet||e.ALPHABET,l.rows&&(d.dimensions.rows=l.rows),l.columns&&(d.dimensions.columns=l.columns),l.cellSize&&(d.dimensions.cellSize=l.cellSize),u=d.dimensions.rows,a=d.dimensions.columns,c=d.dimensions.cellSize,o=d.styles,i=d.cssStyles,i.grid.css.style.width=c*a+"px",i.grid.css.style.height=c*u+"px",i.grid.css.style.borderColor=o.outerBorderColor,i.grid.css.style.borderWidth=o.outerBorderThickness+"px",i.cell.css.style.backgroundColor=o.cellColor,i.cell.css.style.borderColor=o.borderColor,i.cell.css.style.borderStyle=o.borderStyle,i.cell.css.style.width=c+"px",i.cell.css.style.height=c+"px",i.cell.css.style.fontSize=m(.6*c)+"px",i.cell.css.style.color=o.symbolColor,i.highlighted.css.style.backgroundColor=o.highlightColor,r=k("div#"+d.id+"."+d.getGridClasses().join(".")),r.setAttribute("id",d.id),t=0;u>t;t++)for(s=0;a>s;s++)n=d.buildCell(t,s,c,["cell default","row-"+t+(0==t?" row-first":u-1==t?" row-last":""),"column-"+s+(0==s?" column-first":a-1==s?" column-last":"")].join(" ")),r.appendChild(n);return d.grid=S(r),d.cells=d.grid.children(".cell"),d},buildCell:function(e,l,t,s){var r=k("div"),n=k("input");return r.cellType=I,r.highlightType=0,r.row=e,r.column=l,r.style.top=e*t+"px",r.style.left=l*t+"px",n.solution=null,n.highlightType=0,n.setAttribute("type","text"),n.setAttribute("value",""),n.setAttribute("maxlength","1"),r.appendChild(n),s&&(r.className=""+s),r},onBuildComplete:function(){return this},getSelector:function(){return"#"+this.id+".crossword"},getGridClasses:function(){var e=this.dimensions;return["crossword","numRows-"+e.rows,"numColumns-"+e.columns,"sizeCell-"+e.cellSize]},getDefaultDimensions:function(){return{rows:10,columns:10,cellSize:76}},getDefaultStyles:function(){return{cellColor:"#ffffff",sepColor:"#f2e941",placeholderColor:"#ffffff",highlightColor:"#dddddd",borderColor:"#7f7f7f",borderStyle:"solid",outerBorderThickness:1,outerBorderColor:"#aaaaaa",symbolColor:"#000000",clueColor:"#000000"}},getDefaultCssStyles:function(e,l,t){return{grid:{selector:e,rules:["width: "+t.columns*t.cellSize+"px","height: "+t.rows*t.cellSize+"px","border-color: "+l.outerBorderColor,"border-width: "+l.outerBorderThickness]},cell:{selector:e+" > .cell",rules:["width: "+t.cellSize+"px","height: "+t.cellSize+"px","font-size: "+m(.6*t.cellSize)+"px","background-color: "+l.cellColor,"border-color: "+l.borderColor,"border-style: "+l.borderStyle,"color: "+l.symbolColor]},highlighted:{selector:e+" > .cell."+q,rules:["background-color: "+l.highlightColor]}}},getSeparatorClasses:function(e){return""},getPercentage:function(){return 0},toDefaultCells:function(){return this},toPlaceholderCells:function(){return this},toSeparatorCells:function(){return this},setSolution:function(e){return this},setClues:function(){return this},checkCluesMissing:function(){return!1},toString:function(){return"[Sudoku.Puzzle type="+this.type+"]"}})}(r),!function(e,l){function t(e,l,t){return e.index=l,e.val}function s(){return this.clue}function r(){return!this.clue}function n(e,l,t){var s,r,n,o=l.slice(0),i=t.length;if(!i)return o;for(s=0;i>s;s++)r=t[s],(e.column===r.column||e.row===r.row||e.square===r.square)&&-1<(n=o.indexOf(r.firstChild.value))&&(o[n]="");return o}function o(e){var l=e.cells.filter(s),t=e.cells.filter(r),o=e.alphabet.split("");t.each(function(){var e=this,t=i(e),s=n(e,o,l);t.find(".sticky-note").each(function(e){s[e]?i(this).removeClass("note-disabled"):i(this).addClass("note-disabled")}),t.find(".note").each(function(e){s[e]?i(this).removeClass("note-disabled"):i(this).addClass("note-disabled")})})}var i=e.$,u=(i.extend,Math.round),a=Math.min,c=Math.max,d=e.locale,h=e.range,f=e.Grid,p=(f.moveCursor,e.Factory),g=p.getElement,m=f.CELL,C=f.CLUE,v=27,y=37,b=38,S=39,w=40,x=f.ERRORCLASS,T=(f.HIGHLIGHTCLASS,f.FOCUSEDCLASS,"hasOwnProperty");e.Sudoku=e.Factory.GRIDS.SUDOKU=e.Class(f,{constructor:function(){var e=this;e.$super("constructor"),e.type="SUDOKU",e.difficulty=1,e.dichromia=!1},difficulty:1,dichromia:!1,dispose:function(){var e=this;return e.difficulty=null,e.dichromia=null,e.$super("dispose"),e},getSelector:function(){return"#"+this.id+".crossword.sudoku"},getGridClasses:function(){var e=this.$super("getGridClasses");return e.push("sudoku"),e},getDefaultDimensions:function(){return{rows:9,columns:9,subRows:3,subColumns:3,cellSize:70}},getDefaultStyles:function(){return{cellColor:"#ffffff",sepColor:"#f2e941",placeholderColor:"#ffffff",highlightColor:"#dddddd",borderColor:"#7f7f7f",borderStyle:"dashed",outerBorderThickness:2,outerBorderColor:"#121212",symbolColor:"#608b03",clueColor:"#000000"}},getDefaultCssStyles:function(e,l,t){var s=this.$super("getDefaultCssStyles",e,l,t);return s[T]("separator")&&delete s.separator,s[T]("placeholder")&&delete s.placeholder,s.stickyNotes={selector:e+" > .cell .sticky-notes a.sticky-note:before",rules:["color: "+l.symbolColor]},s.highlighted={selector:[e+" > .cell:not(.clue):hover",e+" > .cell:not(.clue):focus"].join(","),rules:["background-color: "+l.highlightColor]},s.cellClue={selector:e+" > .cell.clue",rules:["color: "+l.clueColor]},s.cellSubRowLast={selector:e+" > .cell.subrow-last:not(.row-last)",rules:["border-bottom-color: "+l.outerBorderColor,"border-bottom-width: "+l.outerBorderThickness+"px","border-bottom-style: solid"]},s.cellSubColLast={selector:e+" > .cell.subcolumn-last:not(.column-last)",rules:["border-right-color: "+l.outerBorderColor,"border-right-width: "+l.outerBorderThickness+"px","border-right-style: solid"]},s},updateStyles:function(e){var l=this,t=l.cssStyles,s=l.styles;return l.$super("updateStyles",!1),t.cellClue.css.style.color=s.clueColor,t.stickyNotes.css.style.color=s.symbolColor,t.cellSubRowLast.css.style.borderBottomColor=s.outerBorderColor,t.cellSubRowLast.css.style.borderBottomWidth=s.outerBorderThickness+"px",t.cellSubColLast.css.style.borderRightColor=s.outerBorderColor,t.cellSubColLast.css.style.borderRightWidth=s.outerBorderThickness+"px",!1!==e&&l.trigger("update-styles"),l},updateDimensions:function(e){var l=this;return l.$super("updateDimensions",!1),!1!==e&&l.trigger("update-dimensions"),l},enableNotes:function(e){var l=this,t=l.grid;return l.userMode&&(e?t.hasClass("notes")||(l.enableAllNotes(!1),t.addClass("notes")):t.removeClass("notes")),l},enableAllNotes:function(e){var l=this,t=l.grid;return l.userMode&&(e?t.hasClass("all-notes")||(l.enableNotes(!1),t.addClass("all-notes")):t.removeClass("all-notes")),l},clearNotes:function(){return this.cells.removeClass("with-notes").find(".sticky-note.noted").removeClass("noted"),this},handleInput:function(e,l,t){var s=this,r=s.alphabet,n=l.value.toUpperCase(),o=i(l);s.dimensions.rows,s.dimensions.columns;n.length&&0>r.indexOf(n)&&(n=""),s.toggleErrorsHighlight&&(l.solution&&n.length&&n!==l.solution?o.hasClass(x)||o.addClass(x):o.removeClass(x)),l.value=n,n!==t&&s.trigger("input",{input:l})},buildGrid:function(e){var l,t,s,r,n,o,a,c,d,h,f,p,m,C,v,y,b=this;for(e=e||{},b.dimensions||(b.dimensions=b.getDefaultDimensions()),b.styles||(b.styles=b.getDefaultStyles()),b.userMode=!1,e.rows&&(b.dimensions.rows=e.rows),e.columns&&(b.dimensions.columns=e.columns),e.subRows&&(b.dimensions.subRows=e.subRows),e.subColumns&&(b.dimensions.subColumns=e.subColumns),e.cellSize&&(b.dimensions.cellSize=e.cellSize),a=b.dimensions.rows,c=b.dimensions.columns,h=b.dimensions.subRows,f=b.dimensions.subColumns,d=b.dimensions.cellSize,n=b.styles,o=b.cssStyles,o.grid.css.style.width=d*c+"px",o.grid.css.style.height=d*a+"px",o.grid.css.style.borderColor=n.outerBorderColor,o.grid.css.style.borderWidth=n.outerBorderThickness+"px",o.cell.css.style.backgroundColor=n.cellColor,o.cell.css.style.borderColor=n.borderColor,o.cell.css.style.borderStyle=n.borderStyle,o.cell.css.style.width=d+"px",o.cell.css.style.height=d+"px",o.cell.css.style.fontSize=u(.6*d)+"px",o.cell.css.style.color=n.symbolColor,o.cellClue.css.style.color=n.clueColor,o.stickyNotes.css.style.color=n.symbolColor,o.highlighted.css.style.backgroundColor=n.highlightColor,o.cellSubRowLast.css.style.borderBottomColor=n.outerBorderColor,o.cellSubRowLast.css.style.borderBottomWidth=n.outerBorderThickness+"px",o.cellSubColLast.css.style.borderRightColor=n.outerBorderColor,o.cellSubColLast.css.style.borderRightWidth=n.outerBorderThickness+"px",s=g("div#"+b.id+"."+b.getGridClasses().join(".")),s.setAttribute("id",b.id),v=0,y=h,l=0;a>l;l++){for(p=l%h,C=0,t=0;c>t;t++)m=t%f,r=b.buildCell(h,f,l,t,v+C,d,["cell default","row-"+l+(0==l?" row-first":a-1==l?" row-last":"")+(0==p?" subrow-first":h-1==p?" subrow-last":""),"column-"+t+(0==t?" column-first":c-1==t?" column-last":"")+(0==m?" subcolumn-first":f-1==m?" subcolumn-last":""),"square-"+(v+C)].join(" ")),s.appendChild(r),f-1==m&&C++;h-1==p&&(v+=y)}return b.grid=i(s),b.cells=b.grid.children(".cell"),b.setDichromia(b.dichromia),b.setResizable(!0,!0),b},buildCell:function(e,l,t,s,r,n,o){var i,d,h,f,p,m,v,y=g("div"),b=g("input"),S=g("div.notes"),w=g("div.sticky-notes"),x=c(l,e),T=a(l,e),_=u(100/x),A=u(2*_);for(h=0,i=0;T>i;i++){for(f=g("div.note-row"),p=g("div.note-row"),d=0;x>d;d++)m=g("a.note"),v=g("a.sticky-note"),m.href="#",m.title=" ",m.style.fontSize=A+"%",m.style.paddingBottom=m.style.width=_+"%",v.href="#",v.title=" ",v.style.fontSize=A+"%",v.style.paddingBottom=v.style.width=_+"%",f.appendChild(m),p.appendChild(v);S.appendChild(f),w.appendChild(p)}return y.cellType=C,y.highlightType=0,y.row=t,y.column=s,y.square=r,y.clue=!0,y.style.top=t*n+"px",y.style.left=s*n+"px",b.solution=null,b.highlightType=0,b.readOnly=!1,b.setAttribute("type","text"),b.setAttribute("value",""),b.setAttribute("maxlength","1"),y.appendChild(b),y.appendChild(w),y.appendChild(S),o&&(y.className=""+o),y},onBuildComplete:function(){var e=this,l=e.grid;return i.fn.contextMenu&&l.contextMenu({selector:".cell",items:{"make-clue":{name:d("MAKE_CLUE"),icon:"add-definition"},"unmake-clue":{name:d("UNMAKE_CLUE"),icon:"clear"}},callback:function(l,t){e.decorateCell(i(this),l)}}),l.on("keydown click focus",".cell:not(.clue) > input",function(l){var t,s,r,n=l.target,o=i(n).closest(".cell"),u=e.cells;if(m===o[0].cellType)if(s=e.currentInputCell,e.currentInputCell=o,"keydown"===l.type){if(t=l.which,v===t)return setTimeout(function(){u.removeClass("current")},100),l.preventDefault(),l.stopPropagation(),!1;if(b===t||w===t||y===t||S===t)return u.removeClass("current"),setTimeout(function(){e.handleKeyNav(l,o)},100),l.preventDefault(),l.stopPropagation(),!1;u.removeClass("current"),r=n.value,setTimeout(function(){e.handleInput(l,n,r),n.value.length?o.addClass("no-notes"):o.removeClass("no-notes")},100)}else s&&s.removeClass("current")}),l.on("click",".cell:not(.clue)",function(l){var t,s=i(l.target);return m===s[0].cellType&&(t=e.currentInputCell,e.currentInputCell=s,t&&t.removeClass("current"),s.addClass("current")),l.preventDefault(),l.stopPropagation(),!1}),l.on("click",".cell:not(.clue) > .notes",function(e){return i(e.target).closest(".cell").removeClass("current"),e.preventDefault(),e.stopPropagation(),!1}),l.on("click",".cell:not(.clue) .note",function(t){var s=i(t.target),r=s.closest(".cell"),n=r[0].firstChild,o=i(n);if(r.removeClass("current"),!s.hasClass("note-disabled"))if(l.hasClass("notes")){r.hasClass("no-notes")&&r.removeClass("no-notes");var u=r.find('.sticky-note[title="'+s.attr("title")+'"]');u.hasClass("noted")?u.removeClass("noted"):u.addClass("noted"),o.removeClass(x).val(""),e.trigger("input",{input:n})}else n.value=s.attr("title"),r.addClass("no-notes"),e.toggleErrorsHighlight&&(n.value!==n.solution?o.hasClass(x)||o.addClass(x):o.removeClass(x)),e.trigger("input",{input:n});return t.preventDefault(),t.stopPropagation(),!1}),e},clearCells:function(e){var l=this;return l.$super("clearCells",e),l.cells.filter(r).removeClass("no-notes"),l},revealSolution:function(){var e=this;return e.$super("revealSolution"),e.cells.filter(r).addClass("no-notes"),e},revealCell:function(e){var l=this;return e=e||l.currentInputCell||null,e&&e.length&&(l.$super("revealCell",e),e.addClass("no-notes")),l},decorateCell:function(e,l){var t=e[0],s=t.firstChild;"make-clue"===l?(t.clue=!0,t.cellType=C,s.readOnly=!0,s.value=s.solution||"",s.setAttribute("value",s.solution||""),e.hasClass("clue")||e.addClass("clue")):"unmake-clue"===l&&(t.clue=!1,t.cellType=m,s.readOnly=!1,s.value=s.solution||"",s.setAttribute("value",s.solution||""),e.removeClass("clue"))},setAlphabet:function(e){var l=this;return e&&e.length>=l.dimensions.rows?l.alphabet=e.slice(0,l.dimensions.rows):l.alphabet=null,l},setDichromia:function(e){var l=this,t=l.grid;return l.dichromia=e=!!e,e&&!t.hasClass("dichromia")?t.addClass("dichromia"):e||t.removeClass("dichromia"),l},getRawGrid:function(){var e,l,t=this,s=t.dimensions.rows,r=t.dimensions.columns,e=s*r;return l={alphabet:t.alphabet?t.alphabet.slice():null,difficulty:t.difficulty||1,cells:new Array(e),values:new Array(e),rows:parseInt(s,10),cols:parseInt(r,10),
subrows:parseInt(t.dimensions.subRows,10),subcols:parseInt(t.dimensions.subColumns,10)},t.cells.each(function(e){var t=this;l.values[e]=t.firstChild.solution||"",l.cells[e]={index:e,row:t.row,col:t.column,squ:t.square,clue:!!t.clue}}),l},setRawGrid:function(e){if(!e)return this;var l,s,r,n,i,u,a,c,d,f=this,p=f.dimensions.rows,g=f.dimensions.columns,s=p*g,v=f.cells;if(e[T]("cells")||(e.cells=e.values,e.values=e.cells.map(t)),e[T]("subRows")&&(e.cols=e.columns,delete e.columns,e.subrows=e.subRows,delete e.subRows,e.subcols=e.subColumns,delete e.subColumns),a=e.cells,s===a.length)for(c=e.values,f.difficulty=e.difficulty||1,e[T]("alphabet")?f.alphabet=e.alphabet.join?e.alphabet.join(""):""+e.alphabet:f.alphabet||(f.alphabet=h(g,{start:1}).join("")),l=0;s>l;l++)r=a[l],d=c[r.index],"string"!=typeof d&&(d=f.alphabet.charAt(d)),u=v.eq(l),i=u[0],n=i.firstChild,n.solution=d,i.row=r.row,i.column=r.col,i.square=r.squ,i.clue=!!r.clue,i.clue?(i.cellType=C,n.readOnly=!0,n.value=d,n.setAttribute("value",d),u.addClass("clue")):(i.cellType=m,n.readOnly=!1,n.value="",u.removeClass("clue")),u.find(".sticky-note").each(function(e){this.title=f.alphabet.charAt(e)}),u.find(".note").each(function(e){this.title=f.alphabet.charAt(e)});return o(f),f},importTpl:function(e){var l=this;return e&&e[T]("dimensions")&&(l.dichromia=!!e.dichromia,l.$super("importTpl",e)),l},exportTpl:function(){var e=this,l=e.$super("exportTpl");return l&&(l.dichromia=!!e.dichromia),l}})}(r),!function(e,l){var t=e.Compiler=e.Class({"extends":e.Asynchronous,"implements":e.PublishSubscribe},{__static__:{STATUS:{INIT:0,RUNNING:1,NOT_FOUND:4,FOUND:16},MODE:{AUTO:0,NONE:1,LINEAR:2,EXPONENTIAL:3}},constructor:function(e){var l=this;l.$super("constructor",100),l.initPubSub(),l.component=e||"Sudoku.Compiler",l.cutoff_mode=t.MODE.AUTO,l.status=t.STATUS.INIT,l.grid=null},component:null,grid:null,status:null,liveUpdate:!1,multiPass:!0,timeLimit:0,cutoff_mode:null,NUM_ALTERNATIVES:5,MIN_ALTERNATIVES:2,_NUM_ALTERNATIVES:5,dispose:function(){var e=this;return e.$super("dispose"),e.disposePubSub(),e.component=null,e.grid=null,e.status=null,e.liveUpdate=null,e.multiPass=null,e.timeLimit=null,e.cutoff_mode=null,e},fork:function(){var l=this;return l.unfork(!0).$super("fork",l.component,e.Path.file),l},stop:function(e){var l=this,t=500;return l.$thread&&(l.send("stop"),!0===e&&setTimeout(function(){l.unfork(!0)},t)),l.$queue.length&&l.empty(),l},setGrid:function(e){return e&&(this.grid=e),this},setSolution:function(){return this},clearSolution:function(){return this},compile:function(){return this}});t.RUN_MODE=e.Asynchronous.MODE}(r),!function(e,l){var t=e.isWorker,s=Math.round,r=(Math.min,Math.ceil),n=e.shuffle,o=e.shufflex,i=e.filter,u=e.operate,a=e.clamp,c=e.array,d=e.range,h=Math.random,f=e.randi,p=e.randomItem,g=e.Compiler,m="unshift",C="push",v=0,y=1,b=2,S=4,w=8,x=y|b,T=S|w,_=1,A=-1,R=32,k=64,I=512,E=1024,O="undefined"!=typeof Uint8Array?Uint8Array:Array,D=new O([0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7]),z=function(e){return e.clue},L=function(e){return!e.clue},N=function(e,l){return l.clue&&e.val[l.index]===e.v&&e.matches++,e},M=function(e,l){var t=e.slice(0);return!0===l&&(t=n(t)),t},U=function(e,l,t){var s,r,n=c(l);for(r=0,s=0;l>s;s++)n[s]=e.slice(r,r+t),r+=t;return n},B=function(e){var l,t=[];for(l=0;l<e.length;l++)t=t.concat(e[l]);return t},H=function(e,l,t,s){var r,n,o,i,u=e,a=e.length;for(s=s||[],o=0;o<s.length;o++)if(i=s[o],i&S)for(n=u.slice(0),r=0;a>r;r++)0===(r+1)%t?r+1-t>=0&&(u[r]=n[r+1-t]):a>r+1&&(u[r]=n[r+1]);else if(i&w)for(n=u.slice(0),r=0;a>r;r++)0===(r+1)%t?r+1-t>=0&&(u[r+1-t]=n[r]):a>r+1&&(u[r+1]=n[r]);else i&y?u=[].concat(u.slice(t),u.slice(0,t)):i&b&&(u=[].concat(u.slice(-t),u.slice(0,-t)));return u},P=function(e,l,t,s){if(A!==s&&_!==s)return e;var r,n,o,i,u,a=e.length,d=c(a),h=A===s;for(n=0,r=0,o=0,i=0,u=0;a>u;u++)n>=t&&(n=0,r++,o+=t,i=0),d[i+r]=e[h?o+t-1-n:o+n],n++,i+=t;return d},q=function(e,l,t,s){if(!(x&s||T&s))return e;var r,n,o,i,u=e.length,a=c(u),d=!!(T&s);for(r=0,o=0,n=0,i=0;u>i;i++)n>=t&&(n=0,r++,o+=t),a[d?o+t-1-n:u-t-o+n]=e[o+n],n++;return a},G=function(e,l){var t,s=e.length,r=c(s);for(t=0;s>t;t++)r[t]=e[l[t]];return r},$=function(e,l,t,s,r,n,o){var i,u,a,c,d=e.length;if(s!==n)for(a=t*s,c=t*n,u=0;t>u;u++)i=e[a+u],e[a+u]=e[c+u],e[c+u]=i;if(r!==o)for(u=0;d>u;u+=t)i=e[u+r],e[u+r]=e[u+o],e[u+o]=i;return e},j=function(e,l){var t,s=e.length,r=c(s);for(t=0;s>t;t++)r[t]=l[e[t]];return r},F=function(e,l,t,s){var r,i,u,a,f,p,g,m,C,v,y=!!(t&E);if(t&k)r=n(d(t&x?e:l));else for(s?(i=s.length>0?s[0]:0,u=s.length>1?s[1]:e,a=s.length>2?s[2]:0,f=s.length>3?s[3]:l,s.length>4&&s[4]?(p=s[4],v=o):(p=null,v=n)):(i=0,u=e,a=0,f=l,p=null,v=n),t&x&&(C=e,e=l,l=C,C=i,i=a,a=C,C=u,u=f,f=C),r=c(e),g=0;e>g;g++)r[g]=d(l),g>=i&&u>g&&(t&R?g>i&&(r[g]=r[g-1].slice()):(m=y?e*h():g,m>=g&&g+1>m&&(r[g]=[].concat(r[g].slice(0,a),v(r[g].slice(a,f),p),r[g].slice(f)))));return r},W=function(e,l,t,s,r){var o,i,u,a,f,p,g=0,m=!!(s&E);if(s&I){if(o=e,s&k)s&T&&(g=1,o=P(o,l,t,_),p=l,l=t,t=p),o=B(G(U(o,l,t),r));else for(s&x&&(g=1,o=P(o,l,t,_),p=l,l=t,t=p),i=0,a=0;l>a;a++)u=i+t,o=[].concat(o.slice(0,i),G(o.slice(i,u),r[a]),o.slice(u)),i+=t;g&&(o=P(o,l,t,_))}else{for(o=e,s&x&&(g=1,o=P(o,l,t,_),p=l,l=t,t=p),i=0,r=c(l),a=0;l>a;a++)r[a]=d(t),f=m?l*h():a,f>=a&&a+1>f&&(r[a]=n(r[a]),u=i+t,o=[].concat(o.slice(0,i),G(o.slice(i,u),r[a]),o.slice(u))),i+=t;g&&(o=P(o,l,t,_))}return o},V=function(e,l){var t,s,r,o,i,u,a,h,g,m,C,R,O,D,z,L,N,U=e.rows,B=e.cols,G=U*B,V=e.subrows,K=e.subcols,Q=K,J=V,X=[y],Z=[S],Y=!1!==l;for(Y&&(X=[p([y,b])],Z=[p([S,w])]),e.alphabet_map=d(B),e.cells=D=c(G),e.values=z=c(G),e.squ=t=c(B),e.row=s=c(B),e.col=r=c(B),L=c(J),L[0]=M(e.alphabet_map),C=1;J>C;C++)L[C]=H(L[C-1].slice(),V,K,X),Y&&(L[C]=W(L[C],V,K,E|T));for(u=0,h=0;Q>u;u++,h+=V){for(a=0,g=0;J>a;a++,g+=K)for(m=0,o=0;V>o;o++)for(i=0;K>i;i++)R=(h+o)*B+g+i,D[R]=O={index:R,squ:h+a,row:h+o,col:g+i,squ_row:o,squ_col:i,row_index:g+i,col_index:h+o,squ_index:m,clue:!0,almost_clue:!1,alternatives:null},z[R]=L[a][m],r[O.col]||(r[O.col]=c(B)),s[O.row]||(s[O.row]=c(B)),t[O.squ]||(t[O.squ]=c(B)),r[O.col][O.col_index]=s[O.row][O.row_index]=t[O.squ][m]=O,m++;for(L[0]=H(L[0],V,K,Z),Y&&(N=F(V,K,E|k|x),L[0]=W(L[0],V,K,I|k|x,N)),C=1;J>C;C++)L[C]=H(L[C],V,K,Z),Y&&(L[C]=W(L[C],V,K,I|k|x,N))}if(Y){for(e.values=j(e.values,n(e.alphabet_map,!0)),o=0;U>o;o+=V)for(i=0;B>i;i+=K)for(u=0;V>u;u++)for(a=0;K>a;a++)$(e.values,U,B,o+u,i+a,o+f(0,u),i+f(0,a));e.values=q(e.values,U,B,p([T,v,x])),U===B&&V===K&&(e.values=P(e.values,U,B,p([A,v,_])))}return e},K=function(e,l,t){l=a(l,1,t)-1,t-=1;var r=e.cells.length,n=e.rows,o=l===t?l-1:l,i=(t-l)/t,u=.35*n,c=1-(t-o)/t,d=s(r*(.28*i+.27)),h=s(u*c*c*c+.4);return{num_clues_initial:r,num_clues_final:d,num_alternatives:h,min_alternatives:h,max_alternatives:h+2,avg_alternatives:0,num_singles:0,singles_ratio:0,no_alternatives:0}},Q=function(e,t,s){var r,n,o,i,u,a,c,d,h,f,p,g,m,C,v,y,b,S,w,x=e.cells,T=e.values,_=e.row,A=e.col,R=e.squ,k=_.length,I=(x.length,t.length),E=0,O=0,z=t,L=I;s=!1!==s,S=I>0?new Array(I):[],w=0;do if(I>0&&I>w){for(m=t[w],C=m.index,b=(1<<k>>>0)-1>>>0,r=_[m.row],n=A[m.col],o=R[m.squ],c=0;k>c&&(i=r[c],u=n[c],a=o[c],!(i.clue&&i.index!==C&&b&(h=1<<T[i.index]>>>0)&&(b=(b&~h>>>0)>>>0,0===b)))&&!(u.clue&&u.index!==C&&b&(f=1<<T[u.index]>>>0)&&(b=(b&~f>>>0)>>>0,0===b))&&!(a.clue&&a.index!==C&&b&(p=1<<T[a.index]>>>0)&&(b=(b&~p>>>0)>>>0,0===b));c++);if(0===b){if(w){for(;w>0&&(g=S[w-1])&&0===g[1];)g[0].clue=!1,T[g[0].index]=g[2],S[--w]=l;w>0&&(g[0].clue=!0,b=g[1],y=4294901760&b?4278190080&b?24+D[b>>>24]:16+D[b>>>16]:65280&b?8+D[b>>>8]:D[b],g[1]=(b&~(1<<y>>>0)>>>0)>>>0,T[g[0].index]=y);continue}return E}y=4294901760&b?4278190080&b?24+D[b>>>24]:16+D[b>>>16]:65280&b?8+D[b>>>8]:D[b],S[w++]=[m,(b&~(1<<y>>>0)>>>0)>>>0,T[C]],m.clue=!0,T[C]=y}else{for(O=1,d=0;L>d;d++)for(m=z[d],C=m.index,v=T[C],r=_[m.row],n=A[m.col],o=R[m.squ],c=0;k>c;c++)if(i=r[c],u=n[c],a=o[c],i.index!==C&&T[i.index]===v||u.index!==C&&T[u.index]===v||a.index!==C&&T[a.index]===v){O=0,d=L;break}if(E+=O,s&&E>1){for(;w>0;)g=S[--w],g[0].clue=!1,T[g[0].index]=g[2],S[w]=l;return S=null,E}for(;w>0&&(g=S[w-1])&&0===g[1];)g[0].clue=!1,T[g[0].index]=g[2],S[--w]=l;w>0&&(g[0].clue=!0,b=g[1],y=4294901760&b?4278190080&b?24+D[b>>>24]:16+D[b>>>16]:65280&b?8+D[b>>>8]:D[b],g[1]=(b&~(1<<y>>>0)>>>0)>>>0,T[g[0].index]=y)}while(w>0);return S=null,E},J=function(e,l,t){var s,r,n,o,a,c,d,h,f,p,g,m,C,v,y,b,S,w,x,T,_,A,R=e.rows,k=e.row,I=e.col,E=e.squ,O=e.values,z=t.length;for(_=0,A=0,n=0;z>n;n++){for(b=t[n],S=b.index,b.almost_clue=!1,s=(1<<R>>>0)-1>>>0,r=R,d=k[b.row],h=I[b.col],f=E[b.squ],a=0;R>a&&(p=d[a],g=h[a],m=f[a],!(p.clue&&p.index!==S&&s&(C=1<<O[p.index]>>>0)&&(s=(s&~C>>>0)>>>0,r--,0===s)))&&!(g.clue&&g.index!==S&&s&(v=1<<O[g.index]>>>0)&&(s=(s&~v>>>0)>>>0,r--,0===s))&&!(m.clue&&m.index!==S&&s&(y=1<<O[m.index]>>>0)&&(s=(s&~y>>>0)>>>0,r--,0===s));a++);b.current_alternatives=s,b.current_num_alternatives=r}for(n=0;z>n;n++){if(b=t[n],b.current_num_alternatives>1)for(S=b.index,f=E[b.squ],w=i(f,L),s=b.current_alternatives;0!==s;){for(o=4294901760&s?4278190080&s?24+D[s>>>24]:16+D[s>>>16]:65280&s?8+D[s>>>8]:D[s],s=(s&~(1<<o>>>0)>>>0)>>>0,x=w.length,T=0,a=0;a<w.length;a++)if(m=w[a],m.index!==S){if(c={matches:0,val:O,v:o},u(k[m.row].concat(I[m.col]),N,c),!c.matches)break;T++}else x--;if(T===x){b.current_num_alternatives=1;break}}_+=b.current_num_alternatives,1===b.current_num_alternatives&&(A+=1)}return l.avg_alternatives=z?_/z:0,l.num_singles=A,l.singles_ratio=z?A/z:0,t},X=function(e,l,t){var s,o,u,a,d,h,f,g,v,y,b,S,w=5;for(d=K(V(e),l,w),o=e.cells,g=o.length,b=e.rows,S=e.cols,h=c(g),f=0;g>f;f++)v=o[f],h[f]=[v,o[v.row*S+S-1-v.col],o[(b-1-v.row)*S+v.col],o[(b-1-v.row)*S+S-1-v.col]];for(t=4===t?p([1,2,3]):t,u=n(i(o,z)),a=i(o,L),d.max_avg_alternatives=-10,s=r(.1*u.length);s-- >0;)v=u.shift(),v.clue=!1,t>0&&(y=h[v.index][t],y.index!==v.index&&y.clue?(y.clue=!1,u[u.indexOf(y)]=u[u.length-1],u.pop(),s--):y=null);return a=i(o,L),function(){var l,s,r,n,c,f,p,g,v=u.length,y=[];if(v>d.num_clues_final){for(f=d.min_alternatives,p=d.max_alternatives,r=0;v>r;r++)l=u[r],l.clue=!1,s=t>0?h[l.index][t]:null,s&&s.index!==l.index&&s.clue?s.clue=!1:s=null,n=i(o,L),1===Q(e,n,!0)&&(J(e,d,n),c=d.avg_alternatives,g=[c,r,l,s],d.max_avg_alternatives<f?c>=d.max_avg_alternatives?(d.max_avg_alternatives=c,y[m](g)):y[C](g):p>=c?(c>d.max_avg_alternatives&&(d.max_avg_alternatives=c),y.length?c>=y[0][0]?y[m](g):y[C](g):y[m](g)):y[C](g)),l.clue=!0,s&&(s.clue=!0);if(!y.length)return!0;if(r=y[0][1],l=y[0][2],s=y[0][3],l.clue=!1,u[r]=u[u.length-1],u.pop(),s&&(s.clue=!1,u[u.indexOf(s)]=u[u.length-1],u.pop()),v=u.length,a=i(o,L),v>d.num_clues_final)return!1}return!0}};e.SudokuCompiler=e.Class(g,{constructor:function(l){var s=this;s.$super("constructor","Sudoku.SudokuCompiler"),t?s.listen("generateSudoku",function(e){s.send("generateSudoku",{solution:V(e.data,!0)})}).listen("compile",function(e){s.data=e.data,s.solution=s.data,s.compileAsync()}).listen("stop",function(e){s.stop()}).listen("dispose",function(l){s.stop().dispose(),e.Asynchronous.close()}):s.grid=l||null},solution:null,data:null,dispose:function(){var e=this;return e.solution=null,e.data=null,e.$super("dispose"),e},compileAsync:function(e){var l,s,r,n=this;n.dimensions;return t?r=function(){n.status=g.STATUS.FOUND,n.send("complete",{status:n.status,solution:n.solution})}:(r=function(){s=(new Date).getTime(),n.solution?(n.status=g.STATUS.FOUND,n.trigger("complete",{status:n.status,duration:s-l},5)):(n.status=g.STATUS.NOT_FOUND,n.trigger("error",null,5))},l=(new Date).getTime()),n.stop(),!0===e?setTimeout(function(){n.solution=V(n.data,!0),r()},20):n.steps(n.until(!0,X(n.data,n.data.difficulty,n.data.symmetry)),r).interval(t?15:40).run(g.RUN_MODE.SEQUENCE),n},compileWorker:function(e){var l,t,s=this;return l=(new Date).getTime(),s.fork().listen("generateSudoku",function(e){s.status=g.STATUS.FOUND,s.solution=e.solution,s.trigger("complete",{status:s.status,duration:t-l},5),setTimeout(function(){s.unfork()},500)}).listen("complete",function(e){t=(new Date).getTime(),s.status=e.status,e.solution?(s.solution=e.solution,s.trigger("complete",{status:s.status,duration:t-l},5)):s.trigger("error",null,5),setTimeout(function(){s.unfork()},500)}),!0===e?s.send("generateSudoku",{data:s.data}):s.send("compile",{data:s.data}),s},setSolution:function(){var e=this;return e.grid&&e.solution&&e.grid.setRawGrid(e.solution),e},clearSolution:function(){return this},generateSudoku:function(e){var l=this;return l.solution=null,l.data=l.grid.getRawGrid(),!1!==e?l.compileWorker(!0):l.compileAsync(!0),l},compile:function(e,l,t){var s=this;return s.solution=null,s.data=s.grid.getRawGrid(),s.data.difficulty=l,s.data.symmetry=t,!1!==e?s.compileWorker():s.compileAsync(),s}})}(r),r});
