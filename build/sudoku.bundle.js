/**
*
*   Classy.js
*   @version: 1.0.0
*   @built on 2019-03-19 14:46:38
*
*   Object-Oriented micro-framework for JavaScript
*   https://github.com/foo123/classy.js
*
**/!function(e,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(e)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(e)}):n in e||(e[n]=t.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[n]})}("undefined"!=typeof self?self:this,"Classy",function(){"use strict";var e="prototype",n="$super",t=Object,i=t[e],r=Function,l=r[e],u=String,o=Number,a=RegExp,c=Array,f=i.toString,s=(l.call.bind(l.toString),function(e,n){return!!e&&i.hasOwnProperty.call(e,n)}),d=function(e,n){return!!e&&i.propertyIsEnumerable.call(e,n)},p=t.keys,b=t.defineProperty,m=function(e){return typeof e},v=function(e){throw new TypeError(e)},g={"[object Array]":16,"[object RegExp]":128,"[object Number]":2,"[object String]":8,"[object Function]":64,"[object Object]":32},h=function(e){var n;return null===e?256:!0===e||!1===e?4:void 0===e?512:(n=f.call(e),2===(n=g[n]||1024)||e instanceof o?isNaN(e)?3:2:8===n||e instanceof u?1===e.length?9:8:16===n||e instanceof c?16:128===n||e instanceof a?128:64===n||e instanceof r?64:32===n?32:1024)},_=function(e,n){var t,i=n.length,r=[].concat(e);for(t=0;t<i;t++)-1<r.indexOf(n[t])||r.push(n[t]);return r},y=function(e,n){32!==h(e)&&v("bad desc");var t={};if(s(e,"enumerable")&&(t.enumerable=!!n.enumerable),s(e,"configurable")&&(t.configurable=!!n.configurable),s(e,"value")&&(t.value=n.value),s(e,"writable")&&(t.writable=!!e.writable),s(e,"get")){var i=e.get;64!==h(i)&&"undefined"!==i&&v("bad get"),t.get=i}if(s(e,"set")){var r=e.set;64!==h(r)&&"undefined"!==r&&v("bad set"),t.set=r}return("get"in t||"set"in t)&&("value"in t||"writable"in t)&&v("identity-confused descriptor"),t},x=t.defineProperties||function(e,n){"object"===m(e)&&null!==e||v("bad obj"),n=t(n);for(var i=p(n),r=[],l=0;l<i.length;l++)r.push([i[l],y(n[i[l]],e)]);for(l=0;l<r.length;l++)b(e,r[l][0],r[l][1]);return e},$=function(){},w=t.create||function(n,t){var i,r=function(){};return r[e]=n,i=new r,i.__proto__=n,"object"===m(t)&&x(i,t),i},j=function(){var e,n,t,i,r,l,u,o=arguments;for(n=o[0]||{},e=o.length,l=1;l<e;l++)if(t=o[l],32===h(t))for(r in t)s(t,r)&&d(t,r)&&(i=t[r],u=h(i),n[r]=2&u?0+i:24&u?i.slice(0):i);return n},E=function(e,n,t){var i,r,l=!!n;if(l||t)if(i={},n=l?n+"$":n,t&&64===h(t))for(r in e)s(e,r)&&("constructor"!==r?(l&&64===h(e[r])&&(i[n+r]=e[r]),i[t(r,e[r])]=e[r]):i[r]=e[r]);else for(r in e)s(e,r)&&("constructor"!==r?(l&&64===h(e[r])&&(i[n+r]=e[r]),t&&r in t?i[t[r]]=e[r]:i[r]=e[r]):i[r]=e[r]);else i=e;return i},q=function(e){var t=e[n]||$,i=e.$superv||$,r=null;return[function(n,i,l,u,o,a,c,f,s,d,p){var b,m;return r===n?b=t.call(this,n,i,l,u,o,a,c,f,s,d,p):(m=e[n])&&(r=n,b=m.call(this,i,l,u,o,a,c,f,s,d,p),r=null),b},function(n,t){var l,u;return r===n?l=i.call(this,n,t):(u=e[n])&&(r=n,l=t&&t.length?u.apply(this,t):u.call(this),r=null),l}]},I=function(e,n){if(!(this instanceof I))return new I(e,n);this.factory=e,this.qualifier=2|(2===h(n)?n:0)},A=function(e,n){if(!(this instanceof A))return new A(e,n);this.prop=e,this.qualifier=2|(2===h(n)?n:0)},P=function(i,r,l,u){i=i||t,r=r||{};var o,a,c,f,d,b,m,v,g,y,A=i.$static||null,P=i.$latestatic||{},S=i[e],T=null,C=j({},P),M=null,N={};s(r,"constructor")||(r.constructor=function(){}),o=r.constructor,s(r,"__private__")&&(N=r.__private__||{},delete r.__private__),s(r,"__static__")&&(T=r.__static__,M=p(T),delete r.__static__);for(g in r)if(s(r,g)){if((y=r[g])instanceof I){if(8&y.qualifier){256&y.qualifier?C[g]=y:((T=T||{})[g]=y.factory(i,N,o),(M=M||[]).push(g)),delete r[g];continue}if(4&y.qualifier){N[g]=y,delete r[g];continue}y=r[g]=y.factory(S,N,o)}64===h(y)&&(y[n]=S[g]||$)}for(g in N)s(N,g)&&((y=N[g])instanceof I&&(y=N[g]=y.factory(S,N,o)),64!==h(y)&&delete N[g]);if(o[e]=E(w(S),l,u),o[e]=j(o[e],r),a=q(S),d={},d.$class=d.constructor={value:o,enumerable:!1,writable:!0,configurable:!0},d[n]={value:a[0],enumerable:!1,writable:!0,configurable:!0},d.$superv={value:a[1],enumerable:!1,writable:!0,configurable:!0},x(o[e],d),d={},A||M)for(f=(A=_(A||[],M||[])).length,c=0;c<f;c++){if(b=A[c],m=null,T&&void 0!==T[b]){if((y=T[b])instanceof I){if(264&y.qualifier){C[b]=y;continue}m=y.factory(i,N,o)}else{if(s(C,b))continue;m=T[b]}64===h(m)&&(m[n]=i[b]||$)}else void 0!==i[b]&&(m=32===(v=h(i[b]))?j(null,i[b]):24&v?i[b].slice(0):2&v?0+i[b]:i[b]);d[b]={value:m,enumerable:!1,writable:!0,configurable:!0}}for(b in C)s(C,b)&&(m=C[b].factory(i,N,o),d[b]={value:m,enumerable:!1,writable:!0,configurable:!0});return d.$static={value:A,enumerable:!1,writable:!0,configurable:!0},d.$latestatic={value:C,enumerable:!1,writable:!0,configurable:!0},d[n]={value:i,enumerable:!1,writable:!0,configurable:!0},x(o,d),o},S=j,T=j;return{VERSION:"1.0.0",PUBLIC:2,STATIC:8,LATE:256,PRIVATE:4,Type:h,Create:w,Merge:j,Alias:E,Implements:S,Mixin:T,Extends:P,Dispose:function(t){var i,r,l,u;if(64===h(t)){if(n in t&&(t[n]=void 0),"$class"in t&&(t.$class=void 0),"$latestatic"in t&&(t.$latestatic=void 0),"$static"in t){for(i=0,r=(l=t.$static).length;i<r;i++)(u=l[i])in t&&(64===h(t[u])&&t[u][n]&&(t[u][n]=void 0),t[u]=void 0);t.$static=void 0}l=t[e];for(u in l)64===h(l[u])&&(l[u][n]&&(l[u][n]=void 0),l[u]=void 0);l[n]=void 0,l.$superv=void 0}},Method:I,Prop:A,Class:function(){var n=arguments,i=n.length,r=null;if(8===n[0])return n[1]||{};if(2<=i){var l=h(n[0]);l=64===l?{Extends:n[0]}:32===l?n[0]:{Extends:t};var u,o,a=n[1]||{},c={},f=s(l,"Extends")?l.Extends:s(l,"extends")?l.extends:t,d=s(l,"Implements")?l.Implements:s(l,"implements")?l.implements:null,p=s(l,"Mixin")?l.Mixin:s(l,"mixin")?l.mixin:null,b=null;if(d=d?[].concat(d):null,p=p?[].concat(p):null)for(u=0,o=p.length;u<o;u++)32===h(p[u])?s(p[u],"mixin")&&p[u].mixin&&p[u].mixin[e]&&(b=E(p[u].mixin[e],p[u].namespace||null,p[u].as||null),c=T(c,b)):p[u][e]&&(b=p[u][e],c=T(c,b));if(d)for(u=0,o=d.length;u<o;u++)32===h(d[u])?s(d[u],"implements")&&d[u].implements&&d[u].implements[e]&&(b=E(d[u].implements[e],d[u].namespace||null,d[u].as||null),c=S(c,b)):d[u][e]&&(b=d[u][e],c=S(c,b));r=32===h(f)?P(f.extends||t,j(c,a),f.namespace||null,f.as||null):P(f,j(c,a))}else r=P(t,n[0]);return r}}});
/**
*  PublishSubscribe
*  A simple publish-subscribe implementation for PHP, Python, Node/XPCOM/JS
*
*  @version: 1.1.0
*  https://github.com/foo123/PublishSubscribe
*
**/
!function(t,s,n){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(t.$deps=t.$deps||{})&&(t.EXPORTED_SYMBOLS=[s])&&(t[s]=t.$deps[s]=n.call(t)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[s]=n.call(t)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System.import?System.register(s,[],function(e){e(s,n.call(t))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(s)?define(s,["module"],function(s){return n.moduleUri=s.uri,n.call(t)}):s in t||(t[s]=n.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[s]})}("undefined"!=typeof self?self:this,"PublishSubscribe",function(t){"use strict";function s(t){if(t)for(var s in t)y.call(t,s)&&(this[s]=t[s])}function n(t,s,n,e,i){var o=this;o.target=t,o.topic=s?[].concat(s):[],n&&(o.originalTopic=[].concat(n)),o.tags=e?[].concat(e):[],o.namespaces=i?[].concat(i):[],o.data=null,o.timestamp=S(),o._propagates=!0,o._stopped=!1,o._aborted=!1}function e(t){return t.length>0}function i(t,s){var n,i,o,l;return s=String(s),n=s.indexOf(t[2]),i=s.indexOf(t[1]),-1<n?(l=s.slice(n).split(t[2]).filter(e).sort(),s=s.slice(0,n)):l=[],-1<i?(o=s.slice(i).split(t[1]).filter(e).sort(),s=s.slice(0,i)):o=[],s=s.split(t[0]).filter(e),[s,o,l]}function o(t,s){var n,e,o,l,p,a,c,r=[],u=[];for(n=(s=i(t,s))[2],e=s[1],o=(s=s[0]).length;o;)r.push(s.join(v)),s.pop(),o--;if((o=e.length)>1){for(l=(1<<o)-1;l>=1;l--){for(c=[],p=0,a=1;p<o;p++,a=1<<p)l!==a&&l&a&&c.push(e[p]);c.length&&u.push(c.join(O))}u=u.concat(e)}else o&&u.push(e[0]);return[r.length?r[0]:"",r,u,n]}function l(t,s,n){var e,i;for(e=0;e<n;e++)i="ns_"+s[e],y.call(t,i)?t[i]++:t[i]=1}function p(t,s,n){var e,i;for(e=0;e<n;e++)i="ns_"+s[e],y.call(t,i)&&(t[i]--,t[i]<=0&&delete t[i])}function a(t,s,n){var e,i;for(e=0;e<n;e++)if(i="ns_"+s[e],!y.call(t,i)||0>=t[i])return!1;return!0}function c(t,s,n,e,i,o){var l=!!n&&"tp_"+n,p=!!e&&"tg_"+e;if(l&&y.call(t.topics,l)){if(p&&y.call(t.topics[l].tags,p)){if(t.topics[l].tags[p].list.length&&(o<=0||a(t.topics[l].tags[p].namespaces,i,o)))return s.push([n,e,o>0,t.topics[l].tags[p]]),!0}else if(t.topics[l].notags.list.length&&(o<=0||a(t.topics[l].notags.namespaces,i,o)))return s.push([n,null,o>0,t.topics[l].notags]),!0}else if(p&&y.call(t.notopics.tags,p)){if(t.notopics.tags[p].list.length&&(o<=0||a(t.notopics.tags[p].namespaces,i,o)))return s.push([null,e,o>0,t.notopics.tags[p]]),!0}else if(t.notopics.notags.list.length&&(o<=0||a(t.notopics.notags.namespaces,i,o)))return s.push([null,null,!0,t.notopics.notags]),!0;return!1}function r(t,s,n){var e,i,l,p,a,r=o(t,n),u=r[1],f=r[2],g=r[3],h=r[0],b=[];if(p=f.length,a=g.length,e=u.length)for(;e;){if(i=u[0],y.call(s.topics,"tp_"+i))if(p>0)for(l=0;l<p;l++)c(s,b,i,f[l],g,a);else c(s,b,i,null,g,a);u.shift(),e--}if(p>0)for(l=0;l<p;l++)c(s,b,null,f[l],g,a);return c(s,b,null,null,g,a),[h,b,g]}function u(t){if(t&&y.call(t,"list")){var s,n,e,i;if((e=t.list)&&(n=e.length))if(t.oneOffs>0)for(s=n-1;s>=0;s--)(i=e[s])[1]&&i[4]>0&&(e.splice(s,1),t.oneOffs=t.oneOffs>0?t.oneOffs-1:0);else t.oneOffs=0}return t}function f(t,s,e,i,o){if(e){var l,p,c,f,g,h,b,d,_,m,y,$,S,j,x=r(s,e,i);for(d=x[0],S=(y=x[2]).length,j=null,(c=(x=x[1]).length)>0&&((j=new n(t)).data=o,j.originalTopic=d?d.split(v):[]),l=0;l<c;l++){for(_=x[l][0],m=x[l][1],j.topic=_?_.split(v):[],j.tags=m?m.split(O):[],$=x[l][2],g=[],f=(h=x[l][3]).list.length,p=0;p<f;p++)(b=h.list[p])[1]&&b[4]||!(!$||b[2]&&a(b[2],y,S))||g.push(b);for(f=g.length,p=0;p<f&&(b=g[p],j.namespaces=$?b[3].slice(0):[],b[4]=1,!1!==b[0](j)&&!j.stopped()&&!j.aborted());p++);if(u(h),j.aborted()||!j.propagates())break}j&&(j.dispose(),j=null)}}function g(t,n,e,i){var o=n[0],l=n[2],n=n[1];t.non_local=new s({t:0,s:0,start_topic:!0,subscribers:null,topics:n,namespaces:l,hasNamespace:!1,abort:e,finish:i}),t.originalTopic=o?o.split(v):[];return function(t){if(t.non_local){var s,n,e,i,o,l,p=t.non_local;if(p.t<p.topics.length){if(p.start_topic){if(u(p.subscribers),t.aborted()||!t.propagates())return t.aborted()&&"function"==typeof p.abort&&(o=p.abort,p.abort=null,o(t),"function"==typeof p.finish&&(l=p.finish,p.finish=null,l(t))),!1;s=p.topics[p.t][0],n=p.topics[p.t][1],t.topic=s?s.split(v):[],t.tags=n?n.split(O):[],p.hasNamespace=p.topics[p.t][2],p.subscribers=p.topics[p.t][3],p.s=0,p.start_topic=!1}if(p.s<p.subscribers.list.length){if(t.aborted()||t.stopped())return u(p.subscribers),t.aborted()&&"function"==typeof p.abort&&(o=p.abort,p.abort=null,o(t),"function"==typeof p.finish&&(l=p.finish,p.finish=null,l(t))),!1;for(i=!1;p.s<p.subscribers.list.length&&!i;)(e=p.subscribers.list[p.s])[1]&&e[4]||!(!p.hasNamespace||e[2]&&a(e[2],p.namespaces,p.namespaces.length))||(i=!0),p.s+=1;p.s>=p.subscribers.list.length&&(p.t+=1,p.start_topic=!0),i&&(p.hasNamespace?t.namespaces=e[3].slice(0):t.namespaces=[],e[4]=1,e[0](t))}else p.t+=1,p.start_topic=!0}t.non_local&&p.t>=p.topics.length&&(u(p.subscribers),"function"==typeof p.finish&&(l=p.finish,p.finish=null,l(t)),t&&(t.non_local.dispose(["t","s","start_topic","subscribers","topics","namespaces","hasNamespace","abort","finish"]),t.non_local=null,t.dispose(),t=null))}}}function h(t,s,e,i,o,l,p){if(e){var a,c=r(s,e,i),u=null;c[1].length>0&&((u=new n(t)).data=o,u.pipeline(a=g(u,c,l,p)),a(u))}}function b(t,s,n,e,o,p){if(s&&"function"==typeof e){var a,c,r,u,f,g,h,b=(n=i(t,n))[1].join(O),d=b.length,_=n[2],m=_.length;if(n=n[0].join(v),o=!0===o,p=!0===p,f={},m)for(h=0;h<m;h++)f["ns_"+_[h]]=1;g=_.slice(0),c=null,n.length?(r="tp_"+n,y.call(s.topics,r)||(s.topics[r]={notags:{namespaces:{},list:[],oneOffs:0},tags:{}}),d?(u="tg_"+b,y.call(s.topics[r].tags,u)||(s.topics[r].tags[u]={namespaces:{},list:[],oneOffs:0}),c=s.topics[r].tags[u]):c=s.topics[r].notags):d?(u="tg_"+b,y.call(s.notopics.tags,u)||(s.notopics.tags[u]={namespaces:{},list:[],oneOffs:0}),c=s.notopics.tags[u]):m&&(c=s.notopics.notags),null!==c&&(a=m?[e,o,f,g,0]:[e,o,!1,[],0],p?c.list.unshift(a):c.list.push(a),o&&c.oneOffs++,m&&l(c.namespaces,_,m))}}function d(t,s,n,e,i){var o,l=t.list.length;if(s){if(null!=n&&l>0)for(;--l>=0;)n===t.list[l][0]&&(i&&t.list[l][2]&&a(t.list[l][2],e,i)?(o=$(t.list[l][2]),p(t.namespaces,o,o.length),t.list[l][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(l,1)):i||(t.list[l][2]&&(o=$(t.list[l][2]),p(t.namespaces,o,o.length)),t.list[l][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(l,1)))}else if(!s&&i>0&&l>0)for(;--l>=0;)t.list[l][2]&&a(t.list[l][2],e,i)&&(o=$(t.list[l][2]),p(t.namespaces,o,o.length),t.list[l][1]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.list.splice(l,1));else!s&&l>0&&(t.list=[],t.oneOffs=0,t.namespaces={})}function _(t,s,n,e){if(s){var o,l,p,a,c,r,u=(n=i(t,n))[1].join(O),f=n[2],g=u.length,h=f.length;if(n=n[0].join(v),c=n.length,p=!!c&&"tp_"+n,a=!!g&&"tg_"+u,(r=!(!e||"function"!=typeof e))||(e=null),c&&y.call(s.topics,p))g&&y.call(s.topics[p].tags,a)?(d(s.topics[p].tags[a],r,e,f,h),s.topics[p].tags[a].list.length||delete s.topics[p].tags[a]):g||d(s.topics[p].notags,r,e,f,h),s.topics[p].notags.list.length||$(s.topics[p].tags).length||delete s.topics[p];else if(!c&&(g||h))if(g){y.call(s.notopics.tags,a)&&(d(s.notopics.tags[a],r,e,f,h),s.notopics.tags[a].list.length||delete s.notopics.tags[a]);for(o in s.topics)y.call(s.topics,o)&&y.call(s.topics[o].tags,a)&&(d(s.topics[o].tags[a],r,e,f,h),s.topics[o].tags[a].list.length||delete s.topics[o].tags[a])}else{d(s.notopics.notags,r,e,f,h);for(l in s.notopics.tags)y.call(s.notopics.tags,l)&&(d(s.notopics.tags[l],r,e,f,h),s.notopics.tags[l].list.length||delete s.notopics.tags[l]);for(o in s.topics)if(y.call(s.topics,o)){d(s.topics[o].notags,r,e,f,h);for(l in s.topics[o].tags)y.call(s.topics[o].tags,l)&&(d(s.topics[o].tags[l],r,e,f,h),s.topics[o].tags[l].list.length||delete s.topics[o].tags[l])}}}}var m="prototype",y=Object[m].hasOwnProperty,v="/",O="#",$=Object.keys,S=Date.now?Date.now:function(){return(new Date).getTime()};s[m]={constructor:s,dispose:function(t){if(t)for(var s=0;s<t.length;s++)this[t[s]]=null;return this}},n[m]={constructor:n,target:null,topic:null,originalTopic:null,tags:null,namespaces:null,data:null,timestamp:0,is_pipelined:!1,_next:null,_propagates:!0,_stopped:!1,_aborted:!1,dispose:function(){var t=this;return t.target=null,t.topic=null,t.originalTopic=null,t.tags=null,t.namespaces=null,t.data instanceof s&&t.data.dispose(),t.data=null,t.timestamp=null,t.is_pipelined=!1,t._propagates=!0,t._stopped=!0,t._aborted=!1,t._next=null,t},next:function(){return"function"==typeof this._next&&this._next(this),this},pipeline:function(t){return arguments.length||(t=null),"function"==typeof t?(this._next=t,this.is_pipelined=!0):(this._next=null,this.is_pipelined=!1),this},propagate:function(t){return arguments.length||(t=!0),this._propagates=!!t,this},stop:function(t){return arguments.length||(t=!0),this._stopped=!!t,this},abort:function(t){return arguments.length||(t=!0),this._aborted=!!t,this},aborted:function(){return this._aborted},propagates:function(){return this._propagates},stopped:function(){return this._stopped}};var j=function(){if(!(this instanceof j))return new j;this.initPubSub()};return j.VERSION="1.1.0",j.Event=n,j.Data=function(t){return new s(t)},j[m]={constructor:j,_seps:null,_pubsub$:null,initPubSub:function(){var t=this;return t._seps=["/","#","@"],t._pubsub$={notopics:{notags:{namespaces:{},list:[],oneOffs:0},tags:{}},topics:{}},t},disposePubSub:function(){var t=this;return t._seps=null,t._pubsub$=null,t},setSeparators:function(t){var s,n=this;return t&&(s=t.length)&&(s>0&&t[0]&&(n._seps[0]=t[0]),s>1&&t[1]&&(n._seps[1]=t[1]),s>2&&t[2]&&(n._seps[2]=t[2])),n},trigger:function(t,s,n){var e=this;return 3>arguments.length&&(n=0),n=+n,2>arguments.length&&(s={}),n>0?setTimeout(function(){f(e,e._seps,e._pubsub$,t,s)},n):f(e,e._seps,e._pubsub$,t,s),e},pipeline:function(t,s,n,e,i){var o=this;return 5>arguments.length&&(i=0),i=+i,2>arguments.length&&(s={}),i>0?setTimeout(function(){h(o,o._seps,o._pubsub$,t,s,n||null,e||null)},i):h(o,o._seps,o._pubsub$,t,s,n||null,e||null),o},on:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s),n},one:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!0),n},on1:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!1,!0),n},one1:function(t,s){var n=this;return s&&"function"==typeof s&&b(n._seps,n._pubsub$,t,s,!0,!0),n},off:function(t,s){var n=this;return _(n._seps,n._pubsub$,t,s||null),n}},j});
/**
*
*   Asynchronous.js
*   @version: 0.5.1
*
*   Simple JavaScript class to manage asynchronous, parallel, linear, sequential and interleaved tasks
*   https://github.com/foo123/asynchronous.js
*
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Asynchronous",function n(e){"use strict";function t(n){var e,t=[];if(n)for(e in n)n[c](e)&&t.push(e+"="+(!0===n[e]||1===n[e]?"yes":!1===n[e]||0===n[e]?"no":n[e]));return t.join(",")}function r(n,e){n.$runmode=M,n.$running=!1}function o(n,e){var t,r=n,o=r.$queue;if(r.$runmode=x,o){for(;o.length&&(!o[0]||!o[0].canRun());)o.shift();o.length?(r.$running=!0,t=o.shift(),e?t.runWithArgs(e):t.run(),t.complete()):r.$running=!1}}function i(n,e){var t,r=n,o=r.$queue,s=0;if(r.$runmode=R,o&&o.length){for(r.$running=!0;s<o.length;)t=o[s],t&&t.canRun()?(e?t.runWithArgs(e):t.run(),t.isFinished()?(o.shift(),t.complete()):s++):o.shift();r.$running=!1,r.$timer=N(v(i,r),r.$interval)}}function s(n,e){var t,r=n,o=r.$queue;r.$runmode=O,o&&o.length&&(t=o[0],t&&t.canRun()?(r.$running=!0,e?t.runWithArgs(e):t.run(),t.isFinished()&&(o.shift(),t.complete())):o.shift(),r.$running=!1,r.$timer=N(v(s,r),r.$interval))}var u,l="prototype",c="hasOwnProperty",a=Object,f=Array,p=Function,d=p[l],h=a[l],m=f[l],$=(JSON.parse,JSON.stringify),g=function(){},v=function(n,e){return function(){return n(e)}},w=d.call.bind(m.slice),y=h.toString,b=function(n){return"function"==typeof n},S=function(n,e){return n instanceof e},N=setTimeout,k=clearTimeout,j=e,E=0,T=1,q=2,W=60,A=0,R=1,x=2,M=3,O=4,C="undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"],L="undefined"!=typeof global&&"[object global]"===y.call(global),I=L&&"undefined"!=typeof process.send,U=!C&&!L&&"undefined"!=typeof SharedWorkerGlobalScope&&"function"==typeof importScripts,B=!C&&!L&&"undefined"!=typeof WorkerGlobalScope&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,D=!(C||L||B||U||"undefined"==typeof navigator||"undefined"==typeof document),F=(D&&!!window.opener,D&&window.self!==window.top,"function"==typeof define&&define.amd),P=L||"function"==typeof Worker||"function"==typeof SharedWorker,_=L?this:U||B?self||this:window||this,z=L?module.$deps:U||B?self||this:window||this,G=(L?global:U||B?self||this:window||this,I||U||B),J=I&&0===process.listenerCount("message")||U&&!_.onconnect||B&&!_.onmessage,V=J?function un(n){un.handler&&un.handler(I?n:n.data)}:g,K=null,Q={},X=(L?require("os").cpus().length:4,L?null:"undefined"!=typeof _.webkitURL?_.webkitURL:"undefined"!=typeof _.URL?_.URL:null),Y=function(n,e){return n&&X?X.createObjectURL(new Blob(n.push?n:[n],e||{type:"text/javascript"})):n},H=function ln(n){var e;return L?{file:__filename,path:__dirname}:U||B?{file:e=self.location.href,path:e.split("/").slice(0,-1).join("/")}:F&&n?{file:e=n,path:e.split("/").slice(0,-1).join("/")}:D&&(e=document.getElementsByTagName("script"))&&e.length?(ln.link||(ln.link=document.createElement("a")),ln.link.href=e[e.length-1].src,e=ln.link.href,{file:e,path:e.split("/").slice(0,-1).join("/")}):{path:null,file:null}},Z=H(n.moduleUri),nn=Z.file,en=function(n,e){if(n=n||{},e)for(var t in e)e[c](t)&&(n[t]=e[t]);return n},tn=0;Q[nn]=1,L?(u=function(n){var e=this;e.process=require("child_process").fork(n),e.process.on("message",function(n){e.onmessage&&e.onmessage(n)}),e.process.on("error",function(n){e.onerror&&e.onerror(n)})},u.Shared=u,u[l]={constructor:u,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.send(n),this},terminate:function(){return this.process&&(this.process.kill(),this.process=null),this}}):(u=function(n){var e=this;e.process=new Worker(n),e.process.onmessage=function(n){e.onmessage&&e.onmessage(n.data)},e.process.onerror=function(n){e.onerror&&e.onerror(n)}},u.Shared=u,u[l]={constructor:u,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.postMessage(n),this},terminate:function(){return this.process&&(this.process.terminate(),this.process=null),this}},"function"==typeof SharedWorker&&(u.Shared=function(n){var e=this;e.process=new SharedWorker(n),e.process.port.start(),e.process.port.onmessage=function(n){e.onmessage&&e.onmessage(n.data)},e.process.port.onerror=e.process.onerror=function(n){e.onerror&&e.onerror(n)}},u.Shared[l]={constructor:u.Shared,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.port.postMessage(n),this},terminate:function(){return this.process&&(this.process.port.close(),this.process=null),this}})),J&&(U?(_.close=g,_.postMessage=g,_.onconnect=function(n){var e=n.ports[0];_.close=function(){e.close()},_.postMessage=function(n){e.postMessage(n)},e.addEventListener("message",V),e.start()}):B?_.onmessage=V:I&&(_.close=function(){process.exit()},_.postMessage=function(n){process.send(n)},_.importScripts=function(n){try{new Function("",require("fs").readFileSync(n).toString()).call(z)}catch(e){throw e}},process.on("message",V)));var rn=function cn(n){var e=this;return e instanceof cn?(e.$id=(++tn).toString(16),void(e.options=en({width:400,height:400,toolbar:0,location:0,directories:0,status:0,menubar:0,scrollbars:1,resizable:1},n))):new cn(n)};rn[l]={constructor:rn,options:null,$id:null,$window:null,dispose:function(){var n=this;return n.$window&&n.close(),n.$window=null,n.$id=null,n.options=null,n},close:function(){var n=this;return n.$window&&(n.$window.closed||n.$window.close(),n.$window=null),n},ready:function(n,e){var t=this,r=function o(){!t.$window||n&&!t.$window[n]?setTimeout(o,60):e()};return setTimeout(r,0),t},open:function(n){var e=this;return!e.$window&&n&&(e.$window=window.open(n.push?Y(["\ufeff"].concat(n),{type:"text/html;charset=utf-8"}):n,e.$id,t(e.options))),e},write:function(n){var e=this;return e.$window&&n&&e.$window.document.write(n),e}};var on=function an(n){if(n instanceof an)return n;if(!(this instanceof an))return new an(n);var t,r=this,o=null,i=null,s=null,u=!1,l=!1,c=!1,a=!1,f=!1,p=!1,d=null,h=0,m=1,$=null,g=null,v=null,w=e;r.queue=function(n){return arguments.length?(o=n,r):o},r.jumpNext=function(n){o&&o.jumpNext(!1,n)},r.abort=function(n){o&&(o.abort(!1),n&&(o.dispose(),o=null))},r.dispose=function(){o&&(o.dispose(),o=null)},r.task=function(n){return i=n,r},n&&r.task(n),r.run=t=function(){return i.jumpNext=r.jumpNext,i.abort=r.abort,i.dispose=r.dispose,w=i(),u=!0,i.jumpNext=null,i.abort=null,i.dispose=null,w},r.runWithArgs=function(n){return i.jumpNext=r.jumpNext,i.abort=r.abort,i.dispose=r.dispose,w=i.apply(null,n),u=!0,i.jumpNext=null,i.abort=null,i.dispose=null,w},r.canRun=function(){return i&&(!u||l||c||a||f||p)?(l||c)&&h>=$?!1:c&&!d?!1:!a&&!f||w!==g:!1},r.iif=function(n,e,t){return n?r.task(e):arguments.length>2&&r.task(t),r},r.until=function(n){return w=e,d=null,g=n,f=!0,p=!1,l=!1,c=!1,a=!1,r.run=t,r},r.untilNot=function(n){return w=e,d=null,v=n,p=!0,f=!1,l=!1,c=!1,a=!1,r.run=t,r},r.loop=function(n,t,o){return w=e,d=null,h=t||0,m=o||1,$=n,l=!0,f=!1,p=!1,c=!1,a=!1,r.run=function(){var n;return n=i(h),h+=m,w=n,u=!0,n},r},r.each=function(n){return w=e,d=n,h=0,m=1,$=n?n.length||0:0,c=!0,f=!1,p=!1,l=!1,a=!1,r.run=function(){var n;return n=i(d[h],h),h++,w=n,u=!0,n},r},r.recurse=function(n,e){return d=null,w=n,g=e,a=!0,f=!1,p=!1,l=!1,c=!1,r.run=function(){var n;return n=i(w),w=n,u=!0,n},r},r.isFinished=function(){var n=!u||p||f||l||c||a;return n&&(f||a)&&w===g&&(n=!1),n&&p&&w!==v&&(n=!1),n&&(l||c)&&h>=$&&(n=!1),!n},r.onComplete=function(n){return s=n||null,r},r.complete=function(){return s&&b(s)&&s(),r}},sn=function fn(n,e){if(S(n,on))return n;if(b(n))return new on(n);if(!S(this,fn))return new fn(n,e);var t=this;t.$interval=arguments.length?parseInt(n,10)||W:W,t.$timer=null,t.$runmode=A,t.$running=!1,t.$queue=[],J&&!1!==e&&t.initThread()};return sn.VERSION="0.5.1",sn.Thread=u,sn.Task=on,sn.BrowserWindow=rn,sn.MODE={NONE:A,INTERLEAVE:R,LINEAR:x,PARALLEL:M,SEQUENCE:O},sn.Platform={UNDEFINED:j,UNKNOWN:E,NODE:T,BROWSER:q},sn.supportsMultiThreading=function(){return P},sn.isPlatform=function(n){return T===n?L:q===n?D:e},sn.isThread=function(n,e){return e=!0===e?J:!0,T===n?e&&I:q===n?e&&(U||B):e&&G},sn.path=H,sn.blob=Y,sn.load=function(n,e,t){if(n){var r=function(){n=n.split(".");for(var e=z;n.length;)n[0]&&n[0].length&&e[n[0]]&&(e=e[n[0]]),n.shift();return e&&_!==e?b(e)?!1!==t?new e:e():e:void 0};return e&&e.length&&sn.importScripts(e.join?e.join(","):e),r()}return null},sn.listen=J?function(n){V.handler=n}:g,sn.send=J?function(n){_.postMessage(n)}:g,sn.importScripts=J?function(n){if(n&&n.length){n.split&&(n=n.split(","));for(var e=0,t=n.length;t>e;e++){var r=n[e];r&&r.length&&1!==Q[r]&&(_.importScripts(r),Q[r]=1)}}}:g,sn.close=J?function(){_.close()}:g,sn.log="undefined"!=typeof console?function(n){console.log(n||"")}:g,sn.serialize=function(n){n=n||new sn(0,!1);var e=function(e){var t=function(){var t=this,r=arguments;n.step(function(){e.apply(t,r)}),n.$running||n.run(x)};return t.free=function(){return e},t};return e.free=function(){n&&n.dispose(),n=null},e},sn[l]={constructor:sn,$interval:W,$timer:null,$queue:null,$thread:null,$events:null,$runmode:A,$running:!1,dispose:function(n){var e=this;return e.unfork(!0),e.$timer&&k(e.$timer),e.$thread=null,e.$timer=null,e.$interval=null,e.$queue=null,e.$runmode=A,e.$running=!1,J&&!0===n&&sn.close(),e},empty:function(){var n=this;return n.$timer&&k(n.$timer),n.$timer=null,n.$queue=[],n.$runmode=A,n.$running=!1,n},interval:function(n){return arguments.length?(this.$interval=parseInt(n,10)||this.$interval,this):this.$interval},fork:function(n,e,t,r){var o,i,s,l=this;if(!l.$thread){if(!P)throw l.$thread=null,new Error("Asynchronous: Multi-Threading is NOT supported!");L?(i="Asynchronous: Thread (Process): ",s="Asynchronous: Thread (Process) Error: "):(i="Asynchronous: Thread (Worker): ",s="Asynchronous: Thread (Worker) Error: "),l.$events=l.$events||{},o=l.$thread=!0===r?new u.Shared(nn):new u(nn),o.onmessage=function(n){if(n.event){var e=n.event,t=n.data||null;l.$events&&l.$events[e]?l.$events[e](t):"console.log"!==e&&"console.error"!==e||sn.log(("console.error"===e?s:i)+(t||""))}},o.onerror=function(n){if(!l.$events||!l.$events.error)throw new Error(s+n.toString());l.$events.error(n)},l.send("initThread",{component:n||null,asInstance:!1!==t,imports:e?[].concat(e).join(","):null})}return l},unfork:function(n){var e=this;return e.$thread&&(!0===n?e.$thread.terminate():e.send("dispose")),e.$thread=null,e.$events=null,e},initThread:function(){var n=this;return J&&(n.$events={},sn.listen(function(e){var t=e.event,r=e.data||null;t&&n.$events[t]?n.$events[t](r):"dispose"===t&&(n.dispose(),sn.close())})),n},listen:function(n,e){return n&&b(e)&&this.$events&&(this.$events[n]=e),this},unlisten:function(n,e){return n&&this.$events&&this.$events[n]&&(2>arguments.length||e===this.$events[n])&&delete this.$events[n],this},send:function(n,e){return n&&(J?sn.send({event:n,data:e||null}):this.$thread&&this.$thread.postMessage({event:n,data:e||null})),this},task:function(n){return S(n,on)?n:b(n)?on(n):void 0},iif:function(){var n=arguments,e=new on;return e.iif.apply(e,n)},until:function(){var n=w(arguments),e=new on(n.pop());return e.until.apply(e,n)},untilNot:function(){var n=w(arguments),e=new on(n.pop());return e.untilNot.apply(e,n)},loop:function(){var n=w(arguments),e=new on(n.pop());return e.loop.apply(e,n)},each:function(){var n=w(arguments),e=new on(n.pop());return e.each.apply(e,n)},recurse:function(){var n=w(arguments),e=new on(n.pop());return e.recurse.apply(e,n)},step:function(n){var e=this;return n&&e.$queue.push(e.task(n).queue(e)),e},steps:function(){var n,e,t=this,r=arguments;for(e=r.length,n=0;e>n;n++)t.step(r[n]);return t},jumpNext:function(n,e){var t=this,r=t.$queue;return e=e||0,!1!==n?function(){return e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t}:(e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t)},jumpNextWithArgs:function(n,e,t){var r=this,o=r.$queue;return e=e||0,!1!==n?function(){return e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,arguments)),r}:(e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,t)),r)},abort:function(n,e){var t=this;return!1!==n?function(){return e&&e>0?N(function(){t.empty()},e):t.empty(),t}:(e&&e>0?N(function(){t.empty()},e):t.empty(),t)},run:function(n,e){var t=this;return arguments.length?t.$runmode=n:n=t.$runmode,e=e||null,O===n?s(t,e):R===n?i(t,e):x===n?o(t,e):M===n&&r(t,e),t}},J&&(sn.log=function(n){sn.send({event:"console.log",data:"string"!=typeof n?$(n):n})},sn.listen(function(n){var e=n.event,t=n.data||null;switch(e){case"initThread":t&&t.component&&(K&&(b(K.dispose)&&K.dispose(),K=null),K=sn.load(t.component,t.imports,t.asInstance));break;case"dispose":K&&(b(K.dispose)&&K.dispose(),K=null),sn.close()}})),sn});
/**
*
*   Sudoku.js
*   @version: 1.0.0
*   @dependencies: Classy.js, PublishSubscribe, Asynchronous.js, jQuery
*
*   Sudoku Builder in JavaScript
*   https://foo123.github.io/
*
*   (light-weight and scaled-down version of CrossWord.js, professional Crossword Builder in JavaScript, by same author)
*
**/!function(l,e,t){"use strict";var s="Classy, PublishSubscribe, Asynchronous".split(/\s*,\s*/);function r(t,e,s,r){return t?e.map(function(e,l){return(s?t[l]:t[e])||(r?r(e):null)}):[]}"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.apply(l,r(module.$deps,s,!1,function(e){return require("./"+e.toLowerCase())}))):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"].concat(s),function(e){return t.moduleUri=e.uri,t.apply(l,r(Array.prototype.slice.call(arguments,1),s,!0))}):e in l||(l[e]=t.apply(l,r(l,s)))&&"function"==typeof define&&define.amd&&define(function(){return l[e]})}("undefined"!=typeof self?self:this,"Sudoku",function e(l,t,s){"use strict";var r,n,o,i,u,c,a,d,h,f,p,g,m,C,y,b,v,S,w,x,T,_,A,R,k,I,E,O,D,z,L,N,U,M,B,H,P,q,G,$,j,F,W,V,K,Q,J,X,Z,Y,ee,le,te,se,re,ne,oe,ie,ue,ce,ae,de,he,fe,pe,ge,me,Ce,ye,be,ve,Se,we,xe,Te,_e,Ae={},Re="function"==typeof jQuery?jQuery:function(){};function ke(e,l){return h((l-e)*f()+e)}function Ie(e,l){if("object"==typeof l){var t,s,r=0;for(t in l)l[y](t)&&((s=l[t]).css=(n=e,o=s.selector,i=[].concat(s.rules).join("; "),u=r++,"insertRule"in n.sheet?(n.sheet.insertRule(o+"{"+i+"}",u),n.sheet.cssRules[u]):"addRule"in n.sheet?(n.sheet.addRule(o,i,u),n.sheet.rules[u]):void 0))}var n,o,i,u;return l}function Ee(){return N===this.cellType}function Oe(){return 0<this.highlightType}function De(){return this.value===this.solution}function ze(){return R(this).removeClass(M),this.value=this.solution||"",this}function Le(){return this.firstChild.value="",this}function Ne(){var e=this;return R(e).removeClass(M),e.value!==e.solution&&(e.value=""),e}function Ue(){var e=this,l=R(e);return e.value&&e.value.length&&e.solution?e.solution===e.value?l.removeClass(M):l.hasClass(M)||l.addClass(M):l.removeClass(M),e}function Me(){return R(this).removeClass(M),this}function Be(e,l,t,s,r,n){t=!t;var o,i=e[0],u=i.row,c=i.column;if(!1===l)(o=e.nextAll(".cell.default").filter(Oe)).length&&o.eq(0).children("input").focus();else if(38===l){for(o=e.prevAll(".cell.default.column-"+c);t&&!o.length&&0<c;)0<=--c&&(e=s.filter(".row-last.column-"+c),o=N===e[0].cellType?e:e.prevAll(".cell.default.column-"+c));o.length&&o.eq(0).children("input").focus()}else if(40===l){for(o=e.nextAll(".cell.default.column-"+c);t&&!o.length&&c<n;)++c<n&&(e=s.filter(".row-first.column-"+c),o=N===e[0].cellType?e:e.nextAll(".cell.default.column-"+c));o.length&&o.eq(0).children("input").focus()}else if(37===l){for(o=e.prevAll(".cell.default.row-"+u);t&&!o.length&&0<u;)0<=--u&&(e=s.filter(".column-last.row-"+u),o=N===e[0].cellType?e:e.prevAll(".cell.default.row-"+u));o.length&&o.eq(0).children("input").focus()}else if(39===l){for(o=e.nextAll(".cell.default.row-"+u);t&&!o.length&&u<r;)++u<r&&(e=s.filter(".column-first.row-"+u),o=N===e[0].cellType?e:e.nextAll(".cell.default.row-"+u));o.length&&o.eq(0).children("input").focus()}return o}function He(e,l,t){return e.index=l,e.val}function Pe(){return this.clue}function qe(){return!this.clue}function Ge(e){var t=e.cells.filter(Pe),l=e.cells.filter(qe),s=e.alphabet.split("");l.each(function(){var e=G(this),l=function(e,l,t){var s,r,n,o=l.slice(0),i=t.length;if(!i)return o;for(s=0;s<i;s++)r=t[s],(e.column===r.column||e.row===r.row||e.square===r.square)&&-1<(n=o.indexOf(r.firstChild.value))&&(o[n]="");return o}(this,s,t);e.find(".sticky-note").each(function(e){l[e]?G(this).removeClass("note-disabled"):G(this).addClass("note-disabled")}),e.find(".note").each(function(e){l[e]?G(this).removeClass("note-disabled"):G(this).addClass("note-disabled")})})}function $e(e){return e.clue}function je(e){return!e.clue}function Fe(e,l){return l.clue&&e.val[l.index]===e.v&&e.matches++,e}function We(e,l,t,s){var r,n,o,i,u=e,c=e.length;for(s=s||[],o=0;o<s.length;o++)if(4&(i=s[o]))for(n=u.slice(0),r=0;r<c;r++)0==(r+1)%t?0<=r+1-t&&(u[r]=n[r+1-t]):r+1<c&&(u[r]=n[r+1]);else if(8&i)for(n=u.slice(0),r=0;r<c;r++)0==(r+1)%t?0<=r+1-t&&(u[r+1-t]=n[r]):r+1<c&&(u[r+1]=n[r]);else 1&i?u=[].concat(u.slice(t),u.slice(0,t)):2&i&&(u=[].concat(u.slice(-t),u.slice(0,-t)));return u}function Ve(e,l,t,s){if(-1!==s&&1!==s)return e;var r,n,o,i,u,c=e.length,a=ge(c),d=-1===s;for(u=i=o=r=n=0;u<c;u++)t<=n&&(r++,o+=t,i=n=0),a[i+r]=e[d?o+t-1-n:o+n],n++,i+=t;return a}function Ke(e,l){var t,s=e.length,r=ge(s);for(t=0;t<s;t++)r[t]=e[l[t]];return r}function Qe(e,l,t,s,r,n,o){var i,u,c,a,d=e.length;if(s!==n)for(c=t*s,a=t*n,u=0;u<t;u++)i=e[c+u],e[c+u]=e[a+u],e[a+u]=i;if(r!==o)for(u=0;u<d;u+=t)i=e[u+r],e[u+r]=e[u+o],e[u+o]=i;return e}function Je(e,l,t,s,r){var n,o,i,u,c,a,d=0,h=!!(1024&s);if(512&s){if(n=e,64&s)12&s&&(n=Ve(n,0,t,d=1),a=l,l=t,t=a),n=function(e){var l,t=[];for(l=0;l<e.length;l++)t=t.concat(e[l]);return t}(Ke(function(e,l,t){var s,r,n=ge(l);for(s=r=0;s<l;s++)n[s]=e.slice(r,r+t),r+=t;return n}(n,l,t),r));else for(3&s&&(n=Ve(n,0,t,d=1),a=l,l=t,t=a),u=o=0;u<l;u++)i=o+t,n=[].concat(n.slice(0,o),Ke(n.slice(o,i),r[u]),n.slice(i)),o+=t;d&&(n=Ve(n,0,t,1))}else{for(n=e,3&s&&(n=Ve(n,0,t,d=1),a=l,l=t,t=a),o=0,r=ge(l),u=0;u<l;u++)r[u]=me(t),u<=(c=h?l*Ce():u)&&c<u+1&&(r[u]=ae(r[u]),i=o+t,n=[].concat(n.slice(0,o),Ke(n.slice(o,i),r[u]),n.slice(i))),o+=t;d&&(n=Ve(n,0,t,1))}return n}function Xe(e,l){e.rows;var t,s,r,n,o,i=e.cols,u=e.subrows,c=e.subcols,a=c,d=u,h=ge(a),f=[1],p=[4];for((o=ge(d))[0]=me(i),l&&(f=[be([1,2])],p=[be([4,8])],n=function(e,l,t,s){var r,n,o,i,u,c,a,d,h,f,p=!!(1024&t);if(64&t)r=ae(me(3&t?e:l));else for(f=s?(n=0<s.length?s[0]:0,o=1<s.length?s[1]:e,i=2<s.length?s[2]:0,u=3<s.length?s[3]:l,4<s.length&&s[4]?(c=s[4],de):(c=null,ae)):(o=e,i=n=0,u=l,c=null,ae),3&t&&(h=e,e=l,l=h,h=n,n=i,i=h,h=o,o=u,u=h),r=ge(e),a=0;a<e;a++)r[a]=me(l),n<=a&&a<o&&(32&t?n<a&&(r[a]=r[a-1].slice()):a<=(d=p?e*Ce():a)&&d<a+1&&(r[a]=[].concat(r[a].slice(0,i),f(r[a].slice(i,u),c),r[a].slice(u))));return r}(u,c,1091),o[0]=ae(o[0])),r=1;r<d;r++)o[r]=We(o[r-1].slice(),0,c,f),l&&(o[r]=Je(o[r],u,c,1036));for(t=0;t<a;t++){for(h[t]=ge(d),s=0;s<d;s++)h[t][s]=o[s].slice();for(o[0]=We(o[0],0,c,p),l&&(o[0]=Je(o[0],u,c,579,n)),r=1;r<d;r++)o[r]=We(o[r],0,c,p),l&&(o[r]=Je(o[r],u,c,579,n))}return h}function Ze(e,l){var t,s,r,n,o,i,u,c,a,d,h,f,p,g,m=e.rows,C=e.cols,y=m*C,b=e.subrows,v=e.subcols,S=v,w=b,x=null,T=!1!==l;for(T&&(x=function(e){e.rows;var l,t,s,r,n,o,f=e.cols,p=e.subrows,g=e.subcols,i=g,u=p,m=ge(i),C=new Te(f),y=new Te(f),b=new Te(f);for(s=0;s<f;s++)C[s]=0,y[s]=0,b[s]=0;for(l=0;l<i;l++)for(m[l]=ge(u),t=0;t<u;t++)m[l][t]=ge(f),m[l][t].done=!1;for(l=0,s=ue(i,u);l<s;l++)for(m[l][l]=ae(me(f)),(n=m[l][l]).done=!0,o=0;o<f;o++)r=1<<n[o],C[l*p+oe.floor(o/g)]|=r,y[l*g+o%g]|=r,b[l*p+l]|=r;return function e(l,t,s,r){if(g<=l)return!0;if(p<=t)return e(l+1,0,0,0);if(m[l][t].done)return e(l,t+1,0,0);if(g<=r)return e(l,t,s+1,0);if(p<=s)return e(l,t+1,0,0);var n,o,i,u=s*g+r,c=l*p+s,a=t*g+r,d=l*p+t,h=ae(me(f));for(n=0;n<f;n++)if(i=1<<(o=h[n]),!(C[c]&i||y[a]&i||b[d]&i)){if(C[c]|=i,y[a]|=i,b[d]|=i,e(l,t,s,r+1))return m[l][t][u]=o,!0;i=~i,C[c]&=i,y[a]&=i,b[d]&=i}return!1}(0,0,0,0)?m:null}(e))&&(T=!1),x=x||Xe(e,T),e.alphabet_map=me(C),e.cells=p=ge(y),e.values=g=ge(y),e.squ=t=ge(C),e.row=s=ge(C),e.col=r=ge(C),c=i=0;i<S;i++,c+=b)for(a=u=0;u<w;u++,a+=v)for(n=d=0;n<b;n++)for(o=0;o<v;o++)p[h=(c+n)*C+a+o]=f={index:h,squ:c+u,row:c+n,col:a+o,squ_row:n,squ_col:o,row_index:a+o,col_index:c+n,squ_index:d,clue:!0,almost_clue:!1,alternatives:null},g[h]=x[i][u][d],r[f.col]||(r[f.col]=ge(C)),s[f.row]||(s[f.row]=ge(C)),t[f.squ]||(t[f.squ]=ge(C)),r[f.col][f.col_index]=s[f.row][f.row_index]=t[f.squ][d]=f,d++;if(T){for(n=0;n<m;n+=b)for(o=0;o<C;o+=v)for(i=0;i<b;i++)for(u=0;u<v;u++)Qe(e.values,0,C,n+i,o+u,n+ye(0,i),o+ye(0,u));e.values=function(e,l,t){if(!(3&t||12&t))return e;var s,r,n,o=e.length,i=ge(o),u=!!(12&t);for(n=s=r=0;n<o;n++)l<=s&&(s=0,r+=l),i[u?r+l-1-s:o-l-r+s]=e[r+s],s++;return i}(e.values,C,be([12,0,3])),m===C&&b===v&&(e.values=Ve(e.values,0,C,be([-1,0,1])))}return e}function Ye(e,l,t){var s,r,n,o,i,u,c,a,d,h,f,p,g,m,C,y,b,v,S,w=e.cells,x=e.values,T=e.row,_=e.col,A=e.squ,R=T.length,k=(w.length,l.length),I=0,E=0,O=l,D=k;t=!1!==t,v=0<k?new Array(k):[],S=0;do{if(0<k&&S<k){for(m=(g=l[S]).index,b=(1<<R>>>0)-1>>>0,s=T[g.row],r=_[g.col],n=A[g.squ],c=0;c<R&&(o=s[c],i=r[c],u=n[c],!(o.clue&&o.index!==m&&b&(d=1<<x[o.index]>>>0)&&0===(b=(b&~d>>>0)>>>0)))&&!(i.clue&&i.index!==m&&b&(h=1<<x[i.index]>>>0)&&0===(b=(b&~h>>>0)>>>0))&&!(u.clue&&u.index!==m&&b&(f=1<<x[u.index]>>>0)&&0===(b=(b&~f>>>0)>>>0));c++);if(0===b){if(S){for(;0<S&&(p=v[S-1])&&0===p[1];)p[0].clue=!1,x[p[0].index]=p[2],v[--S]=re;0<S&&(p[0].clue=!0,y=4294901760&(b=p[1])?4278190080&b?24+_e[b>>>24]:16+_e[b>>>16]:65280&b?8+_e[b>>>8]:_e[b],p[1]=(b&~(1<<y>>>0)>>>0)>>>0,x[p[0].index]=y);continue}return I}y=4294901760&b?4278190080&b?24+_e[b>>>24]:16+_e[b>>>16]:65280&b?8+_e[b>>>8]:_e[b],v[S++]=[g,(b&~(1<<y>>>0)>>>0)>>>0,x[m]],g.clue=!0,x[m]=y}else{for(E=1,a=0;a<D;a++)for(C=x[m=(g=O[a]).index],s=T[g.row],r=_[g.col],n=A[g.squ],c=0;c<R;c++)if(o=s[c],i=r[c],u=n[c],o.index!==m&&x[o.index]===C||i.index!==m&&x[i.index]===C||u.index!==m&&x[u.index]===C){E=0,a=D;break}if(I+=E,t&&1<I){for(;0<S;)(p=v[--S])[0].clue=!1,x[p[0].index]=p[2],v[S]=re;return v=null,I}for(;0<S&&(p=v[S-1])&&0===p[1];)p[0].clue=!1,x[p[0].index]=p[2],v[--S]=re;0<S&&(p[0].clue=!0,y=4294901760&(b=p[1])?4278190080&b?24+_e[b>>>24]:16+_e[b>>>16]:65280&b?8+_e[b>>>8]:_e[b],p[1]=(b&~(1<<y>>>0)>>>0)>>>0,x[p[0].index]=y)}}while(0<S);return v=null,I}function el(e,l,t){var s,r,n,o,i,u,c,a,d,h,f,p,g,m,C,y,b,v,S,w,x,T,_=e.rows,A=e.row,R=e.col,k=e.squ,I=e.values,E=t.length;for(n=T=x=0;n<E;n++){for(b=(y=t[n]).index,y.almost_clue=!1,s=(1<<_>>>0)-1>>>0,r=_,c=A[y.row],a=R[y.col],d=k[y.squ],i=0;i<_&&(h=c[i],f=a[i],p=d[i],!(h.clue&&h.index!==b&&s&(g=1<<I[h.index]>>>0)&&(r--,0===(s=(s&~g>>>0)>>>0))))&&!(f.clue&&f.index!==b&&s&(m=1<<I[f.index]>>>0)&&(r--,0===(s=(s&~m>>>0)>>>0)))&&!(p.clue&&p.index!==b&&s&(C=1<<I[p.index]>>>0)&&(r--,0===(s=(s&~C>>>0)>>>0)));i++);y.current_alternatives=s,y.current_num_alternatives=r}for(n=0;n<E;n++){if(1<(y=t[n]).current_num_alternatives)for(b=y.index,d=k[y.squ],v=he(d,je),s=y.current_alternatives;0!==s;){for(s=(s&~(1<<(o=4294901760&s?4278190080&s?24+_e[s>>>24]:16+_e[s>>>16]:65280&s?8+_e[s>>>8]:_e[s])>>>0)>>>0)>>>0,S=v.length,i=w=0;i<v.length;i++)if((p=v[i]).index!==b){if(u={matches:0,val:I,v:o},fe(A[p.row].concat(R[p.col]),Fe,u),!u.matches)break;w++}else S--;if(w===S){y.current_num_alternatives=1;break}}x+=y.current_num_alternatives,1===y.current_num_alternatives&&(T+=1)}return l.avg_alternatives=E?x/E:0,l.num_singles=T,l.singles_ratio=E?T/E:0,t}function ll(a,e,d){var l,h,f,p,g,t,s,r,n,o,i;for(p=function(e,l,t){l=pe(l,1,t)-1,--t;var s=e.cells.length,r=.35*e.rows,n=1-(t-(l===t?l-1:l))/t,o=ie(s*(.28*((t-l)/t)+.27)),i=ie(r*n*n*n+.4);return{num_clues_initial:s,num_clues_final:o,num_alternatives:i,min_alternatives:i,max_alternatives:i+2,avg_alternatives:0,num_singles:0,singles_ratio:0,no_alternatives:0}}(Ze(a),e,5),s=(h=a.cells).length,o=a.rows,i=a.cols,g=ge(s),t=0;t<s;t++)r=h[t],g[t]=[r,h[r.row*i+i-1-r.col],h[(o-1-r.row)*i+r.col],h[(o-1-r.row)*i+i-1-r.col]];for(d=4===d?be([1,2,3]):d,f=ae(he(h,$e)),he(h,je),p.max_avg_alternatives=-10,l=ce(.1*f.length);0<l--;)(r=f.shift()).clue=!1,0<d&&((n=g[r.index][d]).index!==r.index&&n.clue?(n.clue=!1,f[f.indexOf(n)]=f[f.length-1],f.pop(),l--):n=null);return he(h,je),function(){var e,l,t,s,r,n,o,i,u=f.length,c=[];if(u>p.num_clues_final){for(n=p.min_alternatives,o=p.max_alternatives,t=0;t<u;t++)(e=f[t]).clue=!1,(l=0<d?g[e.index][d]:null)&&l.index!==e.index&&l.clue?l.clue=!1:l=null,s=he(h,je),1===Ye(a,s,!0)&&(el(a,p,s),i=[r=p.avg_alternatives,t,e,l],p.max_avg_alternatives<n?r>=p.max_avg_alternatives?(p.max_avg_alternatives=r,c[Se](i)):c[we](i):r<=o?(r>p.max_avg_alternatives&&(p.max_avg_alternatives=r),c.length?r>=c[0][0]?c[Se](i):c[we](i):c[Se](i)):c[we](i)),e.clue=!0,l&&(l.clue=!0);if(!c.length)return!0;if(t=c[0][1],e=c[0][2],l=c[0][3],e.clue=!1,f[t]=f[f.length-1],f.pop(),l&&(l.clue=!1,f[f.indexOf(l)]=f[f.length-1],f.pop()),u=f.length,he(h,je),u>p.num_clues_final)return!1}return!0}}return r=Ae,n=l,o=t,i="function"==typeof s?s:{isThread:function(){return!1},path:function(){return{file:null,path:null}}},u=Re,c="prototype",a="hasOwnProperty",d=Math,Object[c],Array[c],Function[c],h=d.round,f=d.random,p=function(e,l){var t,s,r,n;for(t=(n=!0===l?e.slice():e).length;t--;)s=ke(0,t),r=n[t],n[t]=n[s],n[s]=r;return n},g=0,n.Merge(r,{VERSION:"1.0.0",Class:n.Class,StaticClass:function(e){return n.Class(n.STATIC,e)},Asynchronous:i,PublishSubscribe:o,$:u,isWorker:i.isThread(null,!0),Path:i.path(e.moduleUri),UUID:function(e){return[e||"pzl",++g,(new Date).getTime()].join("_")},LOCALE:{},setLocale:function(e){if(e)for(var l in e)e[a](l)&&(r.LOCALE[l]=e[l])},clearLocale:function(){r.LOCALE={}},locale:function(e){return e&&r.LOCALE[a](e)?r.LOCALE[e]:e},array:function(e){return new Array(e)},n_array:function e(l){var t,s=l.shift(),r=s?new Array(s):[];if(l.length)for(t=0;t<s;t++)r[t]=e(l.slice(0));return r},range:function(e,l,t){var s,r;if((l=l||{})[a]("alphabet")&&e===l.alphabet.length)s=alphabet.substr&&alphabet.split?alphabet.split(""):alphabet.slice();else if(s=new Array(e),l[a]("value")){var n=l.value,o=!!n.slice;for(r=0;r<e;r++)s[r]=o?n.slice():n}else{var i=l[a]("start")?parseInt(l.start,10):0,u=l[a]("step")?parseInt(l.step,10):1,c=0;for(r=0;r<e;r++)s[r]=c+i,c+=u}return!0===t&&(s=p(s)),s},operate:function(e,l,t){var s,r=e.length,n=15&r,o=1&n,i=o?l(t,e[0]):t;for(s=o;s<n;s+=2)i=l(l(i,e[s]),e[s+1]);for(s=n;s<r;s+=16)i=l(l(l(l(l(l(l(l(l(l(l(l(l(l(l(l(i,e[s]),e[s+1]),e[s+2]),e[s+3]),e[s+4]),e[s+5]),e[s+6]),e[s+7]),e[s+8]),e[s+9]),e[s+10]),e[s+11]),e[s+12]),e[s+13]),e[s+14]),e[s+15]);return i},filter:function(e,l,t){var s,r=e.length,n=15&r,o=1&n,i=[];if(2<arguments.length){for(o&&l.call(t,e[0])&&i.push(e[0]),s=o;s<n;s+=2)l.call(t,e[s])&&i.push(e[s]),l.call(t,e[s+1])&&i.push(e[s+1]);for(s=n;s<r;s+=16)l.call(t,e[s])&&i.push(e[s]),l.call(t,e[s+1])&&i.push(e[s+1]),l.call(t,e[s+2])&&i.push(e[s+2]),l.call(t,e[s+3])&&i.push(e[s+3]),l.call(t,e[s+4])&&i.push(e[s+4]),l.call(t,e[s+5])&&i.push(e[s+5]),l.call(t,e[s+6])&&i.push(e[s+6]),l.call(t,e[s+7])&&i.push(e[s+7]),l.call(t,e[s+8])&&i.push(e[s+8]),l.call(t,e[s+9])&&i.push(e[s+9]),l.call(t,e[s+10])&&i.push(e[s+10]),l.call(t,e[s+11])&&i.push(e[s+11]),l.call(t,e[s+12])&&i.push(e[s+12]),l.call(t,e[s+13])&&i.push(e[s+13]),l.call(t,e[s+14])&&i.push(e[s+14]),l.call(t,e[s+15])&&i.push(e[s+15])}else{for(o&&l(e[0])&&i.push(e[0]),s=o;s<n;s+=2)l(e[s])&&i.push(e[s]),l(e[s+1])&&i.push(e[s+1]);for(s=n;s<r;s+=16)l(e[s])&&i.push(e[s]),l(e[s+1])&&i.push(e[s+1]),l(e[s+2])&&i.push(e[s+2]),l(e[s+3])&&i.push(e[s+3]),l(e[s+4])&&i.push(e[s+4]),l(e[s+5])&&i.push(e[s+5]),l(e[s+6])&&i.push(e[s+6]),l(e[s+7])&&i.push(e[s+7]),l(e[s+8])&&i.push(e[s+8]),l(e[s+9])&&i.push(e[s+9]),l(e[s+10])&&i.push(e[s+10]),l(e[s+11])&&i.push(e[s+11]),l(e[s+12])&&i.push(e[s+12]),l(e[s+13])&&i.push(e[s+13]),l(e[s+14])&&i.push(e[s+14]),l(e[s+15])&&i.push(e[s+15])}return i},shuffle:p,shufflex:function(e,l,t){var s,r,n,o,i,u,c;if(c=!0===t?e.slice():e,(l=l||{})[a]("included")&&l.included.length)u=l.included;else if(l[a]("included_range")&&l.included_range.length)for(u=[],r=s=0;s<e.length;)r<l.included_range.length&&s>=l.included_range[r]&&(r+1>=l.included_range.length||s<=l.included_range[r+1])?u.push(s):r+=2,s++;else if(l[a]("excluded")&&l.excluded.length)for(u=[],r=s=0;s<e.length;)r>=l.excluded.length||s<l.excluded[r]?u.push(s):r++,s++;else if(l[a]("excluded_range")&&l.excluded_range.length)for(u=[],r=s=0;s<e.length;)r<l.excluded_range.length&&s>=l.excluded_range[r]?(s=r+1<l.excluded_range.length?l.excluded_range[r+1]:s,r+=2):u.push(s),s++;else u=[];for(n=u.length;n--;)o=ke(0,n),i=c[u[n]],c[u[n]]=c[u[o]],c[u[o]]=i;return c},clamp:function(e,l,t){return e<l?l:t<e?t:e},randi:ke,randf:function(e,l){return(l-e)*f()+e},randomItem:function(e){return e&&e.length?e[ke(0,e.length-1)]:null}}),m=Ae,y="hasOwnProperty",JSON.parse,b=null,C=m.Factory=m.StaticClass({GRIDS:{},getGrid:function(e){return(e=e?e.toUpperCase():null)&&C.GRIDS[y](e)?new C.GRIDS[e]:null},getCompiler:function(e){return m.Compiler&&e&&"SUDOKU"===e.type&&m.SudokuCompiler?new m.SudokuCompiler(e):null},importTpl:function(e){var l=C.getGrid(e&&e.type||null)||null;return l&&l.importTpl(e),l},createStyleSheet:function(e,l){var t=document.createElement("style");return t.setAttribute("media",e||"all"),t.setAttribute("type","text/css"),t.appendChild(document.createTextNode("")),document.head.appendChild(t),l&&Ie(t,l),t},disposeStyleSheet:function(e){e&&document.head.removeChild(e)},addCSS:Ie,getCSS:function(e){var l,t=[],s=e.sheet,r=s.cssRules?s.cssRules:s.rules;for(l=0;l<r.length;l++)t.push(r[l].cssText?r[l].cssText:r.style.cssText);return t.join("\n")},getTransformProperty:function(e){if(!b)for(var l=e.style,t="Transform",s=["transform","O"+t,"ms"+t,"Webkit"+t,"Moz"+t],r=s.length;r--;)if(l[y](s[r])){b=s[r];break}return b},getElement:function(e){var l,t,s,r,n=(e=e||"div").indexOf("#"),o=e.indexOf(".");return-1<n?(l=e.slice(0,n),e=e.slice(n),o-=n):-1<o?(l=e.slice(0,o),e=e.slice(o)):l=e,"#"===e.charAt(0)?-1<o?(t=e.slice(1,o),e=e.slice(o)):t=e.slice(1):t=null,s="."===e.charAt(0)?e.slice(1).split(".").join(" "):null,r=document.createElement(l.length?l:"div"),t&&(r.id=t),s&&(r.className=s),r}}),v=Ae,(S=Math).floor,w=S.round,S.ceil,x=S.min,S.max,S.abs,T=v.clamp,_=v.shuffle,A=v.Factory,R=v.$,k=R.extend,I=v.UUID,E=A.getTransformProperty,O=A.getCSS,D=A.createStyleSheet,z=A.disposeStyleSheet,L=A.getElement,N=1,U=4,M="notvalid",B="highlighted",H="hide-clues",P="hide-solution",q="hasOwnProperty",v.Grid=v.Class({extends:Object,implements:v.PublishSubscribe},{__static__:{CELL:N,SEP:2,IMAGE:U,PLACEHOLDER:8,CLUE:16,HORIZONTAL:1,VERTICAL:2,ERRORCLASS:M,HIGHLIGHTCLASS:B,FOCUSEDCLASS:"cell-focused",HIDE_CLUES:H,HIDE_SOLUTION:P,DIRECTION_1:256,TOP_RIGHT_HOR:257,TOP_RIGHT_VER:258,TOP_LEFT_HOR:259,TOP_LEFT_VER:300,DIRECTION_2:512,BOTTOM_LEFT_VER:514,BOTTOM_RIGHT_HOR:513,BOTTOM_LEFT_HOR:515,CLEAR_DIRECTION_1:1256,CLEAR_DIRECTION_2:1512,CLEAR_DIRECTIONS:2048,getRange:function(e,l){var t,s=new Array(e);for(t=0;t<e;t++)s[t]=t;return l&&(s=_(s)),s},isCell:Ee,isSeparatorCell:function(){return 2===this.cellType},highlightedCell:Oe,isValidSolution:De,revealCell:ze,clearCell:Le,clearErrors:Ne,highlightCell:function(){this.highlightType<=0&&(this.highlightType=1,R(this).addClass(B))},deHighlightCell:function(){0<this.highlightType&&(this.highlightType=0,R(this).removeClass(B))},highlightErrors:Ue,deHighlightErrors:Me,moveCursor:Be},constructor:function(){var e=this;e.type="GRID",e.id=I(),e.selector=e.getSelector(),e.dimensions=e.getDefaultDimensions(),e.styles=e.getDefaultStyles(),e.cssStyles=e.getDefaultCssStyles(e.selector,e.styles,e.dimensions),e.style=D("all",e.cssStyles),e.grid=null,e.cells=null,e.cellInputs=null,e.userMode=!1,e.initPubSub()},type:null,id:null,selector:null,grid:null,cells:null,style:null,styles:null,cssStyles:null,dimensions:null,alphabet:null,clues:null,cellInputs:null,currentInputCell:null,toggleErrorsHighlight:!1,toggleHorizontalHighlight:!0,userMode:!1,highlightMode:!1,dispose:function(){var e=this;return e.type=null,e.id=null,e.selector=null,e.dimensions=null,e.alphabet=null,e.clues=null,e.currentInputCell=null,e.toggleErrorsHighlight=null,e.toggleHorizontalHighlight=null,e.cellInputs=null,e.cells=null,e.styles=null,e.cssStyles=null,z(e.style),e.style=null,e.grid&&(e.setSelectable(!1,!0).setResizable(!1,!0),e.grid.off(),e.grid.children().remove(),e.grid.remove()),e.grid=null,e.disposePubSub(),e},getCell:function(e,l){var t=arguments.length<2?e||0:(e||0)*this.dimensions.columns+(l||0);return this.cells.eq(t)},getRow:function(e,l,t){var s=this.dimensions.columns,r=(e||0)*s;return l=l||0,t=t?t+1:s,this.cells.slice(r+l,r+t)},getColumn:function(e,l,t){var s,r,n=this.cells,o=this.dimensions.rows,i=this.dimensions.columns,u=R([]);for(e=e||0,t=t||o-1,s=l=l||0,r=l*i;s<=t;s++,r+=i)u=u.add(n.eq(r+e));return u},getCells:function(e,l,t,s){var r,n,o,i=this.cells,u=this.dimensions.columns,c=this.dimensions.rows;if(!arguments.length)return i.slice(0);for(arguments.length<2?(l=0,t=c-1,s=u-1):arguments.length<3?(t=c-1,s=u-1):arguments.length<4&&(s=u-1),t<e&&(o=e,e=t,t=o),s<l&&(o=l,l=s,s=o),e=T(e,0,c-1),t=T(t,0,c-1),l=T(l,0,u-1),s=T(s,0,u-1),s+=1,r=R([]),o=(n=e)*u;n<=t;n++,o+=u)r=r.add(i.slice(o+l,o+s));return r},getRange:function(e){var t=1/0,s=-1/0,r=1/0,n=-1/0;return e&&e.length?(e.each(function(){var e=this.row,l=this.column;e<=t&&(t=e),s<=e&&(s=e),l<=r&&(r=l),n<=l&&(n=l)}),[{row:t,column:r},{row:s,column:n}]):[{row:0,column:0},{row:0,column:0}]},getCellInputs:function(){return this.cellInputs||(this.cellInputs=this.cells.filter(Ee).children("input")),this.cellInputs},setSelectable:function(e,l){var t,s,r=this.grid;return R.fn.selectable&&r&&(s=(t=!!r.data("ui-selectable"))&&!r.selectable("option","disabled"),e?t?t&&!s&&r.selectable("option","disabled",!1):r.selectable({filter:".cell",autoRefresh:!1}):l&&t?(r.children(".ui-selected").removeClass("ui-selected"),r.selectable("destroy")):s&&!l&&(r.children(".ui-selected").removeClass("ui-selected"),r.selectable("option","disabled",!0).removeClass("ui-state-disabled").attr("aria-disabled","false"))),this},setResizable:function(e,l){var t,s,r,n,o=this,i=o.grid;return R.fn.resizable&&i&&(t=(s=!!i.data("ui-resizable"))&&!i.resizable("option","disabled"),e?s?s&&!t&&i.resizable("option","disabled",!1):(r=function(){o.setSelectable(!1)},n=function(){o.setSelectable(!0)},i.on("mousedown.resizablehandle",">.ui-resizable-handle:not(.ui-resizable-image-handle)",r).on("mouseup.resizablehandle",">.ui-resizable-handle:not(.ui-resizable-image-handle)",n).resizable({animate:!1,aspectRatio:!0,autoHide:!0,handles:"all",minHeight:100,minWidth:100,delay:50,ghost:!0,distance:2,helper:"resizable-helper",grid:!1,start:function(e,l){r(),i.addClass("resizing")},stop:function(e,l){var t=o.dimensions,s=(t.cellSize,w(l.size.width/t.columns));t.cellSize=s,i.removeClass("resizing"),n(),o.updateDimensions()}})):l&&s?i.resizable("destroy").off("mousedown.resizablehandle mouseup.resizablehandle resizestart resizestop"):t&&!l&&i.resizable("option","disabled",!0).removeClass("ui-state-disabled").attr("aria-disabled","false")),o},setHighlightMode:function(e){return this.highlightMode=!!e,this},handleInput:function(e,l,t){var s,r=this,n=r.alphabet,o=l.value.toUpperCase(),i=R(l),u=r.dimensions.rows,c=r.dimensions.columns;r.toggleHorizontalHighlight;return o.length&&n.indexOf(o)<0&&(o=""),r.toggleErrorsHighlight&&(l.solution&&o.length&&o!==l.solution?i.hasClass(M)||i.addClass(M):i.removeClass(M)),s=(l.value=o).length&&-1<n.indexOf(o)?Be(i.parent(".cell"),!1,!0,r.cells,u,c):i.parent(".cell"),o!==t&&r.trigger("input",{input:l}),s},handleKeyNav:function(e,l){var t=this.dimensions;return Be(l,e.which,!1,this.cells,t.rows,t.columns)},showClues:function(e){var l=this.grid;return(e=!arguments.length||!!e)&&l.hasClass(H)?l.removeClass(H):e||l.hasClass(H)||l.addClass(H),this},showSolution:function(e){var l=this.grid;return(e=!arguments.length||!!e)&&l.hasClass(P)?l.removeClass(P):e||l.hasClass(P)||l.addClass(P),this},enableUserMode:function(e){var l=this,t=l.grid;return e&&!l.userMode?(t.addClass("user-mode"),l.setResizable(!1),l.userMode=!0,l.trigger("userMode",{userMode:!0})):!e&&l.userMode&&(t.removeClass("user-mode"),l.setResizable(!0),l.userMode=!1,l.trigger("userMode",{userMode:!1})),l},scale:function(e){var l=this.grid[0],t=E(l);return arguments.length?(e=parseFloat(e,10),l.style[t+"Origin"]="center center",l.style[t]="scale("+e+","+e+")"):(l.style[t+"Origin"]="center center",l.style[t]="none"),this},build:function(e){return this.buildGrid(e).onBuildComplete().trigger("build",null,50).trigger("percentage",{percentage:this.getPercentage()},100),this},importTpl:function(e){return e&&e[q]("dimensions")&&(this.setStyles(e.styles).buildGrid(e.dimensions),e[q]("alphabet")&&e.alphabet&&e.alphabet.length&&this.setAlphabet(e.alphabet),this.onBuildComplete().trigger("build",null,50).trigger("import",null,100)),this},exportTpl:function(){var e=this;e.grid,e.cells;return{type:e.type,alphabet:e.alphabet||null,dimensions:k({},e.dimensions),styles:k({},e.styles)}},revealSolution:function(){return this.getCellInputs().each(ze),this},revealCells:function(e){return e&&e.length&&e.children("input").each(ze),this},revealCell:function(e){return(e=e||this.currentInputCell||null)&&e.length&&N===e[0].cellType&&ze.call(e[0].firstChild),this},checkIsSolved:function(){var e=this.getCellInputs();return e.filter(De).length===e.length},getSolvedPercent:function(){var e=this.getCellInputs();return e.filter(De).length/(e.length||1)},highlightErrors:function(e){return this.toggleErrorsHighlight=!!e,this.getCellInputs().each(this.toggleErrorsHighlight?Ue:Me),this},clearErrors:function(){return this.getCellInputs().each(Ne),this},getCssStyles:function(e){return(e=e?'<link rel="stylesheet" media="all" href="'+e+'" />':"")+'<style type="text/css" media="all">'+O(this.style)+"</style>"},setStyles:function(e){var l=this,t=l.getDefaultStyles();return l.styles=k({},l.styles||t,e),l.styles[q]("symbolColor")||(l.styles.symbolColor=t.symbolColor),l.styles[q]("clueColor")||(l.styles.clueColor=t.clueColor),l},setDimensions:function(e){return this.dimensions=k({},this.dimensions||this.getDefaultDimensions(),e),this},updateStyles:function(e){var l=this.cssStyles,t=this.styles;return l.grid.css.style.borderColor=t.outerBorderColor,l.grid.css.style.borderWidth=t.outerBorderThickness+"px",l.cell.css.style.backgroundColor=t.cellColor,l.cell.css.style.borderColor=t.borderColor,l.cell.css.style.borderStyle=t.borderStyle,l.cell.css.style.color=t.symbolColor,l.highlighted.css.style.backgroundColor=t.highlightColor,!1!==e&&this.trigger("update-styles"),this},updateDimensions:function(e){var l,t,s,r,n,o,i,u,c,a=this,d=a.dimensions,h=(a.styles,a.cssStyles),f=d.cellSize,p=w(.6*f),g=d.rows,m=d.columns,C=a.grid,y=C[0],b=a.cells;u=g,c=m;if(y.className=y.className.replace(/\bnumRows-(\d+)\b/,function(e,l){return s=parseInt(l,10),"numRows-"+g}).replace(/\bnumColumns-(\d+)\b/,function(e,l){return r=parseInt(l,10),"numColumns-"+m}).replace(/\bsizeCell-\d+\b/,"sizeCell-"+f),y.style.width="",y.style.height="",y.style.left="",y.style.top="",h.grid.css.style.width=f*m+"px",h.grid.css.style.height=f*g+"px",h.cell.css.style.width=f+"px",h.cell.css.style.height=f+"px",h.cell.css.style.fontSize=p+"px",b.each(function(){var e=this,l=R(e),t=e.column,s=e.row;g<=s||m<=t?l.remove():(l.removeClass("row-first row-last column-first column-last"),0===s&&l.addClass("row-first"),g-1===s&&l.addClass("row-last"),0===t&&l.addClass("column-first"),m-1===t&&l.addClass("column-last"),e.style.top=s*f+"px",e.style.left=t*f+"px")}),r<m)for(i=x(g,s),l=0;l<i;l++)for(n=C.children(".cell.row-"+l).eq(-1),t=r;t<m;t++)o=a.buildCell(l,t,f,"cell default row-"+l+" column-"+t+(0==l?" row-first":g-1==l?" row-last":"")+(0==t?" column-first":m-1==t?" column-last":"")),n=R(o).insertAfter(n);if(s<g)for(l=s;l<g;l++)for(t=0;t<m;t++)o=a.buildCell(l,t,f,"cell default row-"+l+" column-"+t+(0==l?" row-first":g-1==l?" row-last":"")+(0==t?" column-first":m-1==t?" column-last":"")),C.append(o);return a.cells=C.children(".cell"),C.hasClass("ui-selectable")&&C.selectable("refresh"),!1!==e&&(a.trigger("update-dimensions"),a.trigger("percentage",{percentage:a.getPercentage()},100)),a},setAlphabet:function(e){return e&&e.length&&(this.alphabet=e.join?e.join(""):e.slice()),this},getHighlighted:function(){return this.cells.filter(Oe)},clearHighlighted:function(){return this.cells.filter(Oe).each(Le),this},clearCells:function(e){return!0===e?this.getCellInputs().val(""):this.cells.children("input").val(""),this},decorateCell:function(){return cell},highlightClue:function(){return this},addClue:function(){return this},addClues:function(){return this},clearClues:function(){return this},clearGrid:function(e){return this.clearCells(e).clearClues(),this},buildGrid:function(e){var l,t,s,r,n,o,i,u,c,a=this;for(e=e||{},a.dimensions||(a.dimensions=a.getDefaultDimensions()),a.styles||(a.styles=a.getDefaultStyles()),a.userMode=!1,a.alphabet=a.alphabet||v.ALPHABET,e.rows&&(a.dimensions.rows=e.rows),e.columns&&(a.dimensions.columns=e.columns),e.cellSize&&(a.dimensions.cellSize=e.cellSize),i=a.dimensions.rows,u=a.dimensions.columns,c=a.dimensions.cellSize,n=a.styles,(o=a.cssStyles).grid.css.style.width=c*u+"px",o.grid.css.style.height=c*i+"px",o.grid.css.style.borderColor=n.outerBorderColor,o.grid.css.style.borderWidth=n.outerBorderThickness+"px",o.cell.css.style.backgroundColor=n.cellColor,o.cell.css.style.borderColor=n.borderColor,o.cell.css.style.borderStyle=n.borderStyle,o.cell.css.style.width=c+"px",o.cell.css.style.height=c+"px",o.cell.css.style.fontSize=w(.6*c)+"px",o.cell.css.style.color=n.symbolColor,o.highlighted.css.style.backgroundColor=n.highlightColor,(s=L("div#"+a.id+"."+a.getGridClasses().join("."))).setAttribute("id",a.id),l=0;l<i;l++)for(t=0;t<u;t++)r=a.buildCell(l,t,c,["cell default","row-"+l+(0==l?" row-first":i-1==l?" row-last":""),"column-"+t+(0==t?" column-first":u-1==t?" column-last":"")].join(" ")),s.appendChild(r);return a.grid=R(s),a.cells=a.grid.children(".cell"),a},buildCell:function(e,l,t,s){var r=L("div"),n=L("input");return r.cellType=N,r.highlightType=0,r.row=e,r.column=l,r.style.top=e*t+"px",r.style.left=l*t+"px",n.solution=null,n.highlightType=0,n.setAttribute("type","text"),n.setAttribute("value",""),n.setAttribute("maxlength","1"),r.appendChild(n),s&&(r.className=""+s),r},onBuildComplete:function(){return this},getSelector:function(){return"#"+this.id+".crossword"},getGridClasses:function(){var e=this.dimensions;return["crossword","numRows-"+e.rows,"numColumns-"+e.columns,"sizeCell-"+e.cellSize]},getDefaultDimensions:function(){return{rows:10,columns:10,cellSize:76}},getDefaultStyles:function(){return{cellColor:"#ffffff",sepColor:"#f2e941",placeholderColor:"#ffffff",highlightColor:"#dddddd",borderColor:"#7f7f7f",borderStyle:"solid",outerBorderThickness:1,outerBorderColor:"#aaaaaa",symbolColor:"#000000",clueColor:"#000000"}},getDefaultCssStyles:function(e,l,t){return{grid:{selector:e,rules:["width: "+t.columns*t.cellSize+"px","height: "+t.rows*t.cellSize+"px","border-color: "+l.outerBorderColor,"border-width: "+l.outerBorderThickness]},cell:{selector:e+" > .cell",rules:["width: "+t.cellSize+"px","height: "+t.cellSize+"px","font-size: "+w(.6*t.cellSize)+"px","background-color: "+l.cellColor,"border-color: "+l.borderColor,"border-style: "+l.borderStyle,"color: "+l.symbolColor]},highlighted:{selector:e+" > .cell."+B,rules:["background-color: "+l.highlightColor]}}},getSeparatorClasses:function(e){return""},getPercentage:function(){return 0},toDefaultCells:function(){return this},toPlaceholderCells:function(){return this},toSeparatorCells:function(){return this},setSolution:function(e){return this},setClues:function(){return this},checkCluesMissing:function(){return!1},toString:function(){return"[Sudoku.Puzzle type="+this.type+"]"}}),(G=Ae.$).extend,$=Math,j=$.round,F=$.min,W=$.max,V=Ae.locale,K=Ae.range,(Q=Ae.Grid).moveCursor,J=Ae.Factory.getElement,X=Q.CELL,Z=Q.CLUE,Y=Q.ERRORCLASS,Q.HIGHLIGHTCLASS,Q.FOCUSEDCLASS,ee="hasOwnProperty",Ae.Sudoku=Ae.Factory.GRIDS.SUDOKU=Ae.Class(Q,{constructor:function(){this.$super("constructor"),this.type="SUDOKU",this.difficulty=1,this.dichromia=!1},difficulty:1,dichromia:!1,dispose:function(){return this.difficulty=null,this.dichromia=null,this.$super("dispose"),this},getSelector:function(){return"#"+this.id+".crossword.sudoku"},getGridClasses:function(){var e=this.$super("getGridClasses");return e.push("sudoku"),e},getDefaultDimensions:function(){return{rows:9,columns:9,subRows:3,subColumns:3,cellSize:70}},getDefaultStyles:function(){return{cellColor:"#ffffff",sepColor:"#f2e941",placeholderColor:"#ffffff",highlightColor:"#dddddd",borderColor:"#7f7f7f",borderStyle:"dashed",outerBorderThickness:2,outerBorderColor:"#121212",symbolColor:"#608b03",clueColor:"#000000"}},getDefaultCssStyles:function(e,l,t){var s=this.$super("getDefaultCssStyles",e,l,t);return s[ee]("separator")&&delete s.separator,s[ee]("placeholder")&&delete s.placeholder,s.stickyNotes={selector:e+" > .cell .sticky-notes a.sticky-note:before",rules:["color: "+l.symbolColor]},s.highlighted={selector:[e+" > .cell:not(.clue):hover",e+" > .cell:not(.clue):focus"].join(","),rules:["background-color: "+l.highlightColor]},s.cellClue={selector:e+" > .cell.clue",rules:["color: "+l.clueColor]},s.cellSubRowLast={selector:e+" > .cell.subrow-last:not(.row-last)",rules:["border-bottom-color: "+l.outerBorderColor,"border-bottom-width: "+l.outerBorderThickness+"px","border-bottom-style: solid"]},s.cellSubColLast={selector:e+" > .cell.subcolumn-last:not(.column-last)",rules:["border-right-color: "+l.outerBorderColor,"border-right-width: "+l.outerBorderThickness+"px","border-right-style: solid"]},s},updateStyles:function(e){var l=this,t=l.cssStyles,s=l.styles;return l.$super("updateStyles",!1),t.cellClue.css.style.color=s.clueColor,t.stickyNotes.css.style.color=s.symbolColor,t.cellSubRowLast.css.style.borderBottomColor=s.outerBorderColor,t.cellSubRowLast.css.style.borderBottomWidth=s.outerBorderThickness+"px",t.cellSubColLast.css.style.borderRightColor=s.outerBorderColor,t.cellSubColLast.css.style.borderRightWidth=s.outerBorderThickness+"px",!1!==e&&l.trigger("update-styles"),l},updateDimensions:function(e){return this.$super("updateDimensions",!1),!1!==e&&this.trigger("update-dimensions"),this},enableNotes:function(e){var l=this.grid;return this.userMode&&(e?l.hasClass("notes")||(this.enableAllNotes(!1),l.addClass("notes")):l.removeClass("notes")),this},enableAllNotes:function(e){var l=this.grid;return this.userMode&&(e?l.hasClass("all-notes")||(this.enableNotes(!1),l.addClass("all-notes")):l.removeClass("all-notes")),this},clearNotes:function(){return this.cells.removeClass("with-notes").find(".sticky-note.noted").removeClass("noted"),this},handleInput:function(e,l,t){var s=this,r=s.alphabet,n=l.value.toUpperCase(),o=G(l);s.dimensions.rows,s.dimensions.columns;n.length&&r.indexOf(n)<0&&(n=""),s.toggleErrorsHighlight&&(l.solution&&n.length&&n!==l.solution?o.hasClass(Y)||o.addClass(Y):o.removeClass(Y)),(l.value=n)!==t&&s.trigger("input",{input:l})},buildGrid:function(e){var l,t,s,r,n,o,i,u,c,a,d,h,f,p,g,m,C=this;for(e=e||{},C.dimensions||(C.dimensions=C.getDefaultDimensions()),C.styles||(C.styles=C.getDefaultStyles()),C.userMode=!1,e.rows&&(C.dimensions.rows=e.rows),e.columns&&(C.dimensions.columns=e.columns),e.subRows&&(C.dimensions.subRows=e.subRows),e.subColumns&&(C.dimensions.subColumns=e.subColumns),e.cellSize&&(C.dimensions.cellSize=e.cellSize),i=C.dimensions.rows,u=C.dimensions.columns,a=C.dimensions.subRows,d=C.dimensions.subColumns,c=C.dimensions.cellSize,n=C.styles,(o=C.cssStyles).grid.css.style.width=c*u+"px",o.grid.css.style.height=c*i+"px",o.grid.css.style.borderColor=n.outerBorderColor,o.grid.css.style.borderWidth=n.outerBorderThickness+"px",o.cell.css.style.backgroundColor=n.cellColor,o.cell.css.style.borderColor=n.borderColor,o.cell.css.style.borderStyle=n.borderStyle,o.cell.css.style.width=c+"px",o.cell.css.style.height=c+"px",o.cell.css.style.fontSize=j(.6*c)+"px",o.cell.css.style.color=n.symbolColor,o.cellClue.css.style.color=n.clueColor,o.stickyNotes.css.style.color=n.symbolColor,o.highlighted.css.style.backgroundColor=n.highlightColor,o.cellSubRowLast.css.style.borderBottomColor=n.outerBorderColor,o.cellSubRowLast.css.style.borderBottomWidth=n.outerBorderThickness+"px",o.cellSubColLast.css.style.borderRightColor=n.outerBorderColor,o.cellSubColLast.css.style.borderRightWidth=n.outerBorderThickness+"px",(s=J("div#"+C.id+"."+C.getGridClasses().join("."))).setAttribute("id",C.id),m=a,l=g=0;l<i;l++){for(h=l%a,t=p=0;t<u;t++)f=t%d,r=C.buildCell(a,d,l,t,g+p,c,["cell default","row-"+l+(0==l?" row-first":i-1==l?" row-last":"")+(0==h?" subrow-first":a-1==h?" subrow-last":""),"column-"+t+(0==t?" column-first":u-1==t?" column-last":"")+(0==f?" subcolumn-first":d-1==f?" subcolumn-last":""),"square-"+(g+p)].join(" ")),s.appendChild(r),d-1==f&&p++;a-1==h&&(g+=m)}return C.grid=G(s),C.cells=C.grid.children(".cell"),C.setDichromia(C.dichromia),C.setResizable(!0,!0),C},buildCell:function(e,l,t,s,r,n,o){var i,u,c,a,d,h,f=J("div"),p=J("input"),g=J("div.notes"),m=J("div.sticky-notes"),C=W(l,e),y=F(l,e),b=j(100/C),v=j(2*b);for(i=0;i<y;i++){for(c=J("div.note-row"),a=J("div.note-row"),u=0;u<C;u++)d=J("a.note"),h=J("a.sticky-note"),d.href="#",d.title=" ",d.style.fontSize=v+"%",d.style.paddingBottom=d.style.width=b+"%",h.href="#",h.title=" ",h.style.fontSize=v+"%",h.style.paddingBottom=h.style.width=b+"%",c.appendChild(d),a.appendChild(h);g.appendChild(c),m.appendChild(a)}return f.cellType=Z,f.highlightType=0,f.row=t,f.column=s,f.square=r,f.clue=!0,f.style.top=t*n+"px",f.style.left=s*n+"px",p.solution=null,p.highlightType=0,p.readOnly=!1,p.setAttribute("type","text"),p.setAttribute("value",""),p.setAttribute("maxlength","1"),f.appendChild(p),f.appendChild(m),f.appendChild(g),o&&(f.className=""+o),f},onBuildComplete:function(){var i=this,o=i.grid;return G.fn.contextMenu&&o.contextMenu({selector:".cell",items:{"make-clue":{name:V("MAKE_CLUE"),icon:"add-definition"},"unmake-clue":{name:V("UNMAKE_CLUE"),icon:"clear"}},callback:function(e,l){i.decorateCell(G(this),e)}}),o.on("keydown click focus",".cell:not(.clue) > input",function(e){var l,t,s,r=e.target,n=G(r).closest(".cell"),o=i.cells;if(X===n[0].cellType)if(t=i.currentInputCell,i.currentInputCell=n,"keydown"===e.type){if(27===(l=e.which))return setTimeout(function(){o.removeClass("current")},100),e.preventDefault(),e.stopPropagation(),!1;if(38===l||40===l||37===l||39===l)return o.removeClass("current"),setTimeout(function(){i.handleKeyNav(e,n)},100),e.preventDefault(),e.stopPropagation(),!1;o.removeClass("current"),s=r.value,setTimeout(function(){i.handleInput(e,r,s),r.value.length?n.addClass("no-notes"):n.removeClass("no-notes")},100)}else t&&t.removeClass("current")}),o.on("click",".cell:not(.clue)",function(e){var l,t=G(e.target);return X===t[0].cellType&&(l=i.currentInputCell,i.currentInputCell=t,l&&l.removeClass("current"),t.addClass("current")),e.preventDefault(),e.stopPropagation(),!1}),o.on("click",".cell:not(.clue) > .notes",function(e){return G(e.target).closest(".cell").removeClass("current"),e.preventDefault(),e.stopPropagation(),!1}),o.on("click",".cell:not(.clue) .note",function(e){var l=G(e.target),t=l.closest(".cell"),s=t[0].firstChild,r=G(s);if(t.removeClass("current"),!l.hasClass("note-disabled"))if(o.hasClass("notes")){t.hasClass("no-notes")&&t.removeClass("no-notes");var n=t.find('.sticky-note[title="'+l.attr("title")+'"]');n.hasClass("noted")?n.removeClass("noted"):n.addClass("noted"),r.removeClass(Y).val(""),i.trigger("input",{input:s})}else s.value=l.attr("title"),t.addClass("no-notes"),i.toggleErrorsHighlight&&(s.value!==s.solution?r.hasClass(Y)||r.addClass(Y):r.removeClass(Y)),i.trigger("input",{input:s});return e.preventDefault(),e.stopPropagation(),!1}),i},clearCells:function(e){return this.$super("clearCells",e),this.cells.filter(qe).removeClass("no-notes"),this},revealSolution:function(){return this.$super("revealSolution"),this.cells.filter(qe).addClass("no-notes"),this},revealCell:function(e){return(e=e||this.currentInputCell||null)&&e.length&&(this.$super("revealCell",e),e.addClass("no-notes")),this},decorateCell:function(e,l){var t=e[0],s=t.firstChild;"make-clue"===l?(t.clue=!0,t.cellType=Z,s.readOnly=!0,s.value=s.solution||"",s.setAttribute("value",s.solution||""),e.hasClass("clue")||e.addClass("clue")):"unmake-clue"===l&&(t.clue=!1,t.cellType=X,s.readOnly=!1,s.value=s.solution||"",s.setAttribute("value",s.solution||""),e.removeClass("clue"))},setAlphabet:function(e){var l=this;return e&&e.length>=l.dimensions.rows?l.alphabet=e.slice(0,l.dimensions.rows):l.alphabet=null,l},setDichromia:function(e){var l=this.grid;return this.dichromia=e=!!e,e&&!l.hasClass("dichromia")?l.addClass("dichromia"):e||l.removeClass("dichromia"),this},getRawGrid:function(){var t,e=this,l=e.dimensions.rows,s=e.dimensions.columns,r=l*s;return t={alphabet:e.alphabet?e.alphabet.slice():null,difficulty:e.difficulty||1,cells:new Array(r),values:new Array(r),rows:parseInt(l,10),cols:parseInt(s,10),subrows:parseInt(e.dimensions.subRows,10),subcols:parseInt(e.dimensions.subColumns,10)},e.cells.each(function(e){var l=this;t.values[e]=l.firstChild.solution||"",t.cells[e]={index:e,row:l.row,col:l.column,squ:l.square,clue:!!l.clue}}),t},setRawGrid:function(e){if(!e)return this;var l,t,s,r,n,o,i,u,c=this,a=c.dimensions.rows,d=c.dimensions.columns,h=a*d,f=c.cells;if(e[ee]("cells")||(e.cells=e.values,e.values=e.cells.map(He)),e[ee]("subRows")&&(e.cols=e.columns,delete e.columns,e.subrows=e.subRows,delete e.subRows,e.subcols=e.subColumns,delete e.subColumns),h===(o=e.cells).length)for(i=e.values,c.difficulty=e.difficulty||1,e[ee]("alphabet")?c.alphabet=e.alphabet.join?e.alphabet.join(""):""+e.alphabet:c.alphabet||(c.alphabet=K(d,{start:1}).join("")),l=0;l<h;l++)"string"!=typeof(u=i[(t=o[l]).index])&&(u=c.alphabet.charAt(u)),(s=(r=(n=f.eq(l))[0]).firstChild).solution=u,r.row=t.row,r.column=t.col,r.square=t.squ,r.clue=!!t.clue,r.clue?(r.cellType=Z,s.readOnly=!0,s.value=u,s.setAttribute("value",u),n.addClass("clue")):(r.cellType=X,s.readOnly=!1,s.value="",n.removeClass("clue")),n.find(".sticky-note").each(function(e){this.title=c.alphabet.charAt(e)}),n.find(".note").each(function(e){this.title=c.alphabet.charAt(e)});return Ge(c),c},importTpl:function(e){return e&&e[ee]("dimensions")&&(this.dichromia=!!e.dichromia,this.$super("importTpl",e)),this},exportTpl:function(){var e=this.$super("exportTpl");return e&&(e.dichromia=!!this.dichromia),e}}),(te=(le=Ae).Compiler=le.Class({extends:le.Asynchronous,implements:le.PublishSubscribe},{__static__:{STATUS:{INIT:0,RUNNING:1,NOT_FOUND:4,FOUND:16},MODE:{AUTO:0,NONE:1,LINEAR:2,EXPONENTIAL:3}},constructor:function(e){var l=this;l.$super("constructor",100),l.initPubSub(),l.component=e||"Sudoku.Compiler",l.cutoff_mode=te.MODE.AUTO,l.status=te.STATUS.INIT,l.grid=null},component:null,grid:null,status:null,liveUpdate:!1,multiPass:!0,timeLimit:0,cutoff_mode:null,NUM_ALTERNATIVES:5,MIN_ALTERNATIVES:2,_NUM_ALTERNATIVES:5,dispose:function(){var e=this;return e.$super("dispose"),e.disposePubSub(),e.component=null,e.grid=null,e.status=null,e.liveUpdate=null,e.multiPass=null,e.timeLimit=null,e.cutoff_mode=null,e},fork:function(){return this.unfork(!0).$super("fork",this.component,le.Path.file),this},stop:function(e){var l=this;return l.$thread&&(l.send("stop"),!0===e&&setTimeout(function(){l.unfork(!0)},500)),l.$queue.length&&l.empty(),l},setGrid:function(e){return e&&(this.grid=e),this},setSolution:function(){return this},clearSolution:function(){return this},compile:function(){return this}})).RUN_MODE=le.Asynchronous.MODE,ne=(se=Ae).isWorker,oe=Math,ie=oe.round,ue=oe.min,ce=oe.ceil,ae=se.shuffle,de=se.shufflex,he=se.filter,fe=se.operate,pe=se.clamp,ge=se.array,me=se.range,Ce=oe.random,ye=se.randi,be=se.randomItem,ve=se.Compiler,Se="unshift",we="push",xe="undefined"!=typeof Uint8Array?Uint8Array:Array,Te="undefined"!=typeof Uint32Array?Uint32Array:Array,_e=new xe([0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7]),se.SudokuCompiler=se.Class(ve,{constructor:function(e){var l=this;l.$super("constructor","Sudoku.SudokuCompiler"),ne?l.listen("generateSudoku",function(e){l.send("generateSudoku",{solution:Ze(e.data,!0)})}).listen("compile",function(e){l.data=e.data,l.solution=l.data,l.compileAsync()}).listen("stop",function(e){l.stop()}).listen("dispose",function(e){l.stop().dispose(),se.Asynchronous.close()}):l.grid=e||null},solution:null,data:null,dispose:function(){return this.solution=null,this.data=null,this.$super("dispose"),this},compileAsync:function(e){var l,t,s,r=this;r.dimensions;return ne?s=function(){r.status=ve.STATUS.FOUND,r.send("complete",{status:r.status,solution:r.solution})}:(s=function(){t=(new Date).getTime(),r.solution?(r.status=ve.STATUS.FOUND,r.trigger("complete",{status:r.status,duration:t-l},5)):(r.status=ve.STATUS.NOT_FOUND,r.trigger("error",null,5))},l=(new Date).getTime()),r.stop(),!0===e?setTimeout(function(){r.solution=Ze(r.data,!0),s()},20):r.steps(r.until(!0,ll(r.data,r.data.difficulty,r.data.symmetry)),s).interval(ne?15:40).run(ve.RUN_MODE.SEQUENCE),r},compileWorker:function(e){var l,t,s=this;return l=(new Date).getTime(),s.fork().listen("generateSudoku",function(e){s.status=ve.STATUS.FOUND,s.solution=e.solution,s.trigger("complete",{status:s.status,duration:t-l},5),setTimeout(function(){s.unfork()},500)}).listen("complete",function(e){t=(new Date).getTime(),s.status=e.status,e.solution?(s.solution=e.solution,s.trigger("complete",{status:s.status,duration:t-l},5)):s.trigger("error",null,5),setTimeout(function(){s.unfork()},500)}),!0===e?s.send("generateSudoku",{data:s.data}):s.send("compile",{data:s.data}),s},setSolution:function(){var e=this;return e.grid&&e.solution&&e.grid.setRawGrid(e.solution),e},clearSolution:function(){return this},generateSudoku:function(e){var l=this;return l.solution=null,l.data=l.grid.getRawGrid(),!1!==e?l.compileWorker(!0):l.compileAsync(!0),l},compile:function(e,l,t){var s=this;return s.solution=null,s.data=s.grid.getRawGrid(),s.data.difficulty=l,s.data.symmetry=t,!1!==e?s.compileWorker():s.compileAsync(),s}}),Ae});
